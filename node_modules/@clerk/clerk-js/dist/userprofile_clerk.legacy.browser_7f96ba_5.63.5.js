"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["470"],{31171:function(e,t,i){i.d(t,{J:()=>v}),i(45261),i(70957),i(24551),i(22349),i(65223);var r=i(88635),o=i(8756),l=i(43064),n=i(30948),a=i(34229),s=i(96258),c=i(24676),d=i(81201),u=i(50043),m=i(55913);let h=()=>{let{params:e,navigate:t}=(0,c.useRouter)(),{getInvoiceById:i,isLoading:a}=(0,o.useInvoicesContext)(),s=e.invoiceId?i(e.invoiceId):null;return a?(0,r.tZ)(l.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,r.tZ)(l.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:l.descriptors.spinner})}):(0,r.BX)(r.HY,{children:[(0,r.tZ)(n.Header.Root,{children:(0,r.tZ)(n.Header.BackLink,{onClick:()=>void t("../../",{searchParams:new URLSearchParams("tab=invoices")}),children:(0,r.tZ)(n.Header.Title,{localizationKey:"Invoices",textVariant:"h2"})})}),(0,r.tZ)(l.Box,{elementDescriptor:l.descriptors.invoiceRoot,sx:e=>({display:"flex",flexDirection:"column",gap:e.space.$4,borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,marginBlockStart:e.space.$4,paddingBlockStart:e.space.$4}),children:s?(0,r.BX)(l.Box,{elementDescriptor:l.descriptors.invoiceCard,sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg,overflow:"hidden"}),children:[(0,r.BX)(l.Box,{elementDescriptor:l.descriptors.invoiceHeader,as:"header",sx:e=>({padding:e.space.$4,background:d.common.mergedColorsBackground(u.O9.setAlpha(e.colors.$colorBackground,1),e.colors.$neutralAlpha50),borderBlockEndWidth:e.borderWidths.$normal,borderBlockEndStyle:e.borderStyles.$solid,borderBlockEndColor:e.colors.$neutralAlpha100}),children:[(0,r.BX)(l.Box,{elementDescriptor:l.descriptors.invoiceHeaderTitleBadgeContainer,sx:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,r.BX)(l.Span,{elementDescriptor:l.descriptors.invoiceTitleIdContainer,children:[(0,r.tZ)(l.Heading,{textVariant:"h2",elementDescriptor:l.descriptors.invoiceTitle,children:"Invoice ID"}),(0,r.BX)(l.Span,{elementDescriptor:l.descriptors.invoiceIdContainer,sx:e=>({display:"flex",alignItems:"center",gap:e.space.$0x25,color:e.colors.$colorTextSecondary}),children:[(0,r.tZ)(p,{copyLabel:"Copy invoice ID",text:s.id}),(0,r.tZ)(l.Text,{elementDescriptor:l.descriptors.invoiceId,colorScheme:"secondary",variant:"subtitle",children:(0,m.L)(s.id)})]})]}),(0,r.tZ)(l.Badge,{elementDescriptor:l.descriptors.invoiceBadge,colorScheme:"paid"===s.status?"success":"unpaid"===s.status?"warning":"danger",sx:{textTransform:"capitalize"},children:s.status})]}),(0,r.BX)(l.Dl,{elementDescriptor:l.descriptors.invoiceDetails,sx:e=>({display:"flex",justifyContent:"space-between",marginBlockStart:e.space.$3}),children:[(0,r.BX)(l.Box,{elementDescriptor:l.descriptors.invoiceDetailsItem,children:[(0,r.tZ)(l.Dt,{elementDescriptor:l.descriptors.invoiceDetailsItemTitle,children:(0,r.tZ)(l.Text,{elementDescriptor:l.descriptors.invoiceDetailsItemTitleText,colorScheme:"secondary",variant:"body",children:"Created on"})}),(0,r.tZ)(l.Dd,{elementDescriptor:l.descriptors.invoiceDetailsItemValue,children:(0,r.tZ)(l.Text,{elementDescriptor:l.descriptors.invoiceDetailsItemValueText,variant:"subtitle",children:new Date(s.paymentDueOn).toLocaleDateString()})})]}),(0,r.BX)(l.Box,{elementDescriptor:l.descriptors.invoiceDetailsItem,sx:{textAlign:"right"},children:[(0,r.tZ)(l.Dt,{elementDescriptor:l.descriptors.invoiceDetailsItemTitle,children:(0,r.tZ)(l.Text,{elementDescriptor:l.descriptors.invoiceDetailsItemTitleText,colorScheme:"secondary",variant:"body",children:"Due on"})}),(0,r.tZ)(l.Dd,{elementDescriptor:l.descriptors.invoiceDetailsItemValue,children:(0,r.tZ)(l.Text,{elementDescriptor:l.descriptors.invoiceDetailsItemValueText,variant:"subtitle",children:new Date(s.paymentDueOn).toLocaleDateString()})})]})]})]}),(0,r.tZ)(l.Box,{elementDescriptor:l.descriptors.invoiceContent,sx:e=>({padding:e.space.$4}),children:(0,r.BX)(n.LineItems.Root,{children:[(0,r.BX)(n.LineItems.Group,{children:[(0,r.tZ)(n.LineItems.Title,{title:"Plan"}),(0,r.tZ)(n.LineItems.Description,{text:"".concat(s.totals.grandTotal.currencySymbol).concat(s.totals.grandTotal.amountFormatted),suffix:"per month"})]}),(0,r.BX)(n.LineItems.Group,{variant:"secondary",borderTop:!0,children:[(0,r.tZ)(n.LineItems.Title,{title:"Subtotal"}),(0,r.tZ)(n.LineItems.Description,{text:"".concat(s.totals.grandTotal.currencySymbol).concat(s.totals.grandTotal.amountFormatted)})]}),(0,r.BX)(n.LineItems.Group,{variant:"secondary",children:[(0,r.tZ)(n.LineItems.Title,{title:"Tax"}),(0,r.tZ)(n.LineItems.Description,{text:"".concat(s.totals.taxTotal.currencySymbol).concat(s.totals.taxTotal.amountFormatted)})]}),(0,r.BX)(n.LineItems.Group,{borderTop:!0,children:[(0,r.tZ)(n.LineItems.Title,{title:"Total due"}),(0,r.tZ)(n.LineItems.Description,{text:"".concat(s.totals.grandTotal.currencySymbol).concat(s.totals.grandTotal.amountFormatted),prefix:"USD"})]})]})})]}):(0,r.tZ)(l.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,r.tZ)(l.Text,{children:"Invoice not found"})})})]})};function p(e){let{text:t,copyLabel:i="Copy"}=e,{onCopy:o,hasCopied:n}=(0,a.VP)(t);return(0,r.tZ)(l.Button,{elementDescriptor:l.descriptors.invoiceCopyButton,variant:"unstyled",onClick:o,sx:e=>({color:"inherit",width:e.sizes.$4,height:e.sizes.$4,padding:0,borderRadius:e.radii.$sm,"&:focus-visible":{outline:"2px solid",outlineColor:e.colors.$neutralAlpha200}}),focusRing:!1,"aria-label":n?"Copied":i,children:(0,r.tZ)(l.Icon,{size:"sm",icon:n?s.Jr:s.CK,"aria-hidden":!0})})}let v=()=>(0,r.tZ)(o.InvoicesContextProvider,{children:(0,r.tZ)(h,{})})},99140:function(e,t,i){i.d(t,{_:()=>P}),i(92037),i(28419);var r=i(88635),o=i(83799),l=i(69144),n=i(8969),a=i(8756),s=i(30948),c=i(91085),d=i(50043),u=i(10207);i(50725);var m=i(24676),h=i(26917),p=i(43064),v=i(34229);let f=e=>{let{navigate:t}=(0,m.useRouter)(),{email:i,nextStep:o,onReset:n}=e,c=(0,s.useCardState)(),u=(0,a.useUserProfileContext)(),{startEnterpriseSSOLinkFlow:f}=(0,v.eq)(i);async function g(){var e;await t((null===(e=i.verification.externalVerificationRedirectURL)||void 0===e?void 0:e.href)||"")}return l.useEffect(()=>{!function(){let{mode:e,componentName:t}=u;f({redirectUrl:"modal"===e?(0,h.bX)({url:window.location.href,componentName:t}):window.location.href}).then(()=>o()).catch(e=>(0,d.S3)(e,[],c.setError))}()},[]),(0,r.BX)(r.HY,{children:[(0,r.tZ)(p.Flex,{justify:"center",children:(0,r.tZ)(p.Button,{variant:"link",onClick:g,localizationKey:(0,p.localizationKeys)("userProfile.emailAddressPage.enterpriseSSOLink.formButton")})}),(0,r.tZ)(s.FormButtonContainer,{children:(0,r.tZ)(p.Button,{variant:"ghost",localizationKey:(0,p.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:p.descriptors.formButtonReset,onClick:n})})]})};var g=i(12786);let P=(0,s.withCardStateProvider)(e=>{var t,i;let{emailId:m,onSuccess:h,onReset:p,disableAutoFocus:v=!1}=e,P=(0,s.useCardState)(),{user:b}=(0,o.aF)(),S=(0,a.useEnvironment)(),C=(0,o.WZ)(e=>null==b?void 0:b.createEmailAddress({email:e})),x=l.useRef(null==b?void 0:b.emailAddresses.find(e=>e.id===m)),B=Z(x.current,S),z=(0,n.a2)({defaultStep:+!!x.current,onNextStep:()=>P.setError(void 0)}),K=(0,d.Yp)("emailAddress","",{type:"email",label:(0,c.u1)("formFieldLabel__emailAddress"),placeholder:(0,c.u1)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),R=K.value.length>1&&(null==b?void 0:b.username)!==K.value,_=async e=>{if(e.preventDefault(),b)return C(K.value).then(e=>{x.current=e,z.nextStep()}).catch(e=>(0,d.S3)(e,[K],P.setError))},T=y(B);return(0,r.BX)(n.en,{...z.props,children:[(0,r.tZ)(s.FormContainer,{headerTitle:e.title||(0,c.u1)("userProfile.emailAddressPage.title"),headerSubtitle:e.subtitle||(0,c.u1)("userProfile.emailAddressPage.formHint"),children:(0,r.BX)(s.Form.Root,{onSubmit:_,children:[(0,r.tZ)(s.Form.ControlRow,{elementId:K.id,children:(0,r.tZ)(s.Form.PlainInput,{...K.props,autoFocus:!v})}),(0,r.tZ)(s.FormButtons,{submitLabel:(0,c.u1)("userProfile.formButtonPrimary__add"),isDisabled:!R,onReset:p})]})}),(0,r.BX)(s.FormContainer,{headerTitle:(0,c.u1)("userProfile.emailAddressPage.verifyTitle"),headerSubtitle:(0,c.u1)("".concat(T,".formSubtitle"),{identifier:null===(t=x.current)||void 0===t?void 0:t.emailAddress}),children:["email_link"===B&&(0,r.tZ)(g.K,{nextStep:h,email:x.current,onReset:p}),"email_code"===B&&(0,r.tZ)(u.H,{nextStep:h,identification:x.current,identifier:null===(i=x.current)||void 0===i?void 0:i.emailAddress,prepareVerification:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.prepareVerification({strategy:"email_code"})},onReset:p}),"enterprise_sso"===B&&(0,r.tZ)(f,{nextStep:h,email:x.current,onReset:p})]})]})}),y=e=>{switch(e){case"email_code":return"userProfile.emailAddressPage.emailCode";case"enterprise_sso":return"userProfile.emailAddressPage.enterpriseSSOLink";case"email_link":return"userProfile.emailAddressPage.emailLink";default:throw Error("Unsupported strategy for email verification: ".concat(e))}},Z=(e,t)=>(null==e?void 0:e.matchesSsoConnection)?"enterprise_sso":!function(e){let{userSettings:t}=e,{email_address:i}=t.attributes;return!!((null==i?void 0:i.enabled)&&(null==i?void 0:i.verifications.includes("email_link")))}(t)?"email_code":"email_link"},10207:function(e,t,i){i.d(t,{H:()=>s});var r=i(88635),o=i(69144),l=i(43064),n=i(30948),a=i(50043);let s=e=>{let t=(0,n.useCardState)(),{nextStep:i,identification:s,identifier:c,onReset:d,prepareVerification:u}=e,m=()=>{var e;return null==u?void 0:null===(e=u())||void 0===e?void 0:e.catch(e=>(0,a.S3)(e,[],t.setError))},h=(0,n.useFieldOTP)({onCodeEntryFinished:(e,t,i)=>{null==s||s.attemptVerification({code:e}).then(()=>t()).catch(i)},onResendCodeClicked:m,onResolve:i});return o.useEffect(()=>{m()},[]),(0,r.BX)(r.HY,{children:[(0,r.tZ)(n.Form.OTPInput,{...h,label:(0,l.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),description:(0,l.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:c}),resendButton:(0,l.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),centerAlign:!1}),(0,r.BX)(n.FormButtonContainer,{children:[(0,r.tZ)(l.Button,{isLoading:h.isLoading,localizationKey:(0,l.localizationKeys)("formButtonPrimary__verify"),elementDescriptor:l.descriptors.formButtonPrimary,onClick:h.onFakeContinue}),(0,r.tZ)(l.Button,{variant:"ghost",isDisabled:h.isLoading,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset,onClick:d})]})]})}},12786:function(e,t,i){i.d(t,{K:()=>m,M:()=>h});var r=i(88635),o=i(69144),l=i(8969),n=i(56749),a=i(8756),s=i(43064),c=i(30948),d=i(34229),u=i(50043);let m=e=>{let{email:t,nextStep:i,onReset:l}=e,m=(0,c.useCardState)(),h=(0,a.useUserProfileContext)(),{startEmailLinkFlow:p}=(0,d.E2)(t),{displayConfig:v}=(0,a.useEnvironment)();function f(){let{routing:e}=h,t="virtual"===e?v.userProfileUrl:"";p({redirectUrl:(0,n.Uu)({ctx:h,baseUrl:t,intent:"profile"})}).then(()=>i()).catch(e=>(0,u.S3)(e,[],m.setError))}return o.useEffect(()=>{f()},[]),(0,r.BX)(r.HY,{children:[(0,r.tZ)(c.VerificationLink,{resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:f}),(0,r.tZ)(c.FormButtonContainer,{children:(0,r.tZ)(s.Button,{variant:"ghost",localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset,onClick:l})})]})},h=()=>(0,r.tZ)(l.Ej,{title:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"})},69067:function(e,t,i){i.r(t),i.d(t,{UserProfile:()=>ts,UserProfileModal:()=>tc});var r=i(88635),o=i(69144),l=i(31673),n=i(8756),a=i(43064),s=i(30948),c=i(24676),d=i(91085);let u=e=>{let{pages:t}=(0,n.useUserProfileContext)();return(0,r.BX)(s.NavbarContextProvider,{children:[(0,r.tZ)(s.NavBar,{title:(0,d.u1)("userProfile.navbar.title"),description:(0,d.u1)("userProfile.navbar.description"),routes:t.routes,contentRef:e.contentRef}),e.children]})};i(50725);var m=i(94995),h=i(31171),p=i(83799);i(65223),i(28419),i(56113);var v=i(26917),f=i(8969),g=i(99805),P=i(44709),y=i(34229),Z=i(50043);i(87945);let b=e=>{let{strategy:t}=e,i=(0,s.useCardState)(),{user:o}=(0,p.aF)(),{navigate:l}=(0,c.useRouter)(),{strategyToDisplayData:d}=(0,y.vO)(),{additionalOAuthScopes:u,componentName:m,mode:h}=(0,n.useUserProfileContext)(),g="modal"===h,P=(0,p.WZ)(()=>{let e=t.replace("oauth_",""),i=g?(0,v.bX)({url:window.location.href,componentName:m,socialProvider:e}):window.location.href,r=u?u[e]:[];return null==o?void 0:o.createExternalAccount({strategy:t,redirectUrl:i,additionalScopes:r})}),b=d[t].iconUrl?(0,r.tZ)(a.Image,{isLoading:i.loadingMetadata===t,isDisabled:i.isLoading,elementDescriptor:a.descriptors.providerIcon,elementId:a.descriptors.providerIcon.setId(d[t].id),src:d[t].iconUrl,alt:"Connect ".concat(d[t].name," account"),sx:e=>({width:e.sizes.$4})}):(0,r.tZ)(f.e_,{id:d[t].id,value:d[t].name,isLoading:i.loadingMetadata===t,isDisabled:i.isLoading});return(0,r.tZ)(s.ProfileSection.ActionMenuItem,{id:d[t].id,onClick:()=>{if(o)return i.setLoading(t),P().then(e=>{var r;e&&(null===(r=e.verification)||void 0===r?void 0:r.externalVerificationRedirectURL)&&((0,Z._v)(2e3).then(()=>i.setIdle(t)),l(e.verification.externalVerificationRedirectURL.href))}).catch(e=>{(0,Z.S3)(e,[],i.setError),i.setIdle(t)})},isDisabled:i.isLoading,variant:"ghost",isLoading:i.loadingMetadata===t,focusRing:!1,closeAfterClick:!1,localizationKey:(0,a.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:d[t].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:b},t)},S=e=>{let{onClick:t}=e,{user:i}=(0,p.aF)(),{strategies:o}=(0,y.vO)(),l=o.filter(e=>e.startsWith("oauth")),n=null==i?void 0:i.verifiedExternalAccounts.map(e=>"oauth_".concat(e.provider)),c=l.filter(e=>!n.includes(e));return 0===c.length?null:(0,r.tZ)(s.ProfileSection.ActionMenu,{triggerLocalizationKey:(0,a.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",onClick:t,children:c.map(e=>(0,r.tZ)(b,{strategy:e},e))})},C=e=>{var t;let{onSuccess:i,onReset:l}=e,{user:n}=(0,p.aF)(),{emailId:s}=e,c=null==n?void 0:n.emailAddresses.find(e=>e.id===s),d=o.useRef(null==c?void 0:c.emailAddress),u=(null==c?void 0:null===(t=c.verification)||void 0===t?void 0:t.status)==="verified"?(0,a.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"):void 0;return d.current?(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:d.current}),messageLine2:u,successMessage:(0,a.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:d.current}),deleteResource:()=>Promise.resolve(null==c?void 0:c.destroy()),onSuccess:i,onReset:l}):null},x=e=>{var t;let{phoneId:i,onSuccess:l,onReset:n}=e,{user:s}=(0,p.aF)(),c=null==s?void 0:s.phoneNumbers.find(e=>e.id===i),d=o.useRef(null==c?void 0:c.phoneNumber),u=(null==c?void 0:null===(t=c.verification)||void 0===t?void 0:t.status)==="verified"?(0,a.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"):void 0;return d.current?(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:d.current}),messageLine2:u,successMessage:(0,a.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:d.current}),deleteResource:()=>Promise.resolve(null==c?void 0:c.destroy()),onSuccess:l,onReset:n}):null},B=e=>{var t,i;let{accountId:l,onSuccess:n,onReset:s}=e,{user:c}=(0,p.aF)(),d=null==c?void 0:c.externalAccounts.find(e=>e.id===l),u=o.useRef(null==d?void 0:d.provider),{providerToDisplayData:m}=(0,y.vO)();return u.current?(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:null===(t=m[u.current])||void 0===t?void 0:t.name}),messageLine2:(0,a.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,a.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:null===(i=m[u.current])||void 0===i?void 0:i.name}),deleteResource:()=>Promise.resolve(null==d?void 0:d.destroy()),onSuccess:n,onReset:s}):null},z=e=>{var t;let{user:i}=(0,p.aF)(),{walletId:l,onSuccess:n,onReset:s}=e,c=null==i?void 0:i.web3Wallets.find(e=>e.id===l),d=o.useRef(null==c?void 0:c.web3Wallet),u=(null==c?void 0:null===(t=c.verification)||void 0===t?void 0:t.status)==="verified"?(0,a.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"):void 0;return d.current?(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:d.current}),messageLine2:u,successMessage:(0,a.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:d.current}),deleteResource:()=>Promise.resolve(null==c?void 0:c.destroy()),onSuccess:n,onReset:s}):null},K=e=>{let{user:t}=(0,p.aF)(),{phoneId:i,onSuccess:l,onReset:n}=e,s=null==t?void 0:t.phoneNumbers.find(e=>e.id===i),c=o.useRef(null==s?void 0:s.phoneNumber);return c.current?(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:c.current}),messageLine2:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:c.current}),deleteResource:()=>Promise.resolve(null==s?void 0:s.setReservedForSecondFactor({reserved:!1})),onSuccess:l,onReset:n}):null},R=e=>{let{onSuccess:t,onReset:i}=e,{user:o}=(0,p.aF)();return o?(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,a.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,a.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:o.disableTOTP,onSuccess:t,onReset:i}):null},_=e=>{let{onSuccess:t,onReset:i,passkey:o}=e;return(0,r.tZ)(f.LE,{title:(0,a.localizationKeys)("userProfile.passkeyScreen.removeResource.title"),messageLine1:(0,a.localizationKeys)("userProfile.passkeyScreen.removeResource.messageLine1",{name:o.name}),deleteResource:o.delete,onSuccess:t,onReset:i})},T=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(B,{onSuccess:t,onReset:t,...e})},I=["external_account_missing_refresh_token","oauth_fetch_user_error","oauth_token_exchange_error","external_account_email_address_verification_required"],w=(0,s.withCardStateProvider)(e=>{var t;let{shouldAllowCreation:i=!0}=e,{user:l}=(0,p.aF)(),n=(0,s.useCardState)(),c=!!(null==l?void 0:null===(t=l.externalAccounts)||void 0===t?void 0:t.length),[d,u]=(0,o.useState)(null);if(!l||!i&&!c)return null;let m=[...l.verifiedExternalAccounts,...l.unverifiedExternalAccounts.filter(e=>{var t;return null===(t=e.verification)||void 0===t?void 0:t.error})];return(0,r.BX)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.connectedAccountsSection.title"),centered:!1,id:"connectedAccounts",children:[(0,r.tZ)(s.Card.Alert,{children:n.error}),(0,r.BX)(g.a.Root,{value:d,onChange:u,children:[(0,r.tZ)(s.ProfileSection.ItemList,{id:"connectedAccounts",children:m.map(e=>(0,r.tZ)(F,{account:e},e.id))}),i&&(0,r.tZ)(S,{onClick:()=>u(null)})]})]})}),F=e=>{var t,i,l,d,u,m;let{account:h}=e,{additionalOAuthScopes:P,componentName:b,mode:S}=(0,n.useUserProfileContext)(),{navigate:C}=(0,c.useRouter)(),{user:x}=(0,p.aF)(),B=(0,s.useCardState)(),z=h.id,K="modal"===S,R=K?(0,v.bX)({url:window.location.href,componentName:b}):window.location.href,_=(0,p.WZ)(()=>null==x?void 0:x.createExternalAccount({strategy:h.verification.strategy,redirectUrl:R,additionalScopes:X}));if(!x)return null;let{providerToDisplayData:w}=(0,y.vO)(),F=h.username||h.emailAddress,A=null===(i=h.verification)||void 0===i?void 0:null===(t=i.error)||void 0===t?void 0:t.longMessage,X=function(e,t){if(!t)return[];let i=t[e.provider]||[],r=e.approvedScopes.split(" ");return 0===i.filter(e=>!r.includes(e)).length?[]:i}(h,P),L=X.length>0&&""!=h.approvedScopes,D=I.includes((null===(d=h.verification)||void 0===d?void 0:null===(l=d.error)||void 0===l?void 0:l.code)||"")||L,$=D?(0,a.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__disconnected"):A,E=async()=>{let e=K?(0,v.bX)({url:window.location.href,componentName:b}):window.location.href;try{let i;if(i=L?await h.reauthorize({additionalScopes:X,redirectUrl:e}):await _()){var t;await C((null===(t=i.verification.externalVerificationRedirectURL)||void 0===t?void 0:t.href)||"")}}catch(e){(0,Z.S3)(e,[],B.setError)}};return(0,r.BX)(o.Fragment,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"connectedAccounts",children:[(0,r.BX)(a.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$2}),children:[(0,r.tZ)(()=>w[h.provider].iconUrl?(0,r.tZ)(a.Image,{elementDescriptor:[a.descriptors.providerIcon],elementId:a.descriptors.socialButtonsProviderIcon.setId(h.provider),alt:w[h.provider].name,src:w[h.provider].iconUrl,sx:e=>({width:e.sizes.$4,flexShrink:0})}):(0,r.tZ)(f.e_,{id:h.provider,value:w[h.provider].name}),{}),(0,r.tZ)(a.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.BX)(a.Flex,{gap:1,center:!0,children:[(0,r.tZ)(a.Text,{sx:e=>({color:e.colors.$colorText}),children:"".concat(w[h.provider].name)}),(0,r.tZ)(a.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:F?"• ".concat(F):""})]})})]}),(0,r.tZ)(k,{account:h})]}),D&&(0,r.BX)(a.Box,{sx:e=>({padding:"".concat(e.sizes.$none," ").concat(e.sizes.$none," ").concat(e.sizes.$1x5," ").concat(e.sizes.$8x5)}),children:[(0,r.tZ)(a.Text,{colorScheme:"secondary",sx:e=>({paddingRight:e.sizes.$1x5,display:"inline-block"}),localizationKey:$}),(0,r.tZ)(a.Button,{sx:{display:"inline-block"},onClick:E,variant:"link",localizationKey:(0,a.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed")})]}),(null===(m=h.verification)||void 0===m?void 0:null===(u=m.error)||void 0===u?void 0:u.code)&&!D&&(0,r.tZ)(a.Text,{colorScheme:"danger",sx:e=>({padding:"".concat(e.sizes.$none," ").concat(e.sizes.$1x5," ").concat(e.sizes.$1x5," ").concat(e.sizes.$8x5)}),children:A}),(0,r.tZ)(g.a.Open,{value:"remove-".concat(z),children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(T,{accountId:h.id})})})]},h.id)},k=e=>{let{account:t}=e,{open:i}=(0,P.XC)(),o=t.id,l=[{label:(0,a.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),isDestructive:!0,onClick:()=>i("remove-".concat(o))}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:l})};i(79876);let A=e=>t=>t.id===e?-1:1,X=e=>e.defaultSecondFactor?-1:1;function L(e){let t=[];return Object.entries(e).forEach(e=>{let[,i]=e;i.used_for_second_factor&&t.push(...i.second_factors)}),t}function D(e,t){let i=L(e);return t.totpEnabled&&(i=i.filter(e=>"totp"!==e)),(t.backupCodeEnabled||!t.twoFactorEnabled)&&(i=i.filter(e=>"backup_code"!==e)),i}function $(e,t){if(!e)return[];let i=e.filter(e=>e.id===t),r=e.filter(e=>e.id!==t),o=r.filter(e=>{var t;return(null===(t=e.verification)||void 0===t?void 0:t.status)==="verified"}),l=r.filter(e=>{var t,i;return!!(null===(t=e.verification)||void 0===t?void 0:t.status)&&(null===(i=e.verification)||void 0===i?void 0:i.status)!=="verified"}),n=r.filter(e=>!e.verification.status);return o.sort((e,t)=>e.id.localeCompare(t.id)),l.sort((e,t)=>{var i,r;return(null===(i=e.verification)||void 0===i?void 0:i.expireAt)&&(null===(r=t.verification)||void 0===r?void 0:r.expireAt)?e.verification.expireAt.getTime()-t.verification.expireAt.getTime():0}),[...i,...o,...l,...n]}var E=i(99140);let O=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(C,{onSuccess:t,onReset:t,...e})},N=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(E._,{onSuccess:t,onReset:t,...e})},W=e=>{let{shouldAllowCreation:t=!0}=e,{user:i}=(0,p.aF)();return(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.emailAddressesSection.title"),centered:!1,id:"emailAddresses",children:(0,r.tZ)(g.a.Root,{children:(0,r.BX)(s.ProfileSection.ItemList,{id:"emailAddresses",children:[$(null==i?void 0:i.emailAddresses,null==i?void 0:i.primaryEmailAddressId).map(e=>{let t=e.id;return(0,r.BX)(o.Fragment,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"emailAddresses",children:[(0,r.BX)(a.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$1}),children:[(0,r.tZ)(a.Text,{sx:e=>({color:e.colors.$colorText}),truncate:!0,children:e.emailAddress}),(null==i?void 0:i.primaryEmailAddressId)===t&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__unverified")})]}),(0,r.tZ)(M,{email:e})]}),(0,r.tZ)(g.a.Open,{value:"remove-".concat(t),children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(O,{emailId:t})})}),(0,r.tZ)(g.a.Open,{value:"verify-".concat(t),children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(N,{emailId:t})})})]},e.emailAddress)}),t&&(0,r.BX)(r.HY,{children:[(0,r.tZ)(g.a.Trigger,{value:"add",children:(0,r.tZ)(s.ProfileSection.ArrowButton,{id:"emailAddresses",localizationKey:(0,a.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton")})}),(0,r.tZ)(g.a.Open,{value:"add",children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(N,{})})})]})]})})})},M=e=>{let{email:t}=e,i=(0,s.useCardState)(),{user:o}=(0,p.aF)(),{open:l}=(0,P.XC)(),n=t.id,c=(null==o?void 0:o.primaryEmailAddressId)===n,d="verified"===t.verification.status,u=(0,p.WZ)(()=>null==o?void 0:o.update({primaryEmailAddressId:n})),m=[c&&!d?{label:(0,a.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>l("verify-".concat(n))}:null,!c&&d?{label:(0,a.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>{u().catch(e=>(0,Z.S3)(e,[],i.setError))}}:null,c||d?null:{label:(0,a.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>l("verify-".concat(n))},{label:(0,a.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),isDestructive:!0,onClick:()=>l("remove-".concat(n))}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:m})},U=()=>{let{user:e}=(0,p.aF)(),t=null==e?void 0:e.enterpriseAccounts.filter(e=>{let{enterpriseConnection:t}=e;return null==t?void 0:t.active});return(null==t?void 0:t.length)?(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",centered:!1,children:(0,r.tZ)(s.ProfileSection.ItemList,{id:"enterpriseAccounts",children:t.map(e=>(0,r.tZ)(H,{account:e},e.id))})}):null},H=e=>{var t,i,o;let{account:l}=e,n=l.emailAddress,c=null==l?void 0:null===(t=l.enterpriseConnection)||void 0===t?void 0:t.name,d=null===(o=l.verification)||void 0===o?void 0:null===(i=o.error)||void 0===i?void 0:i.longMessage;return(0,r.BX)(s.ProfileSection.Item,{id:"enterpriseAccounts",sx:e=>({gap:e.space.$2,justifyContent:"start"}),children:[(0,r.tZ)(q,{account:l}),(0,r.tZ)(a.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.BX)(a.Flex,{gap:1,center:!0,children:[(0,r.tZ)(a.Text,{truncate:!0,colorScheme:"body",children:c}),(0,r.tZ)(a.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:n?"• ".concat(n):""}),d&&(0,r.tZ)(a.Badge,{colorScheme:"danger",localizationKey:(0,a.localizationKeys)("badge__requiresAction")})]})})]},l.id)},q=e=>{var t;let{account:i}=e,{provider:o,enterpriseConnection:l}=i,n=o.replace(/(oauth_|saml_)/,"").trim(),s=null!==(t=null==l?void 0:l.name)&&void 0!==t?t:n,c={elementDescriptor:[a.descriptors.providerIcon],alt:s,sx:e=>({width:e.sizes.$4}),elementId:a.descriptors.enterpriseButtonsProviderIcon.setId(i.provider)};return(null==l?void 0:l.logoPublicUrl)?(0,r.tZ)(a.Image,{...c,src:l.logoPublicUrl}):(0,r.tZ)(f.e_,{id:n,value:s,"aria-label":"".concat(s,"'s icon"),elementDescriptor:[a.descriptors.providerIcon,a.descriptors.providerInitialIcon],elementId:a.descriptors.providerInitialIcon.setId(n)})};var V=i(10207);let Y=(0,s.withCardStateProvider)(e=>{let{phoneId:t,onSuccess:i,onReset:l}=e,{user:n}=(0,p.aF)(),s=o.useRef(null==n?void 0:n.phoneNumbers.find(e=>e.id===t)),c=(0,f.a2)({defaultStep:+!!s.current});return(0,r.BX)(f.en,{...c.props,children:[(0,r.tZ)(j,{resourceRef:s,title:(0,a.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:c.nextStep,onReset:l}),(0,r.tZ)(G,{resourceRef:s,title:(0,a.localizationKeys)("userProfile.phoneNumberPage.verifyTitle"),onSuccess:i,onReset:l})]})}),j=e=>{var t;let{title:i,onSuccess:o,onReset:l,onUseExistingNumberClick:n,resourceRef:c}=e,d=(0,s.useCardState)(),{user:u}=(0,p.aF)(),m=(0,p.WZ)((e,t)=>e.createPhoneNumber(t)),h=(0,Z.Yp)("phoneNumber","",{type:"tel",label:(0,a.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),v=h.value.length>1&&(null==u?void 0:u.username)!==h.value,f=!!(null==u?void 0:null===(t=u.phoneNumbers)||void 0===t?void 0:t.length)&&n,g=async e=>{if(e.preventDefault(),u)return m(u,{phoneNumber:h.value}).then(e=>{c.current=e,o()}).catch(e=>(0,Z.S3)(e,[h],d.setError))};return(0,r.tZ)(s.FormContainer,{headerTitle:i,gap:1,children:(0,r.BX)(s.Form.Root,{gap:4,onSubmit:g,children:[(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.phoneNumberPage.infoText"),colorScheme:"secondary"}),(0,r.tZ)(s.Form.ControlRow,{elementId:h.id,children:(0,r.tZ)(s.Form.PhoneInput,{...h.props,autoFocus:!0})}),(0,r.BX)(a.Flex,{justify:f?"between":"end",children:[f&&(0,r.tZ)(a.Button,{variant:"ghost",localizationKey:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.backButton"),onClick:n}),(0,r.tZ)(s.FormButtons,{submitLabel:(0,a.localizationKeys)("userProfile.formButtonPrimary__add"),isDisabled:!v,onReset:l})]})]})})},G=e=>{var t,i,o;let{title:l,onSuccess:n,resourceRef:c,onReset:d}=e;return(0,r.tZ)(s.FormContainer,{headerTitle:l,headerSubtitle:(0,a.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:null===(t=c.current)||void 0===t?void 0:t.phoneNumber}),children:(0,r.tZ)(V.H,{nextStep:n,identification:c.current,identifier:null===(i=c.current)||void 0===i?void 0:i.phoneNumber,prepareVerification:null===(o=c.current)||void 0===o?void 0:o.prepareVerification,onReset:d})})},Q=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(x,{onSuccess:t,onReset:t,...e})},J=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(Y,{onSuccess:t,onReset:t,...e})},ee=e=>{var t;let{shouldAllowCreation:i=!0}=e,{user:l}=(0,p.aF)(),n=!!(null==l?void 0:null===(t=l.phoneNumbers)||void 0===t?void 0:t.length);return i||n?(0,r.tZ)(s.ProfileSection.Root,{centered:!1,title:(0,a.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:(0,r.tZ)(g.a.Root,{children:(0,r.BX)(s.ProfileSection.ItemList,{id:"phoneNumbers",children:[$(null==l?void 0:l.phoneNumbers,null==l?void 0:l.primaryPhoneNumberId).map(e=>{let t=e.id;return(0,r.BX)(o.Fragment,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"phoneNumbers",children:[(0,r.tZ)(a.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.BX)(a.Flex,{gap:2,center:!0,children:[(0,r.tZ)(a.Text,{sx:e=>({color:e.colors.$colorText}),children:(0,Z.L_)(e.phoneNumber)}),(null==l?void 0:l.primaryPhoneNumberId)===t&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__unverified")})]})}),(0,r.tZ)(et,{phone:e})]}),(0,r.tZ)(g.a.Open,{value:"remove-".concat(t),children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(Q,{phoneId:t})})}),(0,r.tZ)(g.a.Open,{value:"verify-".concat(t),children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(J,{phoneId:t})})})]},t)}),i&&(0,r.BX)(r.HY,{children:[(0,r.tZ)(g.a.Trigger,{value:"add",children:(0,r.tZ)(s.ProfileSection.ArrowButton,{id:"phoneNumbers",localizationKey:(0,a.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton")})}),(0,r.tZ)(g.a.Open,{value:"add",children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(J,{})})})]})]})})}):null},et=e=>{let{phone:t}=e,i=(0,s.useCardState)(),{open:o}=(0,P.XC)(),{user:l}=(0,p.aF)(),n=t.id,c=(0,p.WZ)(e=>e.update({primaryPhoneNumberId:t.id}));if(!l)return null;let d=l.primaryPhoneNumberId===t.id,u="verified"===t.verification.status,m=[d&&!u?{label:(0,a.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>o("verify-".concat(n))}:null,!d&&u?{label:(0,a.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>c(l).catch(e=>(0,Z.S3)(e,[],i.setError))}:null,d||u?null:{label:(0,a.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>o("verify-".concat(n))},{label:(0,a.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),isDestructive:!0,onClick:()=>o("remove-".concat(n))}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:m})};var ei=i(81201);let er=(0,s.withCardStateProvider)(e=>{var t;let{onSuccess:i,onReset:o}=e,{user:l}=(0,p.aF)(),c=(0,p.WZ)(e=>null==l?void 0:l.update({username:e})),{userSettings:d}=(0,n.useEnvironment)(),u=(0,s.useCardState)(),m=(0,Z.Yp)("username",(null==l?void 0:l.username)||"",{type:"text",label:(0,a.localizationKeys)("formFieldLabel__username"),placeholder:(0,a.localizationKeys)("formFieldInputPlaceholder__username")});if(!l)return null;let h=null===(t=d.attributes.username)||void 0===t?void 0:t.required,v=(!h||m.value.length>0)&&l.username!==m.value,f=async()=>{try{await c(m.value),i()}catch(e){(0,Z.S3)(e,[m],u.setError)}};return(0,r.tZ)(s.FormContainer,{headerTitle:l.username?(0,a.localizationKeys)("userProfile.usernamePage.title__update"):(0,a.localizationKeys)("userProfile.usernamePage.title__set"),children:(0,r.BX)(s.Form.Root,{onSubmit:f,children:[(0,r.tZ)(s.Form.ControlRow,{elementId:m.id,children:(0,r.tZ)(s.Form.PlainInput,{...m.props,autoFocus:!0,isRequired:h})}),(0,r.tZ)(s.FormButtons,{isDisabled:!v,onReset:o})]})})}),eo=()=>{let{close:e}=(0,P.XC)();return(0,r.tZ)(er,{onSuccess:e,onReset:e})},el=()=>{let{user:e}=(0,p.aF)();return e?(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",sx:{alignItems:"center",[ei.mqu.md]:{alignItems:"flex-start"}},children:(0,r.BX)(g.a.Root,{children:[(0,r.tZ)(g.a.Closed,{value:"edit",children:(0,r.BX)(s.ProfileSection.Item,{id:"username",sx:{paddingLeft:e.username?void 0:"0"},children:[e.username&&(0,r.tZ)(a.Text,{truncate:!0,sx:e=>({color:e.colors.$colorText}),children:e.username}),(0,r.tZ)(g.a.Trigger,{value:"edit",children:(0,r.tZ)(s.ProfileSection.Button,{id:"username",localizationKey:e.username?(0,a.localizationKeys)("userProfile.start.usernameSection.primaryButton__updateUsername"):(0,a.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})})]})}),(0,r.tZ)(g.a.Open,{value:"edit",children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(eo,{})})})]})}):null},en=e=>{let{user:t,...i}=e;return(0,r.tZ)(s.AvatarUploader,{...i,title:(0,d.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,r.tZ)(s.UserAvatar,{size:e=>e.sizes.$12,...t})})},ea=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i}=e,o=(0,s.useCardState)(),{user:l}=(0,p.aF)();if(!l)return null;let{first_name:c,last_name:d}=(0,n.useEnvironment)().userSettings.attributes,u=null==c?void 0:c.enabled,m=null==d?void 0:d.enabled,h=l.firstName||"",f=l.lastName||"",g=(0,Z.Yp)("firstName",l.firstName||"",{type:"text",label:(0,a.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,a.localizationKeys)("formFieldInputPlaceholder__firstName"),isRequired:null==d?void 0:d.required}),P=(0,Z.Yp)("lastName",l.lastName||"",{type:"text",label:(0,a.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,a.localizationKeys)("formFieldInputPlaceholder__lastName"),isRequired:null==d?void 0:d.required}),y=u&&g.value!==h||m&&P.value!==f,b=u&&c.required||m&&d.required,S=b&&!!P.value&&!!g.value&&y,C=l.enterpriseAccounts.some(e=>e.active),x=async e=>(e.preventDefault(),(y?l.update({firstName:g.value,lastName:P.value}):Promise.resolve()).then(t).catch(e=>{(0,Z.S3)(e,[g,P],o.setError)}));return(0,r.BX)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.profilePage.title"),children:[C&&(0,r.tZ)(s.InformationBox,{message:(0,a.localizationKeys)("userProfile.profilePage.readonly")}),(0,r.BX)(s.Form.Root,{onSubmit:x,sx:e=>({gap:e.space.$6}),children:[(0,r.tZ)(en,{user:l,onAvatarChange:e=>l.setProfileImage({file:e}).then(()=>{o.setIdle()}).catch(e=>(0,Z.S3)(e,[],o.setError)),onAvatarRemove:(0,v.QO)(l.imageUrl)?null:()=>{l.setProfileImage({file:null}).then(()=>{o.setIdle()}).catch(e=>(0,Z.S3)(e,[],o.setError))}}),(u||m)&&(0,r.BX)(s.Form.ControlRow,{elementId:"name",children:[u&&(0,r.tZ)(s.Form.PlainInput,{...g.props,isDisabled:C,autoFocus:!0}),m&&(0,r.tZ)(s.Form.PlainInput,{...P.props,isDisabled:C,autoFocus:!u})]}),(0,r.tZ)(s.FormButtons,{isDisabled:b?!S:!y,onReset:i})]})]})}),es=()=>{let{close:e}=(0,P.XC)();return(0,r.tZ)(ea,{onSuccess:e,onReset:e})},ec=()=>{let{user:e}=(0,p.aF)();if(!e)return null;let{username:t,primaryEmailAddress:i,primaryPhoneNumber:o,primaryWeb3Wallet:l,...n}=e;return(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",sx:{[ei.mqu.md]:{alignItems:"flex-start"}},children:(0,r.BX)(g.a.Root,{children:[(0,r.tZ)(g.a.Closed,{value:"edit",children:(0,r.BX)(s.ProfileSection.Item,{id:"profile",children:[(0,r.tZ)(s.UserPreview,{user:n,size:"lg",mainIdentifierVariant:"subtitle",sx:e=>({color:e.colors.$colorText})}),(0,r.tZ)(g.a.Trigger,{value:"edit",children:(0,r.tZ)(s.ProfileSection.Button,{id:"profile",localizationKey:(0,a.localizationKeys)("userProfile.start.profileSection.primaryButton")})})]})}),(0,r.tZ)(g.a.Open,{value:"edit",children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(es,{})})})]})})};i(92037);var ed=i(8501);let eu=(0,s.withCardStateProvider)(e=>{let{onClick:t}=e,i=(0,s.useCardState)(),{user:o}=(0,p.aF)(),{strategies:l,strategyToDisplayData:n}=(0,y.vO)(),c=l.filter(e=>e.startsWith("web3")),d=null==o?void 0:o.verifiedWeb3Wallets.map(e=>e.verification.strategy),u=c.filter(e=>!d.includes(e)),m=(0,p.WZ)(e=>null==o?void 0:o.createWeb3Wallet({web3Wallet:e})),h=async e=>{let t=e.replace("web3_","").replace("_signature","");i.setError(void 0);try{i.setLoading(e);let r=await (0,ed.Ly)({provider:t});if(!o)throw Error("user is not defined");let l=await m(r),n=null==(l=await (null==l?void 0:l.prepareVerification({strategy:e})))?void 0:l.verification.message,a=await (0,ed.bQ)({identifier:r,nonce:n,provider:t});await (null==l?void 0:l.attemptVerification({signature:a})),i.setIdle()}catch(t){i.setIdle();let e=(0,Z.zQ)(t);e?i.setError(e.longMessage):(0,Z.S3)(t,[],i.setError)}};return 0===u.length?null:(0,r.BX)(r.HY,{children:[(0,r.tZ)(s.ProfileSection.ActionMenu,{id:"web3Wallets",triggerLocalizationKey:(0,a.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton"),onClick:t,children:u.map(e=>(0,r.tZ)(s.ProfileSection.ActionMenuItem,{id:n[e].id,onClick:()=>h(e),isLoading:i.loadingMetadata===e,isDisabled:i.isLoading,localizationKey:(0,a.localizationKeys)("userProfile.web3WalletPage.web3WalletButtonsBlockButton",{provider:n[e].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:(0,r.tZ)(a.Image,{elementDescriptor:a.descriptors.providerIcon,elementId:a.descriptors.providerIcon.setId(n[e].id),isLoading:i.loadingMetadata===e,isDisabled:i.isLoading,src:n[e].iconUrl,alt:"Connect ".concat(n[e].name),sx:e=>({width:e.sizes.$5})})},e))}),i.error&&(0,r.tZ)(a.Text,{colorScheme:"danger",sx:e=>({padding:e.sizes.$1x5,paddingLeft:e.sizes.$8x5}),children:i.error})]})}),em=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(z,{onSuccess:t,onReset:t,...e})},eh=e=>e.length<=10?e:e.slice(0,6)+"..."+e.slice(-4),ep=(0,s.withCardStateProvider)(e=>{var t;let{shouldAllowCreation:i=!0}=e,{user:l}=(0,p.aF)(),n=(0,s.useCardState)(),{strategyToDisplayData:c}=(0,y.vO)(),d=!!(null==l?void 0:null===(t=l.web3Wallets)||void 0===t?void 0:t.length),[u,m]=(0,o.useState)(null);return i||d?(0,r.BX)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.web3WalletsSection.title"),centered:!1,id:"web3Wallets",children:[(0,r.tZ)(s.Card.Alert,{children:n.error}),(0,r.BX)(g.a.Root,{value:u,onChange:m,children:[(0,r.tZ)(s.ProfileSection.ItemList,{id:"web3Wallets",children:$(null==l?void 0:l.web3Wallets,null==l?void 0:l.primaryWeb3WalletId).map(e=>{let t=e.verification.strategy,i=e.id;return c[t]&&(0,r.BX)(o.Fragment,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"web3Wallets",align:"start",children:[(0,r.BX)(a.Flex,{sx:e=>({alignItems:"center",gap:e.space.$2,width:"100%"}),children:[c[t].iconUrl&&(0,r.tZ)(a.Image,{src:c[t].iconUrl,alt:c[t].name,sx:e=>({width:e.sizes.$4})}),(0,r.tZ)(a.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.BX)(a.Flex,{gap:2,justify:"start",children:[(0,r.BX)(a.Text,{children:[c[t].name," (",eh(e.web3Wallet),")"]}),(null==l?void 0:l.primaryWeb3WalletId)===i&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__unverified")})]})})]}),(0,r.tZ)(ev,{walletId:i})]},i),(0,r.tZ)(g.a.Open,{value:"remove-".concat(i),children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(em,{walletId:e.id})})})]},e.id)})}),i&&(0,r.tZ)(eu,{onClick:()=>m(null)})]})]}):null}),ev=e=>{let{walletId:t}=e,i=(0,s.useCardState)(),{open:o}=(0,P.XC)(),{user:l}=(0,p.aF)(),n=(null==l?void 0:l.primaryWeb3WalletId)===t,c=(0,p.WZ)(()=>null==l?void 0:l.update({primaryWeb3WalletId:t})),d=[n?null:{label:(0,a.localizationKeys)("userProfile.start.web3WalletsSection.detailsAction__nonPrimary"),onClick:()=>{c().catch(e=>(0,Z.S3)(e,[],i.setError))}},{label:(0,a.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),isDestructive:!0,onClick:()=>o("remove-".concat(t))}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:d})},ef=(0,s.withCardStateProvider)(()=>{var e,t,i,o;let{attributes:l,social:c,enterpriseSSO:d}=(0,n.useEnvironment)().userSettings,u=(0,s.useCardState)(),{user:m}=(0,p.aF)(),h=null===(e=l.username)||void 0===e?void 0:e.enabled,v=null===(t=l.email_address)||void 0===t?void 0:t.enabled,f=null===(i=l.phone_number)||void 0===i?void 0:i.enabled,g=c&&Object.values(c).filter(e=>e.enabled).length>0,P=m&&d.enabled,y=null===(o=l.web3_wallet)||void 0===o?void 0:o.enabled,Z=!P||!m.enterpriseAccounts.some(e=>{var t;return e.active&&(null===(t=e.enterpriseConnection)||void 0===t?void 0:t.disableAdditionalIdentifications)});return(0,r.tZ)(a.Col,{elementDescriptor:a.descriptors.page,sx:e=>({gap:e.space.$8,color:e.colors.$colorText}),children:(0,r.BX)(a.Col,{elementDescriptor:a.descriptors.profilePage,elementId:a.descriptors.profilePage.setId("account"),children:[(0,r.tZ)(s.Header.Root,{children:(0,r.tZ)(s.Header.Title,{localizationKey:(0,a.localizationKeys)("userProfile.start.headerTitle__account"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,r.tZ)(s.Card.Alert,{children:u.error}),(0,r.tZ)(ec,{}),h&&(0,r.tZ)(el,{}),v&&(0,r.tZ)(W,{shouldAllowCreation:Z}),f&&(0,r.tZ)(ee,{shouldAllowCreation:Z}),g&&(0,r.tZ)(w,{shouldAllowCreation:Z}),P&&(0,r.tZ)(U,{}),y&&(0,r.tZ)(ep,{shouldAllowCreation:Z})]})})});i(45261),i(70957),i(24551),i(22349);var eg=i(65006);let eP=()=>{let{navigate:e}=(0,c.useRouter)();return(0,r.BX)(r.HY,{children:[(0,r.tZ)(s.Header.Root,{sx:e=>({borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,marginBlockEnd:e.space.$4,paddingBlockEnd:e.space.$4}),children:(0,r.tZ)(s.Header.BackLink,{onClick:()=>void e("../",{searchParams:new URLSearchParams("tab=plans")}),children:(0,r.tZ)(s.Header.Title,{localizationKey:"Available Plans",textVariant:"h2"})})}),(0,r.tZ)(n.__experimental_PricingTableContext.Provider,{value:{componentName:"PricingTable",mode:"modal"},children:(0,r.tZ)(eg.C,{})})]})},ey=()=>(0,r.tZ)(n.SubscriberTypeContext.Provider,{value:"user",children:(0,r.tZ)(n.PlansContextProvider,{children:(0,r.tZ)(eP,{})})});i(38062);var eZ=i(96258);let eb=()=>{let{user:e}=(0,p.aF)(),{session:t}=(0,p.kP)(),{data:i,isLoading:o}=(0,y.ib)(null==e?void 0:e.getSessions,"user-sessions");return(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.activeDevicesSection.title"),centered:!1,id:"activeDevices",children:(0,r.tZ)(s.ProfileSection.ItemList,{id:"activeDevices",disableAnimation:!0,children:o?(0,r.tZ)(s.FullHeightLoader,{}):null==i?void 0:i.sort(A(t.id)).map(e=>eS(e.status)?(0,r.tZ)(eC,{session:e},e.id):null)})})},eS=e=>["active","pending"].includes(e),eC=e=>{var t;let{session:i}=e,o=(null===(t=(0,p.kP)().session)||void 0===t?void 0:t.id)===i.id,l=(0,y._m)(),n=(0,p.WZ)(i.revoke.bind(i)),c=async()=>{if(!o&&i)return l.setLoading(),n().catch(e=>(0,Z.S3)(e,[],l.setError)).finally(()=>l.setIdle())};return(0,r.tZ)(s.ProfileSection.Item,{id:"activeDevices",elementDescriptor:a.descriptors.activeDeviceListItem,elementId:o?a.descriptors.activeDeviceListItem.setId("current"):void 0,sx:{alignItems:"flex-start",opacity:l.isLoading?.5:1},isDisabled:l.isLoading,children:(0,r.BX)(r.HY,{children:[(0,r.tZ)(ex,{session:i}),!o&&(0,r.tZ)(eB,{revoke:c})]})})},ex=e=>{let{session:t}=(0,p.kP)(),i=(null==t?void 0:t.id)===e.session.id,o=!!(null==t?void 0:t.actor),l=!!e.session.actor,{city:n,country:s,browserName:c,browserVersion:d,deviceType:u,ipAddress:m,isMobile:h}=e.session.latestActivity,v="".concat(c||""," ").concat(d||"").trim()||"Web browser",f=[n||"",s||""].filter(Boolean).join(", ").trim()||null,{t:g}=(0,a.useLocalizations)();return(0,r.BX)(a.Flex,{elementDescriptor:a.descriptors.activeDevice,elementId:i?a.descriptors.activeDevice.setId("current"):void 0,sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[ei.mqu.sm]:{gap:e.space.$2}}),children:[(0,r.tZ)(a.Flex,{sx:e=>({[ei.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,r.tZ)(a.Icon,{elementDescriptor:a.descriptors.activeDeviceIcon,elementId:a.descriptors.activeDeviceIcon.setId(h?"mobile":"desktop"),icon:h?eZ.Fh:eZ.eu,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$8,height:e.space.$8})})}),(0,r.BX)(a.Col,{align:"start",gap:1,children:[(0,r.BX)(a.Flex,{center:!0,gap:2,children:[(0,r.tZ)(a.Text,{children:u||(h?"Mobile device":"Desktop device")}),i&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__thisDevice"),colorScheme:o?"danger":"primary"}),o&&!l&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__userDevice")}),!i&&l&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,r.tZ)(a.Text,{colorScheme:"secondary",children:v}),(0,r.BX)(a.Text,{colorScheme:"secondary",children:[m," (",f,")"]}),(0,r.tZ)(a.Text,{colorScheme:"secondary",children:g((0,Z.Qg)(e.session.lastActiveAt))})]})]})},eB=e=>{let{revoke:t}=e,i=[{label:(0,a.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),isDestructive:!0,onClick:t}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:i})};var ez=i(54264);let eK=(0,s.withCardStateProvider)(e=>{let{onReset:t}=e,i=(0,s.useCardState)(),{afterSignOutUrl:o,afterMultiSessionSingleSignOutUrl:l}=(0,n.useSignOutContext)(),{user:c}=(0,p.aF)(),{t:d}=(0,a.useLocalizations)(),{otherSessions:u}=(0,ez.j)({user:c}),{setActive:m}=(0,p.cL)(),h=(0,p.WZ)(()=>null==c?void 0:c.delete()),v=(0,Z.Yp)("deleteConfirmation","",{type:"text",label:(0,a.localizationKeys)("userProfile.deletePage.actionDescription"),isRequired:!0,placeholder:(0,a.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount")}),f=v.value===(d((0,a.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount"))||"Delete account"),g=async()=>{if(f)try{await h();let e=0===u.length?o:l;return await m({session:null,redirectUrl:e})}catch(e){(0,Z.S3)(e,[],i.setError)}};return(0,r.tZ)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.deletePage.title"),sx:e=>({gap:e.space.$0x5}),children:(0,r.BX)(s.Form.Root,{onSubmit:g,children:[(0,r.BX)(a.Col,{gap:1,children:[(0,r.tZ)(a.Text,{colorScheme:"secondary",localizationKey:(0,a.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,r.tZ)(a.Text,{colorScheme:"danger",localizationKey:(0,a.localizationKeys)("userProfile.deletePage.messageLine2")})]}),(0,r.tZ)(s.Form.ControlRow,{elementId:v.id,children:(0,r.tZ)(s.Form.PlainInput,{...v.props,ignorePasswordManager:!0})}),(0,r.tZ)(s.FormButtons,{submitLabel:(0,a.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!f,onReset:t})]})})}),eR=()=>{let{close:e}=(0,P.XC)();return(0,r.tZ)(eK,{onSuccess:e,onReset:e})},e_=()=>(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",sx:{alignItems:"center",[ei.mqu.md]:{alignItems:"flex-start"}},children:(0,r.BX)(g.a.Root,{children:[(0,r.tZ)(g.a.Closed,{value:"delete",children:(0,r.tZ)(s.ProfileSection.Item,{id:"danger",sx:e=>({paddingLeft:e.space.$1}),children:(0,r.tZ)(g.a.Trigger,{value:"delete",children:(0,r.tZ)(s.ProfileSection.Button,{id:"danger",variant:"ghost",colorScheme:"danger",localizationKey:(0,a.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})})})}),(0,r.tZ)(g.a.Open,{value:"delete",children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(eR,{})})})]})});var eT=i(73531);i(91634),i(98383);var eI=i(95878);let ew=e=>{let{code:t}=e;return(0,r.tZ)(a.Flex,{center:!0,sx:e=>({padding:"".concat(e.space.$1," ").concat(e.space.$4)}),children:(0,r.tZ)(a.Text,{children:t})})},eF=e=>{let{subtitle:t,backupCodes:i}=e,{applicationName:o}=(0,n.useEnvironment)().displayConfig,{user:l}=(0,p.aF)(),{print:s,printableProps:c}=(0,f.Qz)(),{onCopy:d,hasCopied:u}=(0,y.VP)((null==i?void 0:i.join(","))||"");if(!l)return null;let m=(0,eI.xC)(l);return i?(0,r.BX)(r.HY,{children:[(0,r.BX)(a.Col,{gap:1,children:[(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"subtitle"}),(0,r.tZ)(a.Text,{localizationKey:t,variant:"caption",colorScheme:"secondary"})]}),(0,r.BX)(a.Box,{sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg}),children:[(0,r.tZ)(a.Grid,{gap:2,sx:e=>({gridTemplateColumns:"repeat(2, minmax(".concat(e.sizes.$12,", 1fr))"),padding:"".concat(e.space.$4," ").concat(e.space.$6)}),children:i.map((e,t)=>(0,r.tZ)(ew,{code:e},t))}),(0,r.BX)(a.Grid,{sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,gridTemplateColumns:"repeat(3, minmax(0, 1fr))",">:not([hidden])~:not([hidden])":{borderRightWidth:"0px",borderLeftWidth:"1px",borderStyle:"solid",borderColor:e.colors.$neutralAlpha100},">:first-child":{borderBottomLeftRadius:e.radii.$lg},">:last-child":{borderBottomRightRadius:e.radii.$lg}}),children:[(0,r.tZ)(a.Button,{variant:"ghost",sx:e=>({width:"100%",padding:"".concat(e.space.$2," 0"),borderRadius:0}),onClick:()=>{let e=document.createElement("a"),t=new Blob([function(e,t,i){let r=null==e?void 0:e.join("\n");return"These are your backup codes for ".concat(t," account ").concat(i,".\nStore them securely and keep them secret. Each code can only be used once.\n\n").concat(r)}(i,o,m)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="".concat(o,"_backup_codes.txt"),document.body.appendChild(e),e.click()},children:(0,r.tZ)(a.Icon,{icon:eZ.UW})}),(0,r.tZ)(a.Button,{variant:"ghost",sx:e=>({width:"100%",padding:"".concat(e.space.$2," 0"),borderRadius:0}),onClick:s,children:(0,r.tZ)(a.Icon,{icon:eZ.Kh})}),(0,r.tZ)(a.Button,{variant:"ghost",onClick:d,sx:e=>({width:"100%",padding:"".concat(e.space.$2," 0"),borderRadius:0}),children:(0,r.tZ)(a.Icon,{icon:u?eZ.Jr:eZ.CK})})]})]}),(0,r.BX)(f.o4,{...c,children:[(0,r.BX)(a.Heading,{children:["Your backup codes for ",o," account ",m,":"]}),(0,r.tZ)(a.Col,{gap:2,children:i.map((e,t)=>(0,r.tZ)(ew,{code:e},t))})]})]}):null},ek=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i}=e,{user:l}=(0,p.aF)(),n=(0,s.useCardState)(),c=(0,p.WZ)(()=>null==l?void 0:l.createBackupCode()),[d,u]=o.useState(void 0);return(o.useEffect(()=>{!d&&l&&c().then(e=>u(e)).catch(e=>{if((0,eT.mh)(e))return i();(0,Z.S3)(e,[],n.setError)})},[]),n.error)?(0,r.tZ)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.backupCodePage.title")}):(0,r.tZ)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.backupCodePage.title"),children:d?(0,r.BX)(r.HY,{children:[(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.backupCodePage.successMessage")}),(0,r.tZ)(eF,{subtitle:(0,a.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:d.codes}),(0,r.tZ)(s.FormButtonContainer,{children:(0,r.tZ)(a.Button,{autoFocus:!0,onClick:t,localizationKey:(0,a.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:a.descriptors.formButtonPrimary})})]}):(0,r.tZ)(s.FullHeightLoader,{})})}),eA=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i}=e,o=(0,f.a2)();return(0,r.BX)(f.en,{...o.props,children:[(0,r.tZ)(eX,{onContinue:o.nextStep}),(0,r.tZ)(ek,{onSuccess:t,onReset:i})]})}),eX=e=>{let{onContinue:t}=e,{close:i}=(0,P.XC)();return(0,r.BX)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.backupCodePage.title"),children:[(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,r.BX)(s.FormButtonContainer,{sx:{marginTop:0},children:[(0,r.tZ)(a.Button,{textVariant:"buttonSmall",onClick:t,localizationKey:(0,a.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:a.descriptors.formButtonPrimary}),(0,r.tZ)(a.Button,{variant:"ghost",onClick:i,localizationKey:(0,a.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:a.descriptors.formButtonReset})]})]})},eL=(0,s.withCardStateProvider)(e=>{var t,i,l,c;let{onReset:d,onSuccess:u}=e,m=o.useRef(),h=(0,f.a2)({defaultStep:2}),p=null===(t=(0,n.useEnvironment)().userSettings.attributes.backup_code)||void 0===t?void 0:t.enabled;return(0,r.BX)(f.en,{...h.props,children:[(0,r.tZ)(j,{title:(0,a.localizationKeys)("userProfile.phoneNumberPage.title"),resourceRef:m,onSuccess:h.nextStep,onUseExistingNumberClick:()=>h.goToStep(2),onReset:d}),(0,r.tZ)(e$,{title:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:m,onSuccess:()=>p?h.goToStep(3):u(),onReset:()=>h.goToStep(2)}),(0,r.tZ)(eE,{onSuccess:p?h.nextStep:u,onReset:d,onAddPhoneClick:()=>h.goToStep(0),onUnverifiedPhoneClick:e=>{m.current=e,h.goToStep(1)},title:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:m}),p&&(0,r.tZ)(s.SuccessPage,{title:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.successTitle"),text:(null===(i=m.current)||void 0===i?void 0:i.backupCodes)&&(null===(l=m.current)||void 0===l?void 0:l.backupCodes.length)>0?[(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1"),(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage2")]:[(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1")],onFinish:d,contents:(0,r.tZ)(eF,{backupCodes:null===(c=m.current)||void 0===c?void 0:c.backupCodes})})]})}),eD=e=>{let{phone:t,onSuccess:i,onUnverifiedPhoneClick:o,resourceRef:l}=e,n=(0,s.useCardState)(),c=(0,p.WZ)(()=>t.setReservedForSecondFactor({reserved:!0})),{country:d}=(0,Z.Z_)(t.phoneNumber),u=(0,Z.L_)(t.phoneNumber),m=async()=>{if("verified"!==t.verification.status)return o(t);n.setLoading(t.id);try{await c(),l.current=t,i()}catch(e){(0,Z.S3)(e,[],n.setError)}finally{n.setIdle()}};return(0,r.BX)(a.Button,{variant:"outline",colorScheme:"neutral",sx:{justifyContent:"start"},onClick:m,isLoading:n.loadingMetadata===t.id,isDisabled:n.isLoading,children:[d.iso.toUpperCase()," ",u]},t.id)},e$=e=>{var t,i,o;let{title:l,onSuccess:n,resourceRef:c,onReset:d}=e,u=(0,s.useCardState)(),m=c.current,h=(0,p.WZ)(()=>null==m?void 0:m.setReservedForSecondFactor({reserved:!0})),v=async()=>{u.setLoading(null==m?void 0:m.id);try{await h(),c.current=m,n()}catch(e){(0,Z.S3)(e,[],u.setError)}finally{u.setIdle()}};return(0,r.tZ)(s.FormContainer,{headerTitle:l,headerSubtitle:(0,a.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:null===(t=c.current)||void 0===t?void 0:t.phoneNumber}),children:(0,r.tZ)(V.H,{nextStep:()=>{v()},identification:c.current,identifier:null===(i=c.current)||void 0===i?void 0:i.phoneNumber,prepareVerification:null===(o=c.current)||void 0===o?void 0:o.prepareVerification,onReset:d})})},eE=e=>{let{onSuccess:t,onReset:i,title:o,onAddPhoneClick:l,onUnverifiedPhoneClick:n,resourceRef:c}=e,{user:d}=(0,p.aF)();if(!d)return null;let u=d.phoneNumbers.filter(e=>!e.reservedForSecondFactor);return(0,r.BX)(s.FormContainer,{headerTitle:o,gap:1,children:[(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)(u.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers"),colorScheme:"secondary"}),u.length>0&&(0,r.tZ)(a.Col,{gap:2,children:u.map(e=>(0,r.tZ)(eD,{onSuccess:t,phone:e,onUnverifiedPhoneClick:n,resourceRef:c},e.id))}),(0,r.BX)(s.FormButtonContainer,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[(0,r.tZ)(s.IconButton,{variant:"ghost","aria-label":"Add phone number",icon:(0,r.tZ)(a.Icon,{icon:eZ.v3,sx:e=>({marginRight:e.space.$2})}),localizationKey:(0,a.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber"),onClick:l}),(0,r.tZ)(a.Button,{variant:"ghost",localizationKey:(0,a.localizationKeys)("userProfile.formButtonReset"),onClick:i})]})]})},eO=(0,s.withCardStateProvider)(e=>{let{title:t,onSuccess:i,onReset:l}=e,{user:n}=(0,p.aF)(),c=(0,s.useCardState)(),d=(0,p.WZ)(()=>null==n?void 0:n.createTOTP()),{close:u}=(0,P.XC)(),[m,h]=o.useState(void 0),[v,g]=o.useState("qr");return(o.useEffect(()=>{n&&d().then(e=>h(e)).catch(e=>(0,eT.uX)(e)&&"reverification_cancelled"===e.code?u():(0,Z.S3)(e,[],c.setError))},[]),c.error)?(0,r.tZ)(s.FormContainer,{headerTitle:t}):(0,r.BX)(s.FormContainer,{headerTitle:t,headerSubtitle:"qr"==v?(0,a.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan"):(0,a.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan"),children:[!m&&(0,r.tZ)(s.FullHeightLoader,{}),m&&(0,r.BX)(r.HY,{children:[(0,r.BX)(a.Col,{gap:4,children:["qr"==v&&(0,r.tZ)(f.s_,{justify:"center",url:m.uri||""}),"uri"==v&&(0,r.BX)(r.HY,{children:[(0,r.tZ)(a.Text,{colorScheme:"secondary",localizationKey:(0,a.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,r.tZ)(s.ClipboardInput,{value:m.secret}),(0,r.tZ)(a.Text,{colorScheme:"secondary",localizationKey:(0,a.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,r.tZ)(s.ClipboardInput,{value:m.uri})]})]}),(0,r.BX)(a.Flex,{justify:"between",align:"center",sx:{width:"100%"},children:["qr"==v&&(0,r.tZ)(a.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>g("uri"),localizationKey:(0,a.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")}),"uri"==v&&(0,r.tZ)(a.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>g("qr"),localizationKey:(0,a.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")}),(0,r.BX)(s.FormButtonContainer,{children:[(0,r.tZ)(a.Button,{onClick:i,localizationKey:(0,a.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:a.descriptors.formButtonPrimary}),(0,r.tZ)(a.Button,{variant:"ghost",onClick:l,localizationKey:(0,a.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:a.descriptors.formButtonReset})]})]})]})]})}),eN=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i,resourceRef:o}=e,{user:l}=(0,p.aF)(),n=(0,s.useFieldOTP)({onCodeEntryFinished:(e,t,i)=>{null==l||l.verifyTOTP({code:e}).then(e=>t(e)).catch(i)},onResolve:e=>{o.current=e,t()}});return(0,r.BX)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.mfaTOTPPage.title"),children:[(0,r.tZ)(a.Col,{children:(0,r.tZ)(s.Form.OTPInput,{...n,label:(0,a.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),description:(0,a.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle")})}),(0,r.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,r.tZ)(a.Button,{onClick:i,variant:"ghost",isDisabled:n.isLoading,localizationKey:(0,a.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:a.descriptors.formButtonReset})})]})}),eW=(0,s.withCardStateProvider)(e=>{var t;let{onReset:i}=e,l=(0,f.a2)(),n=o.useRef();return(0,r.BX)(f.en,{...l.props,children:[(0,r.tZ)(eO,{title:(0,a.localizationKeys)("userProfile.mfaTOTPPage.title"),onSuccess:l.nextStep,onReset:i}),(0,r.tZ)(eN,{onSuccess:l.nextStep,onReset:i,resourceRef:n}),(0,r.tZ)(s.SuccessPage,{title:(0,a.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,a.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),onFinish:i,contents:(0,r.tZ)(eF,{subtitle:(0,a.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:null===(t=n.current)||void 0===t?void 0:t.backupCodes})})]})}),eM=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i,selectedStrategy:l}=e,c=(0,s.useCardState)(),{userSettings:{attributes:d}}=(0,n.useEnvironment)(),{user:u}=(0,p.aF)();if(!u)return null;let m=(0,a.localizationKeys)("userProfile.mfaPage.title"),h=o.useMemo(()=>D(d,u),[]);return(o.useEffect(()=>{0===h.length&&c.setError("There are no second factors available to add")},[]),c.error)?(0,r.tZ)(s.FormContainer,{headerTitle:m}):0!==h.length||l?(0,r.tZ)(eU,{onSuccess:t,onReset:i,method:l||h[0]}):null}),eU=e=>{let{method:t,onSuccess:i,onReset:o}=e;switch(t){case"phone_code":return(0,r.tZ)(eL,{onSuccess:i,onReset:o});case"totp":return(0,r.tZ)(eW,{onSuccess:i,onReset:o});case"backup_code":return(0,r.tZ)(eA,{onSuccess:i,onReset:o});default:return null}},eH=()=>{let{close:e}=(0,P.XC)();return(0,r.tZ)(R,{onSuccess:e,onReset:e})},eq=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(K,{onSuccess:t,onReset:t,...e})},eV=()=>{let{close:e}=(0,P.XC)();return(0,r.tZ)(ek,{onSuccess:e,onReset:e})},eY=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(eM,{onSuccess:t,onReset:t,selectedStrategy:e.selectedStrategy})},ej=()=>{let{userSettings:{attributes:e}}=(0,n.useEnvironment)(),{user:t}=(0,p.aF)(),[i,l]=(0,o.useState)(null);if(!t)return null;let c=L(e),d=D(e,t),u=c.includes("totp")&&t.totpEnabled,m=c.includes("backup_code")&&t.backupCodeEnabled,h=t.phoneNumbers.filter(e=>"verified"===e.verification.status).filter(e=>e.reservedForSecondFactor).sort(X);return(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.mfaSection.title"),centered:!1,id:"mfa",children:(0,r.tZ)(g.a.Root,{value:i,onChange:l,children:(0,r.BX)(s.ProfileSection.ItemList,{id:"mfa",children:[u&&(0,r.BX)(r.HY,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,r.BX)(a.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,r.tZ)(a.Icon,{icon:eZ.hc,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")}),(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__default")})]}),(0,r.tZ)(eJ,{})]}),(0,r.tZ)(g.a.Open,{value:"remove-totp",children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(eH,{})})})]}),c.includes("phone_code")&&h.map(e=>{let t=!u&&e.defaultSecondFactor,i=e.id;return(0,r.BX)(o.Fragment,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,r.BX)(a.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,r.tZ)(a.Icon,{icon:eZ.ij,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,r.BX)(a.Text,{children:["SMS Code ",(0,r.tZ)(s.FormattedPhoneNumberText,{value:e.phoneNumber})]}),t&&(0,r.tZ)(a.Badge,{localizationKey:(0,a.localizationKeys)("badge__default")})]}),(0,r.tZ)(eG,{phone:e,showTOTP:u})]}),(0,r.tZ)(g.a.Open,{value:"remove-".concat(i),children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(eq,{phoneId:i})})})]},i)}),m&&(0,r.BX)(r.HY,{children:[(0,r.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,r.BX)(a.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,r.tZ)(a.Icon,{icon:eZ.Qi,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,r.tZ)(a.Text,{localizationKey:(0,a.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")})]}),(0,r.tZ)(eQ,{})]}),(0,r.tZ)(g.a.Open,{value:"regenerate",children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(eV,{})})})]}),(0,r.tZ)(e0,{secondFactorsAvailableToAdd:d,onClick:()=>l(null)})]})})})},eG=e=>{let{phone:t,showTOTP:i}=e,{open:o}=(0,P.XC)(),l=(0,s.useCardState)(),n=t.id,c=[i?null:{label:(0,a.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>t.makeDefaultSecondFactor().catch(e=>(0,Z.S3)(e,[],l.setError)),isDisabled:t.defaultSecondFactor},{label:(0,a.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),isDestructive:!0,onClick:()=>o("remove-".concat(n))}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:c})},eQ=()=>{let{open:e}=(0,P.XC)(),t=[{label:(0,a.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("regenerate")}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:t})},eJ=()=>{let{open:e}=(0,P.XC)(),t=[{label:(0,a.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),isDestructive:!0,onClick:()=>e("remove-totp")}].filter(e=>null!==e);return(0,r.tZ)(s.ThreeDotsMenu,{actions:t})},e0=e=>{let{open:t}=(0,P.XC)(),{secondFactorsAvailableToAdd:i,onClick:l}=e,[n,c]=(0,o.useState)(),d=o.useMemo(()=>i.map(e=>"phone_code"===e?{icon:eZ.ij,text:"SMS code",key:"phone_code"}:"totp"===e?{icon:eZ.hc,text:"Authenticator application",key:"totp"}:"backup_code"===e?{icon:eZ.Qi,text:"Backup code",key:"backup_code"}:null).filter(e=>null!==e),[i]);return(0,r.BX)(r.HY,{children:[i.length>0&&(0,r.tZ)(g.a.Closed,{value:"multi-factor",children:(0,r.tZ)(s.ProfileSection.ActionMenu,{id:"mfa",triggerLocalizationKey:(0,a.localizationKeys)("userProfile.start.mfaSection.primaryButton"),onClick:l,children:d.map(e=>e&&(0,r.tZ)(s.ProfileSection.ActionMenuItem,{id:e.key,localizationKey:e.text,leftIcon:e.icon,onClick:()=>{c(e.key),t("multi-factor")}},e.key))})}),(0,r.tZ)(g.a.Open,{value:"multi-factor",children:(0,r.tZ)(g.a.Card,{children:n&&(0,r.tZ)(eY,{selectedStrategy:n})})})]})},e1=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(_,{onSuccess:t,onReset:t,...e})},e3=e=>{let{close:t}=(0,P.XC)();return(0,r.tZ)(e2,{onSuccess:t,onReset:t,passkey:e.passkey})},e2=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i,passkey:o}=e,l=(0,s.useCardState)(),n=(0,Z.Yp)("passkeyName",o.name||"",{type:"text",label:(0,a.localizationKeys)("formFieldLabel__passkeyName"),isRequired:!0}),c=n.value.length>1&&o.name!==n.value,d=async e=>(e.preventDefault(),o.update({name:n.value}).then(t).catch(e=>(0,Z.S3)(e,[n],l.setError)));return(0,r.tZ)(s.FormContainer,{headerTitle:(0,a.localizationKeys)("userProfile.passkeyScreen.title__rename"),headerSubtitle:(0,a.localizationKeys)("userProfile.passkeyScreen.subtitle__rename"),children:(0,r.BX)(s.Form.Root,{onSubmit:d,children:[(0,r.tZ)(s.Form.ControlRow,{elementId:n.id,children:(0,r.tZ)(s.Form.PlainInput,{...n.props,autoComplete:"off"})}),(0,r.tZ)(s.FormButtons,{submitLabel:(0,a.localizationKeys)("userProfile.formButtonPrimary__save"),isDisabled:!c,onReset:i})]})})}),e4=()=>{let{user:e}=(0,p.aF)(),[t,i]=(0,o.useState)(null);return e?(0,r.tZ)(s.ProfileSection.Root,{title:(0,a.localizationKeys)("userProfile.start.passkeysSection.title"),centered:!1,id:"passkeys",children:(0,r.tZ)(g.a.Root,{value:t,onChange:i,children:(0,r.BX)(s.ProfileSection.ItemList,{id:"passkeys",children:[e.passkeys.map(e=>{let t=e.id;return(0,r.BX)(o.Fragment,{children:[(0,r.tZ)(e5,{...e},t),(0,r.tZ)(g.a.Open,{value:"remove-".concat(t),children:(0,r.tZ)(g.a.Card,{variant:"destructive",children:(0,r.tZ)(e1,{passkey:e})})}),(0,r.tZ)(g.a.Open,{value:"rename-".concat(t),children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(e3,{passkey:e})})})]},t)}),(0,r.tZ)(e8,{onClick:()=>i(null)})]})})}):null},e5=e=>(0,r.BX)(s.ProfileSection.Item,{id:"passkeys",hoverable:!0,sx:{alignItems:"flex-start"},children:[(0,r.tZ)(e9,{...e}),(0,r.tZ)(e6,{passkey:e})]}),e9=e=>{let{name:t,createdAt:i,lastUsedAt:o}=e,{t:l}=(0,a.useLocalizations)();return(0,r.tZ)(a.Flex,{sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[ei.mqu.sm]:{gap:e.space.$2}}),children:(0,r.BX)(a.Col,{align:"start",gap:1,children:[(0,r.tZ)(a.Text,{children:t}),(0,r.BX)(a.Text,{colorScheme:"secondary",children:["Created: ",l((0,Z.Qg)(i))]}),o&&(0,r.BX)(a.Text,{colorScheme:"secondary",children:["Last used: ",l((0,Z.Qg)(o))]})]})})},e6=e=>{let{passkey:t}=e,{open:i}=(0,P.XC)(),o=t.id,l=[{label:(0,a.localizationKeys)("userProfile.start.passkeysSection.menuAction__rename"),onClick:()=>i("rename-".concat(o))},{label:(0,a.localizationKeys)("userProfile.start.passkeysSection.menuAction__destructive"),isDestructive:!0,onClick:()=>i("remove-".concat(o))}];return(0,r.tZ)(s.ThreeDotsMenu,{actions:l})},e8=e=>{let{onClick:t}=e,i=(0,s.useCardState)(),{isSatellite:o}=(0,p.cL)(),{user:l}=(0,p.aF)(),n=(0,p.WZ)(()=>null==l?void 0:l.createPasskey()),c=async()=>{if(null==t||t(),l)try{await n()}catch(e){(0,Z.S3)(e,[],i.setError)}};return o?null:(0,r.tZ)(s.ProfileSection.ArrowButton,{id:"passkeys",localizationKey:(0,a.localizationKeys)("userProfile.start.passkeysSection.primaryButton"),onClick:c})},e7=(e,t)=>{let i=[];return e?i.push((0,a.localizationKeys)("userProfile.passwordPage.successMessage__update")):i.push((0,a.localizationKeys)("userProfile.passwordPage.successMessage__set")),t&&i.push((0,a.localizationKeys)("userProfile.passwordPage.successMessage__signOutOfOtherSessions")),i},te=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:i}=e,{user:l}=(0,p.aF)(),c=(0,p.WZ)((e,t)=>e.updatePassword(...t));if(!l)return null;let{userSettings:{passwordSettings:d},authConfig:{reverification:u}}=(0,n.useEnvironment)(),{session:m}=(0,p.kP)(),h=l.passwordEnabled?(0,a.localizationKeys)("userProfile.passwordPage.title__update"):(0,a.localizationKeys)("userProfile.passwordPage.title__set"),v=(0,s.useCardState)(),f=l.enterpriseAccounts.some(e=>e.active),g=l.passwordEnabled&&!u,P=(0,o.useRef)({title:(0,a.localizationKeys)("userProfile.passwordPage.title__set")}),b=(0,Z.Yp)("currentPassword","",{type:"password",label:(0,a.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),S=(0,Z.Yp)("newPassword","",{type:"password",label:(0,a.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,Z.GM)(e,{t:K,locale:R,passwordSettings:d})}),C=(0,Z.Yp)("confirmPassword","",{type:"password",label:(0,a.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),x=(0,Z.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,a.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:B,isPasswordMatch:z}=(0,y.p5)({passwordField:S,confirmPasswordField:C}),{t:K,locale:R}=(0,a.useLocalizations)(),_=(g?b.value&&z:z)&&S.value&&C.value,T=async()=>{try{P.current={title:l.passwordEnabled?(0,a.localizationKeys)("userProfile.passwordPage.title__update"):(0,a.localizationKeys)("userProfile.passwordPage.title__set"),text:e7(l.passwordEnabled,!!x.checked)};let e={newPassword:S.value,signOutOfOtherSessions:x.checked,currentPassword:g?b.value:void 0};await c(l,[e]),t()}catch(e){(0,Z.S3)(e,[b,S,C],v.setError)}};return(0,r.BX)(s.FormContainer,{headerTitle:h,children:[f&&(0,r.tZ)(s.InformationBox,{message:(0,a.localizationKeys)("userProfile.passwordPage.readonly")}),(0,r.BX)(s.Form.Root,{onSubmit:T,onBlur:()=>{S.value&&B(C.value)},children:[(0,r.tZ)("input",{readOnly:!0,"data-testid":"hidden-identifier",id:"identifier-field",name:"identifier",value:(null==m?void 0:m.publicUserData.identifier)||"",style:{display:"none"}}),g&&(0,r.tZ)(s.Form.ControlRow,{elementId:b.id,children:(0,r.tZ)(s.Form.PasswordInput,{...b.props,minLength:6,isRequired:!0,autoFocus:!0,isDisabled:f})}),(0,r.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,r.tZ)(s.Form.PasswordInput,{...S.props,minLength:6,isRequired:!0,autoFocus:!l.passwordEnabled,isDisabled:f})}),(0,r.tZ)(s.Form.ControlRow,{elementId:C.id,children:(0,r.tZ)(s.Form.PasswordInput,{...C.props,onChange:e=>(e.target.value&&B(e.target.value),C.props.onChange(e)),isRequired:!0,isDisabled:f})}),(0,r.tZ)(s.Form.ControlRow,{elementId:x.id,children:(0,r.tZ)(s.Form.Checkbox,{...x.props,description:(0,a.localizationKeys)("userProfile.passwordPage.checkboxInfoText__signOutOfOtherSessions"),isDisabled:f})}),f?(0,r.tZ)(s.FormButtonContainer,{children:(0,r.tZ)(s.Form.ResetButton,{localizationKey:(0,a.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:i})}):(0,r.tZ)(s.FormButtons,{isDisabled:!_,onReset:i})]})]})}),tt=()=>{let{close:e}=(0,P.XC)();return(0,r.tZ)(te,{onSuccess:e,onReset:e})},ti=()=>{let{user:e}=(0,p.aF)();if(!e)return null;let{passwordEnabled:t}=e;return(0,r.tZ)(s.ProfileSection.Root,{centered:!1,title:(0,a.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:(0,r.BX)(g.a.Root,{children:[(0,r.tZ)(g.a.Closed,{value:"edit",children:(0,r.BX)(s.ProfileSection.Item,{id:"password",sx:e=>({paddingLeft:t?void 0:"0",paddingTop:e.space.$0x25,paddingBottom:e.space.$0x25}),children:[t&&(0,r.tZ)(a.Text,{variant:"h2",children:"••••••••••"}),(0,r.tZ)(g.a.Trigger,{value:"edit",children:(0,r.tZ)(s.ProfileSection.Button,{id:"password",localizationKey:t?(0,a.localizationKeys)("userProfile.start.passwordSection.primaryButton__updatePassword"):(0,a.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})})]})}),(0,r.tZ)(g.a.Open,{value:"edit",children:(0,r.tZ)(g.a.Card,{children:(0,r.tZ)(tt,{})})})]})})},tr=(0,s.withCardStateProvider)(()=>{var e;let{attributes:t,instanceIsPasswordBased:i}=(0,n.useEnvironment)().userSettings,o=(0,s.useCardState)(),{user:l}=(0,p.aF)(),c=null===(e=t.passkey)||void 0===e?void 0:e.enabled,d=L(t).length>0,u=null==l?void 0:l.deleteSelfEnabled;return(0,r.tZ)(a.Col,{elementDescriptor:a.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,r.BX)(a.Col,{elementDescriptor:a.descriptors.profilePage,elementId:a.descriptors.profilePage.setId("security"),children:[(0,r.tZ)(s.Header.Root,{children:(0,r.tZ)(s.Header.Title,{localizationKey:(0,a.localizationKeys)("userProfile.start.headerTitle__security"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,r.tZ)(s.Card.Alert,{children:o.error}),i&&(0,r.tZ)(ti,{}),c&&(0,r.tZ)(e4,{}),d&&(0,r.tZ)(ej,{}),(0,r.tZ)(eb,{}),u&&(0,r.tZ)(e_,{})]})})}),to=(0,o.lazy)(()=>Promise.all([i.e("507"),i.e("573"),i.e("82")]).then(i.bind(i,41470)).then(e=>({default:e.BillingPage}))),tl=()=>{var e;let{pages:t}=(0,n.useUserProfileContext)(),{__experimental_commerceSettings:i}=(0,n.useEnvironment)(),a=t.routes[0].id===l.xM.ACCOUNT,s=t.routes[0].id===l.xM.SECURITY,d=t.routes[0].id===l.xM.BILLING,u=null===(e=t.contents)||void 0===e?void 0:e.map((e,t)=>{let i=!a&&!s&&0===t;return(0,r.tZ)(c.Route,{index:i,path:i?void 0:e.url,children:(0,r.tZ)(m.O,{mount:e.mount,unmount:e.unmount})},"custom-page-".concat(e.url))});return(0,r.BX)(c.Switch,{children:[u,(0,r.BX)(c.Route,{children:[(0,r.tZ)(c.Route,{path:a?void 0:"account",children:(0,r.tZ)(c.Switch,{children:(0,r.tZ)(c.Route,{index:!0,children:(0,r.tZ)(ef,{})})})}),(0,r.tZ)(c.Route,{path:s?void 0:"security",children:(0,r.tZ)(c.Switch,{children:(0,r.tZ)(c.Route,{index:!0,children:(0,r.tZ)(tr,{})})})}),i.billing.enabled&&i.billing.hasPaidUserPlans&&(0,r.tZ)(c.Route,{path:d?void 0:"billing",children:(0,r.BX)(c.Switch,{children:[(0,r.tZ)(c.Route,{index:!0,children:(0,r.tZ)(o.Suspense,{fallback:"",children:(0,r.tZ)(to,{})})}),(0,r.tZ)(c.Route,{path:"plans",children:(0,r.tZ)(o.Suspense,{fallback:"",children:(0,r.tZ)(ey,{})})}),(0,r.tZ)(c.Route,{path:"invoice/:invoiceId",children:(0,r.tZ)(o.Suspense,{fallback:"",children:(0,r.tZ)(h.J,{})})})]})})]})]})};var tn=i(12786);let ta=(0,n.withCoreUserGuard)(()=>{let e=o.useRef(null);return(0,r.tZ)(s.ProfileCard.Root,{children:(0,r.BX)(u,{contentRef:e,children:[(0,r.tZ)(s.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,a.localizationKeys)("userProfile.navbar.title")}),(0,r.tZ)(s.ProfileCard.Content,{contentRef:e,scrollBoxId:l.g8,children:(0,r.tZ)(tl,{})})]})})}),ts=(0,s.withCardStateProvider)(e=>(0,r.tZ)(a.Flow.Root,{flow:"userProfile",children:(0,r.tZ)(a.Flow.Part,{children:(0,r.BX)(c.Switch,{children:[(0,r.tZ)(c.Route,{path:"verify",children:(0,r.tZ)(tn.M,{})}),(0,r.tZ)(c.Route,{children:(0,r.tZ)(ta,{})})]})})})),tc=e=>{let t={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,r.tZ)(c.Route,{path:"user",children:(0,r.tZ)(n.UserProfileContext.Provider,{value:t,children:(0,r.tZ)("div",{children:(0,r.tZ)(ts,{...t})})})})}}}]);