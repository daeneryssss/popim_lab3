"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["470"],{1171:function(e,t,r){r.d(t,{J:()=>f});var i=r(8635),o=r(8756),n=r(3064),a=r(6106),l=r(4229),s=r(6258),c=r(4676),d=r(1201),u=r(43),m=r(5913);let h=()=>{let{params:e,navigate:t}=(0,c.useRouter)(),{getInvoiceById:r,isLoading:l}=(0,o.useInvoicesContext)(),s=e.invoiceId?r(e.invoiceId):null;return l?(0,i.tZ)(n.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,i.tZ)(n.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:n.descriptors.spinner})}):(0,i.BX)(i.HY,{children:[(0,i.tZ)(a.Header.Root,{children:(0,i.tZ)(a.Header.BackLink,{onClick:()=>void t("../../",{searchParams:new URLSearchParams("tab=invoices")}),children:(0,i.tZ)(a.Header.Title,{localizationKey:"Invoices",textVariant:"h2"})})}),(0,i.tZ)(n.Box,{elementDescriptor:n.descriptors.invoiceRoot,sx:e=>({display:"flex",flexDirection:"column",gap:e.space.$4,borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,marginBlockStart:e.space.$4,paddingBlockStart:e.space.$4}),children:s?(0,i.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceCard,sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg,overflow:"hidden"}),children:[(0,i.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceHeader,as:"header",sx:e=>({padding:e.space.$4,background:d.common.mergedColorsBackground(u.O9.setAlpha(e.colors.$colorBackground,1),e.colors.$neutralAlpha50),borderBlockEndWidth:e.borderWidths.$normal,borderBlockEndStyle:e.borderStyles.$solid,borderBlockEndColor:e.colors.$neutralAlpha100}),children:[(0,i.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceHeaderTitleBadgeContainer,sx:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,i.BX)(n.Span,{elementDescriptor:n.descriptors.invoiceTitleIdContainer,children:[(0,i.tZ)(n.Heading,{textVariant:"h2",elementDescriptor:n.descriptors.invoiceTitle,children:"Invoice ID"}),(0,i.BX)(n.Span,{elementDescriptor:n.descriptors.invoiceIdContainer,sx:e=>({display:"flex",alignItems:"center",gap:e.space.$0x25,color:e.colors.$colorTextSecondary}),children:[(0,i.tZ)(p,{copyLabel:"Copy invoice ID",text:s.id}),(0,i.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceId,colorScheme:"secondary",variant:"subtitle",children:(0,m.L)(s.id)})]})]}),(0,i.tZ)(n.Badge,{elementDescriptor:n.descriptors.invoiceBadge,colorScheme:"paid"===s.status?"success":"unpaid"===s.status?"warning":"danger",sx:{textTransform:"capitalize"},children:s.status})]}),(0,i.BX)(n.Dl,{elementDescriptor:n.descriptors.invoiceDetails,sx:e=>({display:"flex",justifyContent:"space-between",marginBlockStart:e.space.$3}),children:[(0,i.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceDetailsItem,children:[(0,i.tZ)(n.Dt,{elementDescriptor:n.descriptors.invoiceDetailsItemTitle,children:(0,i.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemTitleText,colorScheme:"secondary",variant:"body",children:"Created on"})}),(0,i.tZ)(n.Dd,{elementDescriptor:n.descriptors.invoiceDetailsItemValue,children:(0,i.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemValueText,variant:"subtitle",children:new Date(s.paymentDueOn).toLocaleDateString()})})]}),(0,i.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceDetailsItem,sx:{textAlign:"right"},children:[(0,i.tZ)(n.Dt,{elementDescriptor:n.descriptors.invoiceDetailsItemTitle,children:(0,i.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemTitleText,colorScheme:"secondary",variant:"body",children:"Due on"})}),(0,i.tZ)(n.Dd,{elementDescriptor:n.descriptors.invoiceDetailsItemValue,children:(0,i.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemValueText,variant:"subtitle",children:new Date(s.paymentDueOn).toLocaleDateString()})})]})]})]}),(0,i.tZ)(n.Box,{elementDescriptor:n.descriptors.invoiceContent,sx:e=>({padding:e.space.$4}),children:(0,i.BX)(a.LineItems.Root,{children:[(0,i.BX)(a.LineItems.Group,{children:[(0,i.tZ)(a.LineItems.Title,{title:"Plan"}),(0,i.tZ)(a.LineItems.Description,{text:`${s.totals.grandTotal.currencySymbol}${s.totals.grandTotal.amountFormatted}`,suffix:"per month"})]}),(0,i.BX)(a.LineItems.Group,{variant:"secondary",borderTop:!0,children:[(0,i.tZ)(a.LineItems.Title,{title:"Subtotal"}),(0,i.tZ)(a.LineItems.Description,{text:`${s.totals.grandTotal.currencySymbol}${s.totals.grandTotal.amountFormatted}`})]}),(0,i.BX)(a.LineItems.Group,{variant:"secondary",children:[(0,i.tZ)(a.LineItems.Title,{title:"Tax"}),(0,i.tZ)(a.LineItems.Description,{text:`${s.totals.taxTotal.currencySymbol}${s.totals.taxTotal.amountFormatted}`})]}),(0,i.BX)(a.LineItems.Group,{borderTop:!0,children:[(0,i.tZ)(a.LineItems.Title,{title:"Total due"}),(0,i.tZ)(a.LineItems.Description,{text:`${s.totals.grandTotal.currencySymbol}${s.totals.grandTotal.amountFormatted}`,prefix:"USD"})]})]})})]}):(0,i.tZ)(n.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,i.tZ)(n.Text,{children:"Invoice not found"})})})]})};function p({text:e,copyLabel:t="Copy"}){let{onCopy:r,hasCopied:o}=(0,l.VP)(e);return(0,i.tZ)(n.Button,{elementDescriptor:n.descriptors.invoiceCopyButton,variant:"unstyled",onClick:r,sx:e=>({color:"inherit",width:e.sizes.$4,height:e.sizes.$4,padding:0,borderRadius:e.radii.$sm,"&:focus-visible":{outline:"2px solid",outlineColor:e.colors.$neutralAlpha200}}),focusRing:!1,"aria-label":o?"Copied":t,children:(0,i.tZ)(n.Icon,{size:"sm",icon:o?s.Jr:s.CK,"aria-hidden":!0})})}let f=()=>(0,i.tZ)(o.InvoicesContextProvider,{children:(0,i.tZ)(h,{})})},9140:function(e,t,r){r.d(t,{_:()=>P});var i=r(8635),o=r(3799),n=r(9144),a=r(8969),l=r(8756),s=r(6106),c=r(1085),d=r(43),u=r(207),m=r(4676),h=r(6917),p=r(3064),f=r(4229);let g=e=>{let{navigate:t}=(0,m.useRouter)(),{email:r,nextStep:o,onReset:a}=e,c=(0,s.useCardState)(),u=(0,l.useUserProfileContext)(),{startEnterpriseSSOLinkFlow:g}=(0,f.eq)(r);async function v(){await t(r.verification.externalVerificationRedirectURL?.href||"")}return n.useEffect(()=>{!function(){let{mode:e,componentName:t}=u;g({redirectUrl:"modal"===e?(0,h.bX)({url:window.location.href,componentName:t}):window.location.href}).then(()=>o()).catch(e=>(0,d.S3)(e,[],c.setError))}()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(p.Flex,{justify:"center",children:(0,i.tZ)(p.Button,{variant:"link",onClick:v,localizationKey:(0,p.localizationKeys)("userProfile.emailAddressPage.enterpriseSSOLink.formButton")})}),(0,i.tZ)(s.FormButtonContainer,{children:(0,i.tZ)(p.Button,{variant:"ghost",localizationKey:(0,p.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:p.descriptors.formButtonReset,onClick:a})})]})};var v=r(2786);let P=(0,s.withCardStateProvider)(e=>{let{emailId:t,onSuccess:r,onReset:m,disableAutoFocus:h=!1}=e,p=(0,s.useCardState)(),{user:f}=(0,o.aF)(),P=(0,l.useEnvironment)(),b=(0,o.WZ)(e=>f?.createEmailAddress({email:e})),S=n.useRef(f?.emailAddresses.find(e=>e.id===t)),C=Z(S.current,P),x=(0,a.a2)({defaultStep:+!!S.current,onNextStep:()=>p.setError(void 0)}),B=(0,d.Yp)("emailAddress","",{type:"email",label:(0,c.u1)("formFieldLabel__emailAddress"),placeholder:(0,c.u1)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),z=B.value.length>1&&f?.username!==B.value,K=async e=>{if(e.preventDefault(),f)return b(B.value).then(e=>{S.current=e,x.nextStep()}).catch(e=>(0,d.S3)(e,[B],p.setError))},R=y(C);return(0,i.BX)(a.en,{...x.props,children:[(0,i.tZ)(s.FormContainer,{headerTitle:e.title||(0,c.u1)("userProfile.emailAddressPage.title"),headerSubtitle:e.subtitle||(0,c.u1)("userProfile.emailAddressPage.formHint"),children:(0,i.BX)(s.Form.Root,{onSubmit:K,children:[(0,i.tZ)(s.Form.ControlRow,{elementId:B.id,children:(0,i.tZ)(s.Form.PlainInput,{...B.props,autoFocus:!h})}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,c.u1)("userProfile.formButtonPrimary__add"),isDisabled:!z,onReset:m})]})}),(0,i.BX)(s.FormContainer,{headerTitle:(0,c.u1)("userProfile.emailAddressPage.verifyTitle"),headerSubtitle:(0,c.u1)(`${R}.formSubtitle`,{identifier:S.current?.emailAddress}),children:["email_link"===C&&(0,i.tZ)(v.K,{nextStep:r,email:S.current,onReset:m}),"email_code"===C&&(0,i.tZ)(u.H,{nextStep:r,identification:S.current,identifier:S.current?.emailAddress,prepareVerification:()=>S.current?.prepareVerification({strategy:"email_code"}),onReset:m}),"enterprise_sso"===C&&(0,i.tZ)(g,{nextStep:r,email:S.current,onReset:m})]})]})}),y=e=>{switch(e){case"email_code":return"userProfile.emailAddressPage.emailCode";case"enterprise_sso":return"userProfile.emailAddressPage.enterpriseSSOLink";case"email_link":return"userProfile.emailAddressPage.emailLink";default:throw Error(`Unsupported strategy for email verification: ${e}`)}},Z=(e,t)=>e?.matchesSsoConnection?"enterprise_sso":!function(e){let{userSettings:t}=e,{email_address:r}=t.attributes;return!!(r?.enabled&&r?.verifications.includes("email_link"))}(t)?"email_code":"email_link"},207:function(e,t,r){r.d(t,{H:()=>s});var i=r(8635),o=r(9144),n=r(3064),a=r(6106),l=r(43);let s=e=>{let t=(0,a.useCardState)(),{nextStep:r,identification:s,identifier:c,onReset:d,prepareVerification:u}=e,m=()=>u?.()?.catch(e=>l.S3(e,[],t.setError)),h=(0,a.useFieldOTP)({onCodeEntryFinished:(e,t,r)=>{s?.attemptVerification({code:e}).then(()=>t()).catch(r)},onResendCodeClicked:m,onResolve:r});return o.useEffect(()=>{m()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(a.Form.OTPInput,{...h,label:(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),description:(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:c}),resendButton:(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),centerAlign:!1}),(0,i.BX)(a.FormButtonContainer,{children:[(0,i.tZ)(n.Button,{isLoading:h.isLoading,localizationKey:(0,n.localizationKeys)("formButtonPrimary__verify"),elementDescriptor:n.descriptors.formButtonPrimary,onClick:h.onFakeContinue}),(0,i.tZ)(n.Button,{variant:"ghost",isDisabled:h.isLoading,localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:n.descriptors.formButtonReset,onClick:d})]})]})}},2786:function(e,t,r){r.d(t,{K:()=>m,M:()=>h});var i=r(8635),o=r(9144),n=r(8969),a=r(6749),l=r(8756),s=r(3064),c=r(6106),d=r(4229),u=r(43);let m=e=>{let{email:t,nextStep:r,onReset:n}=e,m=(0,c.useCardState)(),h=(0,l.useUserProfileContext)(),{startEmailLinkFlow:p}=(0,d.E2)(t),{displayConfig:f}=(0,l.useEnvironment)();function g(){let{routing:e}=h,t="virtual"===e?f.userProfileUrl:"";p({redirectUrl:(0,a.Uu)({ctx:h,baseUrl:t,intent:"profile"})}).then(()=>r()).catch(e=>(0,u.S3)(e,[],m.setError))}return o.useEffect(()=>{g()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.VerificationLink,{resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:g}),(0,i.tZ)(c.FormButtonContainer,{children:(0,i.tZ)(s.Button,{variant:"ghost",localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset,onClick:n})})]})},h=()=>(0,i.tZ)(n.Ej,{title:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"})},9248:function(e,t,r){r.r(t),r.d(t,{UserProfile:()=>ts,UserProfileModal:()=>tc});var i=r(8635),o=r(9144),n=r(1673),a=r(8756),l=r(3064),s=r(6106),c=r(4676),d=r(1085);let u=e=>{let{pages:t}=(0,a.useUserProfileContext)();return(0,i.BX)(s.NavbarContextProvider,{children:[(0,i.tZ)(s.NavBar,{title:(0,d.u1)("userProfile.navbar.title"),description:(0,d.u1)("userProfile.navbar.description"),routes:t.routes,contentRef:e.contentRef}),e.children]})};var m=r(4995),h=r(1171),p=r(3799),f=r(6917),g=r(8969),v=r(9805),P=r(4709),y=r(4229),Z=r(43);let b=e=>{let{strategy:t}=e,r=(0,s.useCardState)(),{user:o}=(0,p.aF)(),{navigate:n}=(0,c.useRouter)(),{strategyToDisplayData:d}=(0,y.vO)(),{additionalOAuthScopes:u,componentName:m,mode:h}=(0,a.useUserProfileContext)(),v="modal"===h,P=(0,p.WZ)(()=>{let e=t.replace("oauth_",""),r=v?(0,f.bX)({url:window.location.href,componentName:m,socialProvider:e}):window.location.href,i=u?u[e]:[];return o?.createExternalAccount({strategy:t,redirectUrl:r,additionalScopes:i})}),b=d[t].iconUrl?(0,i.tZ)(l.Image,{isLoading:r.loadingMetadata===t,isDisabled:r.isLoading,elementDescriptor:l.descriptors.providerIcon,elementId:l.descriptors.providerIcon.setId(d[t].id),src:d[t].iconUrl,alt:`Connect ${d[t].name} account`,sx:e=>({width:e.sizes.$4})}):(0,i.tZ)(g.e_,{id:d[t].id,value:d[t].name,isLoading:r.loadingMetadata===t,isDisabled:r.isLoading});return(0,i.tZ)(s.ProfileSection.ActionMenuItem,{id:d[t].id,onClick:()=>{if(o)return r.setLoading(t),P().then(e=>{e&&e.verification?.externalVerificationRedirectURL&&((0,Z._v)(2e3).then(()=>r.setIdle(t)),n(e.verification.externalVerificationRedirectURL.href))}).catch(e=>{(0,Z.S3)(e,[],r.setError),r.setIdle(t)})},isDisabled:r.isLoading,variant:"ghost",isLoading:r.loadingMetadata===t,focusRing:!1,closeAfterClick:!1,localizationKey:(0,l.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:d[t].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:b},t)},S=({onClick:e})=>{let{user:t}=(0,p.aF)(),{strategies:r}=(0,y.vO)(),o=r.filter(e=>e.startsWith("oauth")),n=t?.verifiedExternalAccounts.map(e=>`oauth_${e.provider}`),a=o.filter(e=>!n.includes(e));return 0===a.length?null:(0,i.tZ)(s.ProfileSection.ActionMenu,{triggerLocalizationKey:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",onClick:e,children:a.map(e=>(0,i.tZ)(b,{strategy:e},e))})},C=e=>{let{onSuccess:t,onReset:r}=e,{user:n}=(0,p.aF)(),{emailId:a}=e,s=n?.emailAddresses.find(e=>e.id===a),c=o.useRef(s?.emailAddress),d=s?.verification?.status==="verified"?(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"):void 0;return c.current?(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:c.current}),messageLine2:d,successMessage:(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:c.current}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:t,onReset:r}):null},x=e=>{let{phoneId:t,onSuccess:r,onReset:n}=e,{user:a}=(0,p.aF)(),s=a?.phoneNumbers.find(e=>e.id===t),c=o.useRef(s?.phoneNumber),d=s?.verification?.status==="verified"?(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"):void 0;return c.current?(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:c.current}),messageLine2:d,successMessage:(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:c.current}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:r,onReset:n}):null},B=e=>{let{accountId:t,onSuccess:r,onReset:n}=e,{user:a}=(0,p.aF)(),s=a?.externalAccounts.find(e=>e.id===t),c=o.useRef(s?.provider),{providerToDisplayData:d}=(0,y.vO)();return c.current?(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:d[c.current]?.name}),messageLine2:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:d[c.current]?.name}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:r,onReset:n}):null},z=e=>{let{user:t}=(0,p.aF)(),{walletId:r,onSuccess:n,onReset:a}=e,s=t?.web3Wallets.find(e=>e.id===r),c=o.useRef(s?.web3Wallet),d=s?.verification?.status==="verified"?(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"):void 0;return c.current?(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:c.current}),messageLine2:d,successMessage:(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:c.current}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:n,onReset:a}):null},K=e=>{let{user:t}=(0,p.aF)(),{phoneId:r,onSuccess:n,onReset:a}=e,s=t?.phoneNumbers.find(e=>e.id===r),c=o.useRef(s?.phoneNumber);return c.current?(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:c.current}),messageLine2:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:c.current}),deleteResource:()=>Promise.resolve(s?.setReservedForSecondFactor({reserved:!1})),onSuccess:n,onReset:a}):null},R=e=>{let{onSuccess:t,onReset:r}=e,{user:o}=(0,p.aF)();return o?(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:o.disableTOTP,onSuccess:t,onReset:r}):null},_=e=>{let{onSuccess:t,onReset:r,passkey:o}=e;return(0,i.tZ)(g.LE,{title:(0,l.localizationKeys)("userProfile.passkeyScreen.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.passkeyScreen.removeResource.messageLine1",{name:o.name}),deleteResource:o.delete,onSuccess:t,onReset:r})},T=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(B,{onSuccess:t,onReset:t,...e})},I=["external_account_missing_refresh_token","oauth_fetch_user_error","oauth_token_exchange_error","external_account_email_address_verification_required"],w=(0,s.withCardStateProvider)(({shouldAllowCreation:e=!0})=>{let{user:t}=(0,p.aF)(),r=(0,s.useCardState)(),n=!!t?.externalAccounts?.length,[a,c]=(0,o.useState)(null);if(!t||!e&&!n)return null;let d=[...t.verifiedExternalAccounts,...t.unverifiedExternalAccounts.filter(e=>e.verification?.error)];return(0,i.BX)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.title"),centered:!1,id:"connectedAccounts",children:[(0,i.tZ)(s.Card.Alert,{children:r.error}),(0,i.BX)(v.a.Root,{value:a,onChange:c,children:[(0,i.tZ)(s.ProfileSection.ItemList,{id:"connectedAccounts",children:d.map(e=>(0,i.tZ)(F,{account:e},e.id))}),e&&(0,i.tZ)(S,{onClick:()=>c(null)})]})]})}),F=({account:e})=>{let{additionalOAuthScopes:t,componentName:r,mode:n}=(0,a.useUserProfileContext)(),{navigate:d}=(0,c.useRouter)(),{user:u}=(0,p.aF)(),m=(0,s.useCardState)(),h=e.id,P="modal"===n,b=P?(0,f.bX)({url:window.location.href,componentName:r}):window.location.href,S=(0,p.WZ)(()=>u?.createExternalAccount({strategy:e.verification.strategy,redirectUrl:b,additionalScopes:z}));if(!u)return null;let{providerToDisplayData:C}=(0,y.vO)(),x=e.username||e.emailAddress,B=e.verification?.error?.longMessage,z=function(e,t){if(!t)return[];let r=t[e.provider]||[],i=e.approvedScopes.split(" ");return 0===r.filter(e=>!i.includes(e)).length?[]:r}(e,t),K=z.length>0&&""!=e.approvedScopes,R=I.includes(e.verification?.error?.code||"")||K,_=R?(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__disconnected"):B,w=async()=>{let t=P?(0,f.bX)({url:window.location.href,componentName:r}):window.location.href;try{let r;(r=K?await e.reauthorize({additionalScopes:z,redirectUrl:t}):await S())&&await d(r.verification.externalVerificationRedirectURL?.href||"")}catch(e){(0,Z.S3)(e,[],m.setError)}};return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"connectedAccounts",children:[(0,i.BX)(l.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$2}),children:[(0,i.tZ)(()=>C[e.provider].iconUrl?(0,i.tZ)(l.Image,{elementDescriptor:[l.descriptors.providerIcon],elementId:l.descriptors.socialButtonsProviderIcon.setId(e.provider),alt:C[e.provider].name,src:C[e.provider].iconUrl,sx:e=>({width:e.sizes.$4,flexShrink:0})}):(0,i.tZ)(g.e_,{id:e.provider,value:C[e.provider].name}),{}),(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:1,center:!0,children:[(0,i.tZ)(l.Text,{sx:e=>({color:e.colors.$colorText}),children:`${C[e.provider].name}`}),(0,i.tZ)(l.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:x?`• ${x}`:""})]})})]}),(0,i.tZ)(k,{account:e})]}),R&&(0,i.BX)(l.Box,{sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:[(0,i.tZ)(l.Text,{colorScheme:"secondary",sx:e=>({paddingRight:e.sizes.$1x5,display:"inline-block"}),localizationKey:_}),(0,i.tZ)(l.Button,{sx:{display:"inline-block"},onClick:w,variant:"link",localizationKey:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed")})]}),e.verification?.error?.code&&!R&&(0,i.tZ)(l.Text,{colorScheme:"danger",sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:B}),(0,i.tZ)(v.a.Open,{value:`remove-${h}`,children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(T,{accountId:e.id})})})]},e.id)},k=({account:e})=>{let{open:t}=(0,P.XC)(),r=e.id,o=[{label:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),isDestructive:!0,onClick:()=>t(`remove-${r}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:o})},$=e=>t=>t.id===e?-1:1,A=e=>e.defaultSecondFactor?-1:1;function X(e){let t=[];return Object.entries(e).forEach(([,e])=>{e.used_for_second_factor&&t.push(...e.second_factors)}),t}function L(e,t){let r=X(e);return t.totpEnabled&&(r=r.filter(e=>"totp"!==e)),(t.backupCodeEnabled||!t.twoFactorEnabled)&&(r=r.filter(e=>"backup_code"!==e)),r}function D(e,t){if(!e)return[];let r=e.filter(e=>e.id===t),i=e.filter(e=>e.id!==t),o=i.filter(e=>e.verification?.status==="verified"),n=i.filter(e=>!!e.verification?.status&&e.verification?.status!=="verified"),a=i.filter(e=>!e.verification.status);return o.sort((e,t)=>e.id.localeCompare(t.id)),n.sort((e,t)=>e.verification?.expireAt&&t.verification?.expireAt?e.verification.expireAt.getTime()-t.verification.expireAt.getTime():0),[...r,...o,...n,...a]}var E=r(9140);let O=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(C,{onSuccess:t,onReset:t,...e})},N=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(E._,{onSuccess:t,onReset:t,...e})},W=({shouldAllowCreation:e=!0})=>{let{user:t}=(0,p.aF)();return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.title"),centered:!1,id:"emailAddresses",children:(0,i.tZ)(v.a.Root,{children:(0,i.BX)(s.ProfileSection.ItemList,{id:"emailAddresses",children:[D(t?.emailAddresses,t?.primaryEmailAddressId).map(e=>{let r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"emailAddresses",children:[(0,i.BX)(l.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$1}),children:[(0,i.tZ)(l.Text,{sx:e=>({color:e.colors.$colorText}),truncate:!0,children:e.emailAddress}),t?.primaryEmailAddressId===r&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__unverified")})]}),(0,i.tZ)(M,{email:e})]}),(0,i.tZ)(v.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(O,{emailId:r})})}),(0,i.tZ)(v.a.Open,{value:`verify-${r}`,children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(N,{emailId:r})})})]},e.emailAddress)}),e&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(v.a.Trigger,{value:"add",children:(0,i.tZ)(s.ProfileSection.ArrowButton,{id:"emailAddresses",localizationKey:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton")})}),(0,i.tZ)(v.a.Open,{value:"add",children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(N,{})})})]})]})})})},M=({email:e})=>{let t=(0,s.useCardState)(),{user:r}=(0,p.aF)(),{open:o}=(0,P.XC)(),n=e.id,a=r?.primaryEmailAddressId===n,c="verified"===e.verification.status,d=(0,p.WZ)(()=>r?.update({primaryEmailAddressId:n})),u=[a&&!c?{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>o(`verify-${n}`)}:null,!a&&c?{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>{d().catch(e=>(0,Z.S3)(e,[],t.setError))}}:null,a||c?null:{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>o(`verify-${n}`)},{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),isDestructive:!0,onClick:()=>o(`remove-${n}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:u})},U=()=>{let{user:e}=(0,p.aF)(),t=e?.enterpriseAccounts.filter(({enterpriseConnection:e})=>e?.active);return t?.length?(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",centered:!1,children:(0,i.tZ)(s.ProfileSection.ItemList,{id:"enterpriseAccounts",children:t.map(e=>(0,i.tZ)(H,{account:e},e.id))})}):null},H=({account:e})=>{let t=e.emailAddress,r=e?.enterpriseConnection?.name,o=e.verification?.error?.longMessage;return(0,i.BX)(s.ProfileSection.Item,{id:"enterpriseAccounts",sx:e=>({gap:e.space.$2,justifyContent:"start"}),children:[(0,i.tZ)(q,{account:e}),(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:1,center:!0,children:[(0,i.tZ)(l.Text,{truncate:!0,colorScheme:"body",children:r}),(0,i.tZ)(l.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:t?`• ${t}`:""}),o&&(0,i.tZ)(l.Badge,{colorScheme:"danger",localizationKey:(0,l.localizationKeys)("badge__requiresAction")})]})})]},e.id)},q=({account:e})=>{let{provider:t,enterpriseConnection:r}=e,o=t.replace(/(oauth_|saml_)/,"").trim(),n=r?.name??o,a={elementDescriptor:[l.descriptors.providerIcon],alt:n,sx:e=>({width:e.sizes.$4}),elementId:l.descriptors.enterpriseButtonsProviderIcon.setId(e.provider)};return r?.logoPublicUrl?(0,i.tZ)(l.Image,{...a,src:r.logoPublicUrl}):(0,i.tZ)(g.e_,{id:o,value:n,"aria-label":`${n}'s icon`,elementDescriptor:[l.descriptors.providerIcon,l.descriptors.providerInitialIcon],elementId:l.descriptors.providerInitialIcon.setId(o)})};var V=r(207);let Y=(0,s.withCardStateProvider)(e=>{let{phoneId:t,onSuccess:r,onReset:n}=e,{user:a}=(0,p.aF)(),s=o.useRef(a?.phoneNumbers.find(e=>e.id===t)),c=(0,g.a2)({defaultStep:+!!s.current});return(0,i.BX)(g.en,{...c.props,children:[(0,i.tZ)(j,{resourceRef:s,title:(0,l.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:c.nextStep,onReset:n}),(0,i.tZ)(G,{resourceRef:s,title:(0,l.localizationKeys)("userProfile.phoneNumberPage.verifyTitle"),onSuccess:r,onReset:n})]})}),j=e=>{let{title:t,onSuccess:r,onReset:o,onUseExistingNumberClick:n,resourceRef:a}=e,c=(0,s.useCardState)(),{user:d}=(0,p.aF)(),u=(0,p.WZ)((e,t)=>e.createPhoneNumber(t)),m=(0,Z.Yp)("phoneNumber","",{type:"tel",label:(0,l.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),h=m.value.length>1&&d?.username!==m.value,f=!!d?.phoneNumbers?.length&&n,g=async e=>{if(e.preventDefault(),d)return u(d,{phoneNumber:m.value}).then(e=>{a.current=e,r()}).catch(e=>(0,Z.S3)(e,[m],c.setError))};return(0,i.tZ)(s.FormContainer,{headerTitle:t,gap:1,children:(0,i.BX)(s.Form.Root,{gap:4,onSubmit:g,children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.phoneNumberPage.infoText"),colorScheme:"secondary"}),(0,i.tZ)(s.Form.ControlRow,{elementId:m.id,children:(0,i.tZ)(s.Form.PhoneInput,{...m.props,autoFocus:!0})}),(0,i.BX)(l.Flex,{justify:f?"between":"end",children:[f&&(0,i.tZ)(l.Button,{variant:"ghost",localizationKey:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.backButton"),onClick:n}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,l.localizationKeys)("userProfile.formButtonPrimary__add"),isDisabled:!h,onReset:o})]})]})})},G=e=>{let{title:t,onSuccess:r,resourceRef:o,onReset:n}=e;return(0,i.tZ)(s.FormContainer,{headerTitle:t,headerSubtitle:(0,l.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:o.current?.phoneNumber}),children:(0,i.tZ)(V.H,{nextStep:r,identification:o.current,identifier:o.current?.phoneNumber,prepareVerification:o.current?.prepareVerification,onReset:n})})},Q=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(x,{onSuccess:t,onReset:t,...e})},J=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(Y,{onSuccess:t,onReset:t,...e})},ee=({shouldAllowCreation:e=!0})=>{let{user:t}=(0,p.aF)(),r=!!t?.phoneNumbers?.length;return e||r?(0,i.tZ)(s.ProfileSection.Root,{centered:!1,title:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:(0,i.tZ)(v.a.Root,{children:(0,i.BX)(s.ProfileSection.ItemList,{id:"phoneNumbers",children:[D(t?.phoneNumbers,t?.primaryPhoneNumberId).map(e=>{let r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"phoneNumbers",children:[(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:2,center:!0,children:[(0,i.tZ)(l.Text,{sx:e=>({color:e.colors.$colorText}),children:(0,Z.L_)(e.phoneNumber)}),t?.primaryPhoneNumberId===r&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__unverified")})]})}),(0,i.tZ)(et,{phone:e})]}),(0,i.tZ)(v.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(Q,{phoneId:r})})}),(0,i.tZ)(v.a.Open,{value:`verify-${r}`,children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(J,{phoneId:r})})})]},r)}),e&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(v.a.Trigger,{value:"add",children:(0,i.tZ)(s.ProfileSection.ArrowButton,{id:"phoneNumbers",localizationKey:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton")})}),(0,i.tZ)(v.a.Open,{value:"add",children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(J,{})})})]})]})})}):null},et=({phone:e})=>{let t=(0,s.useCardState)(),{open:r}=(0,P.XC)(),{user:o}=(0,p.aF)(),n=e.id,a=(0,p.WZ)(t=>t.update({primaryPhoneNumberId:e.id}));if(!o)return null;let c=o.primaryPhoneNumberId===e.id,d="verified"===e.verification.status,u=[c&&!d?{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>r(`verify-${n}`)}:null,!c&&d?{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>a(o).catch(e=>(0,Z.S3)(e,[],t.setError))}:null,c||d?null:{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>r(`verify-${n}`)},{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),isDestructive:!0,onClick:()=>r(`remove-${n}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:u})};var er=r(1201);let ei=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:o}=(0,p.aF)(),n=(0,p.WZ)(e=>o?.update({username:e})),{userSettings:c}=(0,a.useEnvironment)(),d=(0,s.useCardState)(),u=(0,Z.Yp)("username",o?.username||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__username"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__username")});if(!o)return null;let m=c.attributes.username?.required,h=(!m||u.value.length>0)&&o.username!==u.value,f=async()=>{try{await n(u.value),t()}catch(e){(0,Z.S3)(e,[u],d.setError)}};return(0,i.tZ)(s.FormContainer,{headerTitle:o.username?(0,l.localizationKeys)("userProfile.usernamePage.title__update"):(0,l.localizationKeys)("userProfile.usernamePage.title__set"),children:(0,i.BX)(s.Form.Root,{onSubmit:f,children:[(0,i.tZ)(s.Form.ControlRow,{elementId:u.id,children:(0,i.tZ)(s.Form.PlainInput,{...u.props,autoFocus:!0,isRequired:m})}),(0,i.tZ)(s.FormButtons,{isDisabled:!h,onReset:r})]})})}),eo=()=>{let{close:e}=(0,P.XC)();return(0,i.tZ)(ei,{onSuccess:e,onReset:e})},en=()=>{let{user:e}=(0,p.aF)();return e?(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",sx:{alignItems:"center",[er.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(v.a.Root,{children:[(0,i.tZ)(v.a.Closed,{value:"edit",children:(0,i.BX)(s.ProfileSection.Item,{id:"username",sx:{paddingLeft:e.username?void 0:"0"},children:[e.username&&(0,i.tZ)(l.Text,{truncate:!0,sx:e=>({color:e.colors.$colorText}),children:e.username}),(0,i.tZ)(v.a.Trigger,{value:"edit",children:(0,i.tZ)(s.ProfileSection.Button,{id:"username",localizationKey:e.username?(0,l.localizationKeys)("userProfile.start.usernameSection.primaryButton__updateUsername"):(0,l.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})})]})}),(0,i.tZ)(v.a.Open,{value:"edit",children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(eo,{})})})]})}):null},ea=e=>{let{user:t,...r}=e;return(0,i.tZ)(s.AvatarUploader,{...r,title:(0,d.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,i.tZ)(s.UserAvatar,{size:e=>e.sizes.$12,...t})})},el=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,o=(0,s.useCardState)(),{user:n}=(0,p.aF)();if(!n)return null;let{first_name:c,last_name:d}=(0,a.useEnvironment)().userSettings.attributes,u=c?.enabled,m=d?.enabled,h=n.firstName||"",g=n.lastName||"",v=(0,Z.Yp)("firstName",n.firstName||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__firstName"),isRequired:d?.required}),P=(0,Z.Yp)("lastName",n.lastName||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__lastName"),isRequired:d?.required}),y=u&&v.value!==h||m&&P.value!==g,b=u&&c.required||m&&d.required,S=b&&!!P.value&&!!v.value&&y,C=n.enterpriseAccounts.some(e=>e.active),x=async e=>(e.preventDefault(),(y?n.update({firstName:v.value,lastName:P.value}):Promise.resolve()).then(t).catch(e=>{(0,Z.S3)(e,[v,P],o.setError)}));return(0,i.BX)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.profilePage.title"),children:[C&&(0,i.tZ)(s.InformationBox,{message:(0,l.localizationKeys)("userProfile.profilePage.readonly")}),(0,i.BX)(s.Form.Root,{onSubmit:x,sx:e=>({gap:e.space.$6}),children:[(0,i.tZ)(ea,{user:n,onAvatarChange:e=>n.setProfileImage({file:e}).then(()=>{o.setIdle()}).catch(e=>(0,Z.S3)(e,[],o.setError)),onAvatarRemove:(0,f.QO)(n.imageUrl)?null:()=>{n.setProfileImage({file:null}).then(()=>{o.setIdle()}).catch(e=>(0,Z.S3)(e,[],o.setError))}}),(u||m)&&(0,i.BX)(s.Form.ControlRow,{elementId:"name",children:[u&&(0,i.tZ)(s.Form.PlainInput,{...v.props,isDisabled:C,autoFocus:!0}),m&&(0,i.tZ)(s.Form.PlainInput,{...P.props,isDisabled:C,autoFocus:!u})]}),(0,i.tZ)(s.FormButtons,{isDisabled:b?!S:!y,onReset:r})]})]})}),es=()=>{let{close:e}=(0,P.XC)();return(0,i.tZ)(el,{onSuccess:e,onReset:e})},ec=()=>{let{user:e}=(0,p.aF)();if(!e)return null;let{username:t,primaryEmailAddress:r,primaryPhoneNumber:o,primaryWeb3Wallet:n,...a}=e;return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",sx:{[er.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(v.a.Root,{children:[(0,i.tZ)(v.a.Closed,{value:"edit",children:(0,i.BX)(s.ProfileSection.Item,{id:"profile",children:[(0,i.tZ)(s.UserPreview,{user:a,size:"lg",mainIdentifierVariant:"subtitle",sx:e=>({color:e.colors.$colorText})}),(0,i.tZ)(v.a.Trigger,{value:"edit",children:(0,i.tZ)(s.ProfileSection.Button,{id:"profile",localizationKey:(0,l.localizationKeys)("userProfile.start.profileSection.primaryButton")})})]})}),(0,i.tZ)(v.a.Open,{value:"edit",children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(es,{})})})]})})};var ed=r(4101);let eu=(0,s.withCardStateProvider)(({onClick:e})=>{let t=(0,s.useCardState)(),{user:r}=(0,p.aF)(),{strategies:o,strategyToDisplayData:n}=(0,y.vO)(),a=o.filter(e=>e.startsWith("web3")),c=r?.verifiedWeb3Wallets.map(e=>e.verification.strategy),d=a.filter(e=>!c.includes(e)),u=(0,p.WZ)(e=>r?.createWeb3Wallet({web3Wallet:e})),m=async e=>{let i=e.replace("web3_","").replace("_signature","");t.setError(void 0);try{t.setLoading(e);let o=await (0,ed.Ly)({provider:i});if(!r)throw Error("user is not defined");let n=await u(o);n=await n?.prepareVerification({strategy:e});let a=n?.verification.message,l=await (0,ed.bQ)({identifier:o,nonce:a,provider:i});await n?.attemptVerification({signature:l}),t.setIdle()}catch(r){t.setIdle();let e=(0,Z.zQ)(r);e?t.setError(e.longMessage):(0,Z.S3)(r,[],t.setError)}};return 0===d.length?null:(0,i.BX)(i.HY,{children:[(0,i.tZ)(s.ProfileSection.ActionMenu,{id:"web3Wallets",triggerLocalizationKey:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton"),onClick:e,children:d.map(e=>(0,i.tZ)(s.ProfileSection.ActionMenuItem,{id:n[e].id,onClick:()=>m(e),isLoading:t.loadingMetadata===e,isDisabled:t.isLoading,localizationKey:(0,l.localizationKeys)("userProfile.web3WalletPage.web3WalletButtonsBlockButton",{provider:n[e].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:(0,i.tZ)(l.Image,{elementDescriptor:l.descriptors.providerIcon,elementId:l.descriptors.providerIcon.setId(n[e].id),isLoading:t.loadingMetadata===e,isDisabled:t.isLoading,src:n[e].iconUrl,alt:`Connect ${n[e].name}`,sx:e=>({width:e.sizes.$5})})},e))}),t.error&&(0,i.tZ)(l.Text,{colorScheme:"danger",sx:e=>({padding:e.sizes.$1x5,paddingLeft:e.sizes.$8x5}),children:t.error})]})}),em=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(z,{onSuccess:t,onReset:t,...e})},eh=e=>e.length<=10?e:e.slice(0,6)+"..."+e.slice(-4),ep=(0,s.withCardStateProvider)(({shouldAllowCreation:e=!0})=>{let{user:t}=(0,p.aF)(),r=(0,s.useCardState)(),{strategyToDisplayData:n}=(0,y.vO)(),a=!!t?.web3Wallets?.length,[c,d]=(0,o.useState)(null);return e||a?(0,i.BX)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.title"),centered:!1,id:"web3Wallets",children:[(0,i.tZ)(s.Card.Alert,{children:r.error}),(0,i.BX)(v.a.Root,{value:c,onChange:d,children:[(0,i.tZ)(s.ProfileSection.ItemList,{id:"web3Wallets",children:D(t?.web3Wallets,t?.primaryWeb3WalletId).map(e=>{let r=e.verification.strategy,a=e.id;return n[r]&&(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"web3Wallets",align:"start",children:[(0,i.BX)(l.Flex,{sx:e=>({alignItems:"center",gap:e.space.$2,width:"100%"}),children:[n[r].iconUrl&&(0,i.tZ)(l.Image,{src:n[r].iconUrl,alt:n[r].name,sx:e=>({width:e.sizes.$4})}),(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:2,justify:"start",children:[(0,i.BX)(l.Text,{children:[n[r].name," (",eh(e.web3Wallet),")"]}),t?.primaryWeb3WalletId===a&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__unverified")})]})})]}),(0,i.tZ)(ef,{walletId:a})]},a),(0,i.tZ)(v.a.Open,{value:`remove-${a}`,children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(em,{walletId:e.id})})})]},e.id)})}),e&&(0,i.tZ)(eu,{onClick:()=>d(null)})]})]}):null}),ef=({walletId:e})=>{let t=(0,s.useCardState)(),{open:r}=(0,P.XC)(),{user:o}=(0,p.aF)(),n=o?.primaryWeb3WalletId===e,a=(0,p.WZ)(()=>o?.update({primaryWeb3WalletId:e})),c=[n?null:{label:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.detailsAction__nonPrimary"),onClick:()=>{a().catch(e=>(0,Z.S3)(e,[],t.setError))}},{label:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),isDestructive:!0,onClick:()=>r(`remove-${e}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:c})},eg=(0,s.withCardStateProvider)(()=>{let{attributes:e,social:t,enterpriseSSO:r}=(0,a.useEnvironment)().userSettings,o=(0,s.useCardState)(),{user:n}=(0,p.aF)(),c=e.username?.enabled,d=e.email_address?.enabled,u=e.phone_number?.enabled,m=t&&Object.values(t).filter(e=>e.enabled).length>0,h=n&&r.enabled,f=e.web3_wallet?.enabled,g=!h||!n.enterpriseAccounts.some(e=>e.active&&e.enterpriseConnection?.disableAdditionalIdentifications);return(0,i.tZ)(l.Col,{elementDescriptor:l.descriptors.page,sx:e=>({gap:e.space.$8,color:e.colors.$colorText}),children:(0,i.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("account"),children:[(0,i.tZ)(s.Header.Root,{children:(0,i.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("userProfile.start.headerTitle__account"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,i.tZ)(s.Card.Alert,{children:o.error}),(0,i.tZ)(ec,{}),c&&(0,i.tZ)(en,{}),d&&(0,i.tZ)(W,{shouldAllowCreation:g}),u&&(0,i.tZ)(ee,{shouldAllowCreation:g}),m&&(0,i.tZ)(w,{shouldAllowCreation:g}),h&&(0,i.tZ)(U,{}),f&&(0,i.tZ)(ep,{shouldAllowCreation:g})]})})});var ev=r(5006);let eP=()=>{let{navigate:e}=(0,c.useRouter)();return(0,i.BX)(i.HY,{children:[(0,i.tZ)(s.Header.Root,{sx:e=>({borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,marginBlockEnd:e.space.$4,paddingBlockEnd:e.space.$4}),children:(0,i.tZ)(s.Header.BackLink,{onClick:()=>void e("../",{searchParams:new URLSearchParams("tab=plans")}),children:(0,i.tZ)(s.Header.Title,{localizationKey:"Available Plans",textVariant:"h2"})})}),(0,i.tZ)(a.__experimental_PricingTableContext.Provider,{value:{componentName:"PricingTable",mode:"modal"},children:(0,i.tZ)(ev.C,{})})]})},ey=()=>(0,i.tZ)(a.SubscriberTypeContext.Provider,{value:"user",children:(0,i.tZ)(a.PlansContextProvider,{children:(0,i.tZ)(eP,{})})});var eZ=r(6258);let eb=()=>{let{user:e}=(0,p.aF)(),{session:t}=(0,p.kP)(),{data:r,isLoading:o}=(0,y.ib)(e?.getSessions,"user-sessions");return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.activeDevicesSection.title"),centered:!1,id:"activeDevices",children:(0,i.tZ)(s.ProfileSection.ItemList,{id:"activeDevices",disableAnimation:!0,children:o?(0,i.tZ)(s.FullHeightLoader,{}):r?.sort($(t.id)).map(e=>eS(e.status)?i.tZ(eC,{session:e},e.id):null)})})},eS=e=>["active","pending"].includes(e),eC=({session:e})=>{let t=p.kP().session?.id===e.id,r=(0,y._m)(),o=(0,p.WZ)(e.revoke.bind(e)),n=async()=>{if(!t&&e)return r.setLoading(),o().catch(e=>(0,Z.S3)(e,[],r.setError)).finally(()=>r.setIdle())};return(0,i.tZ)(s.ProfileSection.Item,{id:"activeDevices",elementDescriptor:l.descriptors.activeDeviceListItem,elementId:t?l.descriptors.activeDeviceListItem.setId("current"):void 0,sx:{alignItems:"flex-start",opacity:r.isLoading?.5:1},isDisabled:r.isLoading,children:(0,i.BX)(i.HY,{children:[(0,i.tZ)(ex,{session:e}),!t&&(0,i.tZ)(eB,{revoke:n})]})})},ex=e=>{let{session:t}=(0,p.kP)(),r=t?.id===e.session.id,o=!!t?.actor,n=!!e.session.actor,{city:a,country:s,browserName:c,browserVersion:d,deviceType:u,ipAddress:m,isMobile:h}=e.session.latestActivity,f=`${c||""} ${d||""}`.trim()||"Web browser",g=[a||"",s||""].filter(Boolean).join(", ").trim()||null,{t:v}=(0,l.useLocalizations)();return(0,i.BX)(l.Flex,{elementDescriptor:l.descriptors.activeDevice,elementId:r?l.descriptors.activeDevice.setId("current"):void 0,sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[er.mqu.sm]:{gap:e.space.$2}}),children:[(0,i.tZ)(l.Flex,{sx:e=>({[er.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,i.tZ)(l.Icon,{elementDescriptor:l.descriptors.activeDeviceIcon,elementId:l.descriptors.activeDeviceIcon.setId(h?"mobile":"desktop"),icon:h?eZ.Fh:eZ.eu,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$8,height:e.space.$8})})}),(0,i.BX)(l.Col,{align:"start",gap:1,children:[(0,i.BX)(l.Flex,{center:!0,gap:2,children:[(0,i.tZ)(l.Text,{children:u||(h?"Mobile device":"Desktop device")}),r&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__thisDevice"),colorScheme:o?"danger":"primary"}),o&&!n&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__userDevice")}),!r&&n&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,i.tZ)(l.Text,{colorScheme:"secondary",children:f}),(0,i.BX)(l.Text,{colorScheme:"secondary",children:[m," (",g,")"]}),(0,i.tZ)(l.Text,{colorScheme:"secondary",children:v((0,Z.Qg)(e.session.lastActiveAt))})]})]})},eB=({revoke:e})=>{let t=[{label:(0,l.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),isDestructive:!0,onClick:e}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:t})};var ez=r(4264);let eK=(0,s.withCardStateProvider)(e=>{let{onReset:t}=e,r=(0,s.useCardState)(),{afterSignOutUrl:o,afterMultiSessionSingleSignOutUrl:n}=(0,a.useSignOutContext)(),{user:c}=(0,p.aF)(),{t:d}=(0,l.useLocalizations)(),{otherSessions:u}=(0,ez.j)({user:c}),{setActive:m}=(0,p.cL)(),h=(0,p.WZ)(()=>c?.delete()),f=(0,Z.Yp)("deleteConfirmation","",{type:"text",label:(0,l.localizationKeys)("userProfile.deletePage.actionDescription"),isRequired:!0,placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount")}),g=f.value===(d((0,l.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount"))||"Delete account"),v=async()=>{if(g)try{await h();let e=0===u.length?o:n;return await m({session:null,redirectUrl:e})}catch(e){(0,Z.S3)(e,[],r.setError)}};return(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.deletePage.title"),sx:e=>({gap:e.space.$0x5}),children:(0,i.BX)(s.Form.Root,{onSubmit:v,children:[(0,i.BX)(l.Col,{gap:1,children:[(0,i.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,i.tZ)(l.Text,{colorScheme:"danger",localizationKey:(0,l.localizationKeys)("userProfile.deletePage.messageLine2")})]}),(0,i.tZ)(s.Form.ControlRow,{elementId:f.id,children:(0,i.tZ)(s.Form.PlainInput,{...f.props,ignorePasswordManager:!0})}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,l.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!g,onReset:t})]})})}),eR=()=>{let{close:e}=(0,P.XC)();return(0,i.tZ)(eK,{onSuccess:e,onReset:e})},e_=()=>(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",sx:{alignItems:"center",[er.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(v.a.Root,{children:[(0,i.tZ)(v.a.Closed,{value:"delete",children:(0,i.tZ)(s.ProfileSection.Item,{id:"danger",sx:e=>({paddingLeft:e.space.$1}),children:(0,i.tZ)(v.a.Trigger,{value:"delete",children:(0,i.tZ)(s.ProfileSection.Button,{id:"danger",variant:"ghost",colorScheme:"danger",localizationKey:(0,l.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})})})}),(0,i.tZ)(v.a.Open,{value:"delete",children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(eR,{})})})]})});var eT=r(3531),eI=r(5878);let ew=e=>{let{code:t}=e;return(0,i.tZ)(l.Flex,{center:!0,sx:e=>({padding:`${e.space.$1} ${e.space.$4}`}),children:(0,i.tZ)(l.Text,{children:t})})},eF=e=>{let{subtitle:t,backupCodes:r}=e,{applicationName:o}=(0,a.useEnvironment)().displayConfig,{user:n}=(0,p.aF)(),{print:s,printableProps:c}=(0,g.Qz)(),{onCopy:d,hasCopied:u}=(0,y.VP)(r?.join(",")||"");if(!n)return null;let m=(0,eI.xC)(n);return r?(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Col,{gap:1,children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"subtitle"}),(0,i.tZ)(l.Text,{localizationKey:t,variant:"caption",colorScheme:"secondary"})]}),(0,i.BX)(l.Box,{sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg}),children:[(0,i.tZ)(l.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(2, minmax(${e.sizes.$12}, 1fr))`,padding:`${e.space.$4} ${e.space.$6}`}),children:r.map((e,t)=>(0,i.tZ)(ew,{code:e},t))}),(0,i.BX)(l.Grid,{sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,gridTemplateColumns:"repeat(3, minmax(0, 1fr))",">:not([hidden])~:not([hidden])":{borderRightWidth:"0px",borderLeftWidth:"1px",borderStyle:"solid",borderColor:e.colors.$neutralAlpha100},">:first-child":{borderBottomLeftRadius:e.radii.$lg},">:last-child":{borderBottomRightRadius:e.radii.$lg}}),children:[(0,i.tZ)(l.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:()=>{let e=document.createElement("a"),t=new Blob([function(e,t,r){let i=e?.join("\n");return`These are your backup codes for ${t} account ${r}.
Store them securely and keep them secret. Each code can only be used once.

${i}`}(r,o,m)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=`${o}_backup_codes.txt`,document.body.appendChild(e),e.click()},children:(0,i.tZ)(l.Icon,{icon:eZ.UW})}),(0,i.tZ)(l.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:s,children:(0,i.tZ)(l.Icon,{icon:eZ.Kh})}),(0,i.tZ)(l.Button,{variant:"ghost",onClick:d,sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),children:(0,i.tZ)(l.Icon,{icon:u?eZ.Jr:eZ.CK})})]})]}),(0,i.BX)(g.o4,{...c,children:[(0,i.BX)(l.Heading,{children:["Your backup codes for ",o," account ",m,":"]}),(0,i.tZ)(l.Col,{gap:2,children:r.map((e,t)=>(0,i.tZ)(ew,{code:e},t))})]})]}):null},ek=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:n}=(0,p.aF)(),a=(0,s.useCardState)(),c=(0,p.WZ)(()=>n?.createBackupCode()),[d,u]=o.useState(void 0);return(o.useEffect(()=>{!d&&n&&c().then(e=>u(e)).catch(e=>{if((0,eT.mh)(e))return r();(0,Z.S3)(e,[],a.setError)})},[]),a.error)?(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.backupCodePage.title")}):(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.backupCodePage.title"),children:d?(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.successMessage")}),(0,i.tZ)(eF,{subtitle:(0,l.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:d.codes}),(0,i.tZ)(s.FormButtonContainer,{children:(0,i.tZ)(l.Button,{autoFocus:!0,onClick:t,localizationKey:(0,l.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:l.descriptors.formButtonPrimary})})]}):(0,i.tZ)(s.FullHeightLoader,{})})}),e$=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,o=(0,g.a2)();return(0,i.BX)(g.en,{...o.props,children:[(0,i.tZ)(eA,{onContinue:o.nextStep}),(0,i.tZ)(ek,{onSuccess:t,onReset:r})]})}),eA=e=>{let{onContinue:t}=e,{close:r}=(0,P.XC)();return(0,i.BX)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.backupCodePage.title"),children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,i.BX)(s.FormButtonContainer,{sx:{marginTop:0},children:[(0,i.tZ)(l.Button,{textVariant:"buttonSmall",onClick:t,localizationKey:(0,l.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:l.descriptors.formButtonPrimary}),(0,i.tZ)(l.Button,{variant:"ghost",onClick:r,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset})]})]})},eX=(0,s.withCardStateProvider)(e=>{let{onReset:t,onSuccess:r}=e,n=o.useRef(),c=(0,g.a2)({defaultStep:2}),d=a.useEnvironment().userSettings.attributes.backup_code?.enabled;return(0,i.BX)(g.en,{...c.props,children:[(0,i.tZ)(j,{title:(0,l.localizationKeys)("userProfile.phoneNumberPage.title"),resourceRef:n,onSuccess:c.nextStep,onUseExistingNumberClick:()=>c.goToStep(2),onReset:t}),(0,i.tZ)(eD,{title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:n,onSuccess:()=>d?c.goToStep(3):r(),onReset:()=>c.goToStep(2)}),(0,i.tZ)(eE,{onSuccess:d?c.nextStep:r,onReset:t,onAddPhoneClick:()=>c.goToStep(0),onUnverifiedPhoneClick:e=>{n.current=e,c.goToStep(1)},title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:n}),d&&(0,i.tZ)(s.SuccessPage,{title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successTitle"),text:n.current?.backupCodes&&n.current?.backupCodes.length>0?[(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1"),(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage2")]:[(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1")],onFinish:t,contents:(0,i.tZ)(eF,{backupCodes:n.current?.backupCodes})})]})}),eL=e=>{let{phone:t,onSuccess:r,onUnverifiedPhoneClick:o,resourceRef:n}=e,a=(0,s.useCardState)(),c=(0,p.WZ)(()=>t.setReservedForSecondFactor({reserved:!0})),{country:d}=(0,Z.Z_)(t.phoneNumber),u=(0,Z.L_)(t.phoneNumber),m=async()=>{if("verified"!==t.verification.status)return o(t);a.setLoading(t.id);try{await c(),n.current=t,r()}catch(e){(0,Z.S3)(e,[],a.setError)}finally{a.setIdle()}};return(0,i.BX)(l.Button,{variant:"outline",colorScheme:"neutral",sx:{justifyContent:"start"},onClick:m,isLoading:a.loadingMetadata===t.id,isDisabled:a.isLoading,children:[d.iso.toUpperCase()," ",u]},t.id)},eD=e=>{let{title:t,onSuccess:r,resourceRef:o,onReset:n}=e,a=(0,s.useCardState)(),c=o.current,d=(0,p.WZ)(()=>c?.setReservedForSecondFactor({reserved:!0})),u=async()=>{a.setLoading(c?.id);try{await d(),o.current=c,r()}catch(e){(0,Z.S3)(e,[],a.setError)}finally{a.setIdle()}};return(0,i.tZ)(s.FormContainer,{headerTitle:t,headerSubtitle:(0,l.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:o.current?.phoneNumber}),children:(0,i.tZ)(V.H,{nextStep:()=>{u()},identification:o.current,identifier:o.current?.phoneNumber,prepareVerification:o.current?.prepareVerification,onReset:n})})},eE=e=>{let{onSuccess:t,onReset:r,title:o,onAddPhoneClick:n,onUnverifiedPhoneClick:a,resourceRef:c}=e,{user:d}=(0,p.aF)();if(!d)return null;let u=d.phoneNumbers.filter(e=>!e.reservedForSecondFactor);return(0,i.BX)(s.FormContainer,{headerTitle:o,gap:1,children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)(u.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers"),colorScheme:"secondary"}),u.length>0&&(0,i.tZ)(l.Col,{gap:2,children:u.map(e=>(0,i.tZ)(eL,{onSuccess:t,phone:e,onUnverifiedPhoneClick:a,resourceRef:c},e.id))}),(0,i.BX)(s.FormButtonContainer,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[(0,i.tZ)(s.IconButton,{variant:"ghost","aria-label":"Add phone number",icon:(0,i.tZ)(l.Icon,{icon:eZ.v3,sx:e=>({marginRight:e.space.$2})}),localizationKey:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber"),onClick:n}),(0,i.tZ)(l.Button,{variant:"ghost",localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),onClick:r})]})]})},eO=(0,s.withCardStateProvider)(e=>{let{title:t,onSuccess:r,onReset:n}=e,{user:a}=(0,p.aF)(),c=(0,s.useCardState)(),d=(0,p.WZ)(()=>a?.createTOTP()),{close:u}=(0,P.XC)(),[m,h]=o.useState(void 0),[f,v]=o.useState("qr");return(o.useEffect(()=>{a&&d().then(e=>h(e)).catch(e=>(0,eT.uX)(e)&&"reverification_cancelled"===e.code?u():(0,Z.S3)(e,[],c.setError))},[]),c.error)?(0,i.tZ)(s.FormContainer,{headerTitle:t}):(0,i.BX)(s.FormContainer,{headerTitle:t,headerSubtitle:"qr"==f?(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan"):(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan"),children:[!m&&(0,i.tZ)(s.FullHeightLoader,{}),m&&(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Col,{gap:4,children:["qr"==f&&(0,i.tZ)(g.s_,{justify:"center",url:m.uri||""}),"uri"==f&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,i.tZ)(s.ClipboardInput,{value:m.secret}),(0,i.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,i.tZ)(s.ClipboardInput,{value:m.uri})]})]}),(0,i.BX)(l.Flex,{justify:"between",align:"center",sx:{width:"100%"},children:["qr"==f&&(0,i.tZ)(l.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>v("uri"),localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")}),"uri"==f&&(0,i.tZ)(l.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>v("qr"),localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")}),(0,i.BX)(s.FormButtonContainer,{children:[(0,i.tZ)(l.Button,{onClick:r,localizationKey:(0,l.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:l.descriptors.formButtonPrimary}),(0,i.tZ)(l.Button,{variant:"ghost",onClick:n,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset})]})]})]})]})}),eN=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,resourceRef:o}=e,{user:n}=(0,p.aF)(),a=(0,s.useFieldOTP)({onCodeEntryFinished:(e,t,r)=>{n?.verifyTOTP({code:e}).then(e=>t(e)).catch(r)},onResolve:e=>{o.current=e,t()}});return(0,i.BX)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.mfaTOTPPage.title"),children:[(0,i.tZ)(l.Col,{children:(0,i.tZ)(s.Form.OTPInput,{...a,label:(0,l.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),description:(0,l.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle")})}),(0,i.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,i.tZ)(l.Button,{onClick:r,variant:"ghost",isDisabled:a.isLoading,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset})})]})}),eW=(0,s.withCardStateProvider)(e=>{let{onReset:t}=e,r=(0,g.a2)(),n=o.useRef();return(0,i.BX)(g.en,{...r.props,children:[(0,i.tZ)(eO,{title:(0,l.localizationKeys)("userProfile.mfaTOTPPage.title"),onSuccess:r.nextStep,onReset:t}),(0,i.tZ)(eN,{onSuccess:r.nextStep,onReset:t,resourceRef:n}),(0,i.tZ)(s.SuccessPage,{title:(0,l.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,l.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),onFinish:t,contents:(0,i.tZ)(eF,{subtitle:(0,l.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:n.current?.backupCodes})})]})}),eM=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,selectedStrategy:n}=e,c=(0,s.useCardState)(),{userSettings:{attributes:d}}=(0,a.useEnvironment)(),{user:u}=(0,p.aF)();if(!u)return null;let m=(0,l.localizationKeys)("userProfile.mfaPage.title"),h=o.useMemo(()=>L(d,u),[]);return(o.useEffect(()=>{0===h.length&&c.setError("There are no second factors available to add")},[]),c.error)?(0,i.tZ)(s.FormContainer,{headerTitle:m}):0!==h.length||n?(0,i.tZ)(eU,{onSuccess:t,onReset:r,method:n||h[0]}):null}),eU=e=>{let{method:t,onSuccess:r,onReset:o}=e;switch(t){case"phone_code":return(0,i.tZ)(eX,{onSuccess:r,onReset:o});case"totp":return(0,i.tZ)(eW,{onSuccess:r,onReset:o});case"backup_code":return(0,i.tZ)(e$,{onSuccess:r,onReset:o});default:return null}},eH=()=>{let{close:e}=(0,P.XC)();return(0,i.tZ)(R,{onSuccess:e,onReset:e})},eq=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(K,{onSuccess:t,onReset:t,...e})},eV=()=>{let{close:e}=(0,P.XC)();return(0,i.tZ)(ek,{onSuccess:e,onReset:e})},eY=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(eM,{onSuccess:t,onReset:t,selectedStrategy:e.selectedStrategy})},ej=()=>{let{userSettings:{attributes:e}}=(0,a.useEnvironment)(),{user:t}=(0,p.aF)(),[r,n]=(0,o.useState)(null);if(!t)return null;let c=X(e),d=L(e,t),u=c.includes("totp")&&t.totpEnabled,m=c.includes("backup_code")&&t.backupCodeEnabled,h=t.phoneNumbers.filter(e=>"verified"===e.verification.status).filter(e=>e.reservedForSecondFactor).sort(A);return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.mfaSection.title"),centered:!1,id:"mfa",children:(0,i.tZ)(v.a.Root,{value:r,onChange:n,children:(0,i.BX)(s.ProfileSection.ItemList,{id:"mfa",children:[u&&(0,i.BX)(i.HY,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(l.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(l.Icon,{icon:eZ.hc,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")}),(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__default")})]}),(0,i.tZ)(eJ,{})]}),(0,i.tZ)(v.a.Open,{value:"remove-totp",children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(eH,{})})})]}),c.includes("phone_code")&&h.map(e=>{let t=!u&&e.defaultSecondFactor,r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(l.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(l.Icon,{icon:eZ.ij,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.BX)(l.Text,{children:["SMS Code ",(0,i.tZ)(s.FormattedPhoneNumberText,{value:e.phoneNumber})]}),t&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__default")})]}),(0,i.tZ)(eG,{phone:e,showTOTP:u})]}),(0,i.tZ)(v.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(eq,{phoneId:r})})})]},r)}),m&&(0,i.BX)(i.HY,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(l.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(l.Icon,{icon:eZ.Qi,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")})]}),(0,i.tZ)(eQ,{})]}),(0,i.tZ)(v.a.Open,{value:"regenerate",children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(eV,{})})})]}),(0,i.tZ)(e0,{secondFactorsAvailableToAdd:d,onClick:()=>n(null)})]})})})},eG=({phone:e,showTOTP:t})=>{let{open:r}=(0,P.XC)(),o=(0,s.useCardState)(),n=e.id,a=[t?null:{label:(0,l.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>e.makeDefaultSecondFactor().catch(e=>(0,Z.S3)(e,[],o.setError)),isDisabled:e.defaultSecondFactor},{label:(0,l.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),isDestructive:!0,onClick:()=>r(`remove-${n}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:a})},eQ=()=>{let{open:e}=(0,P.XC)(),t=[{label:(0,l.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("regenerate")}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:t})},eJ=()=>{let{open:e}=(0,P.XC)(),t=[{label:(0,l.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),isDestructive:!0,onClick:()=>e("remove-totp")}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:t})},e0=e=>{let{open:t}=(0,P.XC)(),{secondFactorsAvailableToAdd:r,onClick:n}=e,[a,c]=(0,o.useState)(),d=o.useMemo(()=>r.map(e=>"phone_code"===e?{icon:eZ.ij,text:"SMS code",key:"phone_code"}:"totp"===e?{icon:eZ.hc,text:"Authenticator application",key:"totp"}:"backup_code"===e?{icon:eZ.Qi,text:"Backup code",key:"backup_code"}:null).filter(e=>null!==e),[r]);return(0,i.BX)(i.HY,{children:[r.length>0&&(0,i.tZ)(v.a.Closed,{value:"multi-factor",children:(0,i.tZ)(s.ProfileSection.ActionMenu,{id:"mfa",triggerLocalizationKey:(0,l.localizationKeys)("userProfile.start.mfaSection.primaryButton"),onClick:n,children:d.map(e=>e&&(0,i.tZ)(s.ProfileSection.ActionMenuItem,{id:e.key,localizationKey:e.text,leftIcon:e.icon,onClick:()=>{c(e.key),t("multi-factor")}},e.key))})}),(0,i.tZ)(v.a.Open,{value:"multi-factor",children:(0,i.tZ)(v.a.Card,{children:a&&(0,i.tZ)(eY,{selectedStrategy:a})})})]})},e1=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(_,{onSuccess:t,onReset:t,...e})},e3=e=>{let{close:t}=(0,P.XC)();return(0,i.tZ)(e2,{onSuccess:t,onReset:t,passkey:e.passkey})},e2=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,passkey:o}=e,n=(0,s.useCardState)(),a=(0,Z.Yp)("passkeyName",o.name||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__passkeyName"),isRequired:!0}),c=a.value.length>1&&o.name!==a.value,d=async e=>(e.preventDefault(),o.update({name:a.value}).then(t).catch(e=>(0,Z.S3)(e,[a],n.setError)));return(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.passkeyScreen.title__rename"),headerSubtitle:(0,l.localizationKeys)("userProfile.passkeyScreen.subtitle__rename"),children:(0,i.BX)(s.Form.Root,{onSubmit:d,children:[(0,i.tZ)(s.Form.ControlRow,{elementId:a.id,children:(0,i.tZ)(s.Form.PlainInput,{...a.props,autoComplete:"off"})}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,l.localizationKeys)("userProfile.formButtonPrimary__save"),isDisabled:!c,onReset:r})]})})}),e4=()=>{let{user:e}=(0,p.aF)(),[t,r]=(0,o.useState)(null);return e?(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.passkeysSection.title"),centered:!1,id:"passkeys",children:(0,i.tZ)(v.a.Root,{value:t,onChange:r,children:(0,i.BX)(s.ProfileSection.ItemList,{id:"passkeys",children:[e.passkeys.map(e=>{let t=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.tZ)(e6,{...e},t),(0,i.tZ)(v.a.Open,{value:`remove-${t}`,children:(0,i.tZ)(v.a.Card,{variant:"destructive",children:(0,i.tZ)(e1,{passkey:e})})}),(0,i.tZ)(v.a.Open,{value:`rename-${t}`,children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(e3,{passkey:e})})})]},t)}),(0,i.tZ)(e8,{onClick:()=>r(null)})]})})}):null},e6=e=>(0,i.BX)(s.ProfileSection.Item,{id:"passkeys",hoverable:!0,sx:{alignItems:"flex-start"},children:[(0,i.tZ)(e5,{...e}),(0,i.tZ)(e7,{passkey:e})]}),e5=e=>{let{name:t,createdAt:r,lastUsedAt:o}=e,{t:n}=(0,l.useLocalizations)();return(0,i.tZ)(l.Flex,{sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[er.mqu.sm]:{gap:e.space.$2}}),children:(0,i.BX)(l.Col,{align:"start",gap:1,children:[(0,i.tZ)(l.Text,{children:t}),(0,i.BX)(l.Text,{colorScheme:"secondary",children:["Created: ",n((0,Z.Qg)(r))]}),o&&(0,i.BX)(l.Text,{colorScheme:"secondary",children:["Last used: ",n((0,Z.Qg)(o))]})]})})},e7=({passkey:e})=>{let{open:t}=(0,P.XC)(),r=e.id,o=[{label:(0,l.localizationKeys)("userProfile.start.passkeysSection.menuAction__rename"),onClick:()=>t(`rename-${r}`)},{label:(0,l.localizationKeys)("userProfile.start.passkeysSection.menuAction__destructive"),isDestructive:!0,onClick:()=>t(`remove-${r}`)}];return(0,i.tZ)(s.ThreeDotsMenu,{actions:o})},e8=({onClick:e})=>{let t=(0,s.useCardState)(),{isSatellite:r}=(0,p.cL)(),{user:o}=(0,p.aF)(),n=(0,p.WZ)(()=>o?.createPasskey()),a=async()=>{if(e?.(),o)try{await n()}catch(e){(0,Z.S3)(e,[],t.setError)}};return r?null:(0,i.tZ)(s.ProfileSection.ArrowButton,{id:"passkeys",localizationKey:(0,l.localizationKeys)("userProfile.start.passkeysSection.primaryButton"),onClick:a})},e9=(e,t)=>{let r=[];return e?r.push((0,l.localizationKeys)("userProfile.passwordPage.successMessage__update")):r.push((0,l.localizationKeys)("userProfile.passwordPage.successMessage__set")),t&&r.push((0,l.localizationKeys)("userProfile.passwordPage.successMessage__signOutOfOtherSessions")),r},te=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:n}=(0,p.aF)(),c=(0,p.WZ)((e,t)=>e.updatePassword(...t));if(!n)return null;let{userSettings:{passwordSettings:d},authConfig:{reverification:u}}=(0,a.useEnvironment)(),{session:m}=(0,p.kP)(),h=n.passwordEnabled?(0,l.localizationKeys)("userProfile.passwordPage.title__update"):(0,l.localizationKeys)("userProfile.passwordPage.title__set"),f=(0,s.useCardState)(),g=n.enterpriseAccounts.some(e=>e.active),v=n.passwordEnabled&&!u,P=(0,o.useRef)({title:(0,l.localizationKeys)("userProfile.passwordPage.title__set")}),b=(0,Z.Yp)("currentPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),S=(0,Z.Yp)("newPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,Z.GM)(e,{t:K,locale:R,passwordSettings:d})}),C=(0,Z.Yp)("confirmPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),x=(0,Z.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,l.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:B,isPasswordMatch:z}=(0,y.p5)({passwordField:S,confirmPasswordField:C}),{t:K,locale:R}=(0,l.useLocalizations)(),_=(v?b.value&&z:z)&&S.value&&C.value,T=async()=>{try{P.current={title:n.passwordEnabled?(0,l.localizationKeys)("userProfile.passwordPage.title__update"):(0,l.localizationKeys)("userProfile.passwordPage.title__set"),text:e9(n.passwordEnabled,!!x.checked)};let e={newPassword:S.value,signOutOfOtherSessions:x.checked,currentPassword:v?b.value:void 0};await c(n,[e]),t()}catch(e){(0,Z.S3)(e,[b,S,C],f.setError)}};return(0,i.BX)(s.FormContainer,{headerTitle:h,children:[g&&(0,i.tZ)(s.InformationBox,{message:(0,l.localizationKeys)("userProfile.passwordPage.readonly")}),(0,i.BX)(s.Form.Root,{onSubmit:T,onBlur:()=>{S.value&&B(C.value)},children:[(0,i.tZ)("input",{readOnly:!0,"data-testid":"hidden-identifier",id:"identifier-field",name:"identifier",value:m?.publicUserData.identifier||"",style:{display:"none"}}),v&&(0,i.tZ)(s.Form.ControlRow,{elementId:b.id,children:(0,i.tZ)(s.Form.PasswordInput,{...b.props,minLength:6,isRequired:!0,autoFocus:!0,isDisabled:g})}),(0,i.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,i.tZ)(s.Form.PasswordInput,{...S.props,minLength:6,isRequired:!0,autoFocus:!n.passwordEnabled,isDisabled:g})}),(0,i.tZ)(s.Form.ControlRow,{elementId:C.id,children:(0,i.tZ)(s.Form.PasswordInput,{...C.props,onChange:e=>(e.target.value&&B(e.target.value),C.props.onChange(e)),isRequired:!0,isDisabled:g})}),(0,i.tZ)(s.Form.ControlRow,{elementId:x.id,children:(0,i.tZ)(s.Form.Checkbox,{...x.props,description:(0,l.localizationKeys)("userProfile.passwordPage.checkboxInfoText__signOutOfOtherSessions"),isDisabled:g})}),g?(0,i.tZ)(s.FormButtonContainer,{children:(0,i.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:r})}):(0,i.tZ)(s.FormButtons,{isDisabled:!_,onReset:r})]})]})}),tt=()=>{let{close:e}=(0,P.XC)();return(0,i.tZ)(te,{onSuccess:e,onReset:e})},tr=()=>{let{user:e}=(0,p.aF)();if(!e)return null;let{passwordEnabled:t}=e;return(0,i.tZ)(s.ProfileSection.Root,{centered:!1,title:(0,l.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:(0,i.BX)(v.a.Root,{children:[(0,i.tZ)(v.a.Closed,{value:"edit",children:(0,i.BX)(s.ProfileSection.Item,{id:"password",sx:e=>({paddingLeft:t?void 0:"0",paddingTop:e.space.$0x25,paddingBottom:e.space.$0x25}),children:[t&&(0,i.tZ)(l.Text,{variant:"h2",children:"••••••••••"}),(0,i.tZ)(v.a.Trigger,{value:"edit",children:(0,i.tZ)(s.ProfileSection.Button,{id:"password",localizationKey:t?(0,l.localizationKeys)("userProfile.start.passwordSection.primaryButton__updatePassword"):(0,l.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})})]})}),(0,i.tZ)(v.a.Open,{value:"edit",children:(0,i.tZ)(v.a.Card,{children:(0,i.tZ)(tt,{})})})]})})},ti=(0,s.withCardStateProvider)(()=>{let{attributes:e,instanceIsPasswordBased:t}=(0,a.useEnvironment)().userSettings,r=(0,s.useCardState)(),{user:o}=(0,p.aF)(),n=e.passkey?.enabled,c=X(e).length>0,d=o?.deleteSelfEnabled;return(0,i.tZ)(l.Col,{elementDescriptor:l.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,i.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("security"),children:[(0,i.tZ)(s.Header.Root,{children:(0,i.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("userProfile.start.headerTitle__security"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,i.tZ)(s.Card.Alert,{children:r.error}),t&&(0,i.tZ)(tr,{}),n&&(0,i.tZ)(e4,{}),c&&(0,i.tZ)(ej,{}),(0,i.tZ)(eb,{}),d&&(0,i.tZ)(e_,{})]})})}),to=(0,o.lazy)(()=>Promise.all([r.e("507"),r.e("573"),r.e("82")]).then(r.bind(r,6793)).then(e=>({default:e.BillingPage}))),tn=()=>{let{pages:e}=(0,a.useUserProfileContext)(),{__experimental_commerceSettings:t}=(0,a.useEnvironment)(),r=e.routes[0].id===n.xM.ACCOUNT,l=e.routes[0].id===n.xM.SECURITY,s=e.routes[0].id===n.xM.BILLING,d=e.contents?.map((e,t)=>{let o=!r&&!l&&0===t;return i.tZ(c.Route,{index:o,path:o?void 0:e.url,children:i.tZ(m.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)});return(0,i.BX)(c.Switch,{children:[d,(0,i.BX)(c.Route,{children:[(0,i.tZ)(c.Route,{path:r?void 0:"account",children:(0,i.tZ)(c.Switch,{children:(0,i.tZ)(c.Route,{index:!0,children:(0,i.tZ)(eg,{})})})}),(0,i.tZ)(c.Route,{path:l?void 0:"security",children:(0,i.tZ)(c.Switch,{children:(0,i.tZ)(c.Route,{index:!0,children:(0,i.tZ)(ti,{})})})}),t.billing.enabled&&t.billing.hasPaidUserPlans&&(0,i.tZ)(c.Route,{path:s?void 0:"billing",children:(0,i.BX)(c.Switch,{children:[(0,i.tZ)(c.Route,{index:!0,children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(to,{})})}),(0,i.tZ)(c.Route,{path:"plans",children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(ey,{})})}),(0,i.tZ)(c.Route,{path:"invoice/:invoiceId",children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(h.J,{})})})]})})]})]})};var ta=r(2786);let tl=(0,a.withCoreUserGuard)(()=>{let e=o.useRef(null);return(0,i.tZ)(s.ProfileCard.Root,{children:(0,i.BX)(u,{contentRef:e,children:[(0,i.tZ)(s.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,l.localizationKeys)("userProfile.navbar.title")}),(0,i.tZ)(s.ProfileCard.Content,{contentRef:e,scrollBoxId:n.g8,children:(0,i.tZ)(tn,{})})]})})}),ts=(0,s.withCardStateProvider)(e=>(0,i.tZ)(l.Flow.Root,{flow:"userProfile",children:(0,i.tZ)(l.Flow.Part,{children:(0,i.BX)(c.Switch,{children:[(0,i.tZ)(c.Route,{path:"verify",children:(0,i.tZ)(ta.M,{})}),(0,i.tZ)(c.Route,{children:(0,i.tZ)(tl,{})})]})})})),tc=e=>{let t={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,i.tZ)(c.Route,{path:"user",children:(0,i.tZ)(a.UserProfileContext.Provider,{value:t,children:(0,i.tZ)("div",{children:(0,i.tZ)(ts,{...t})})})})}}}]);