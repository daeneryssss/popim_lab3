"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["33"],{51991:function(e,t,n){n.r(t),n.d(t,{PlanDetails:()=>d}),n(65223);var a=n(88635),r=n(83799),i=n(69144),l=n(8756),o=n(43064),c=n(30948),s=n(96258),p=n(50043);let d=e=>(0,a.tZ)(l.SubscriberTypeContext.Provider,{value:e.subscriberType||"user",children:(0,a.tZ)(l.PlansContextProvider,{children:(0,a.tZ)(m,{...e})})}),m=e=>{let{plan:t,onSubscriptionCancel:n,portalRoot:s,planPeriod:d="month"}=e,m=(0,r.cL)(),{organization:h}=(0,r.o8)(),[g,x]=(0,i.useState)(!1),[D,y]=(0,i.useState)(!1),[b,B]=(0,i.useState)(),[S,Z]=(0,i.useState)(d),{setIsOpen:v}=(0,c.useDrawerContext)(),{activeOrUpcomingSubscription:C,revalidate:_,buttonPropsForPlan:w}=(0,l.usePlansContext)(),f=(0,l.useSubscriberTypeContext)();if(!t)return null;let k=C(t),T=()=>{v&&v(!1)},z=t.features,P=z.length>0,$=async()=>{k&&(B(void 0),y(!0),await k.cancel({orgId:"org"===f?null==h?void 0:h.id:void 0}).then(()=>{y(!1),null==n||n(),T()}).catch(e=>{(0,p.S3)(e,[],B),y(!1)}))},K=()=>{T();let e=S;"annual"===S&&0===t.annualMonthlyAmount&&(e="month"),m.__internal_openCheckout({planId:t.id,planPeriod:e,subscriberType:f,onSubscriptionComplete:()=>{_()},portalRoot:s})};return(0,a.BX)(c.Drawer.Content,{children:[(0,a.tZ)(c.Drawer.Header,{sx:e=>P?null:{flex:1,borderBottomWidth:0,background:e.colors.$colorBackground},children:(0,a.tZ)(u,{plan:t,subscription:k,planPeriod:S,setPlanPeriod:Z,closeSlot:(0,a.tZ)(c.Drawer.Close,{})})}),P?(0,a.BX)(c.Drawer.Body,{children:[(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.planDetailCaption,variant:"caption",localizationKey:(0,o.localizationKeys)("__experimental_commerce.availableFeatures"),colorScheme:"secondary",sx:e=>({padding:e.space.$4,paddingBottom:0})}),(0,a.tZ)(o.Box,{elementDescriptor:o.descriptors.planDetailFeaturesList,as:"ul",role:"list",sx:e=>({display:"grid",rowGap:e.space.$6,padding:e.space.$4,margin:0}),children:z.map(e=>(0,a.BX)(o.Box,{elementDescriptor:o.descriptors.planDetailFeaturesListItem,as:"li",sx:e=>({display:"flex",alignItems:"baseline",gap:e.space.$3}),children:[e.avatarUrl?(0,a.tZ)(c.Avatar,{size:e=>24,title:e.name,initials:e.name[0],rounded:!1,imageUrl:e.avatarUrl}):null,(0,a.BX)(o.Span,{elementDescriptor:o.descriptors.planDetailFeaturesListItemContent,children:[(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.planDetailFeaturesListItemTitle,colorScheme:"body",sx:e=>({fontWeight:e.fontWeights.$medium}),children:e.name}),e.description?(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.planDetailFeaturesListItemDescription,colorScheme:"secondary",sx:e=>({marginBlockStart:e.space.$0x25}),children:e.description}):null]})]},e.id))})]}):null,t.amount>0?(0,a.tZ)(c.Drawer.Footer,{children:k?k.canceledAt?(0,a.tZ)(o.Button,{block:!0,textVariant:"buttonLarge",...w({plan:t}),onClick:K}):(0,a.tZ)(o.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",onClick:()=>x(!0),localizationKey:(0,o.localizationKeys)("__experimental_commerce.cancelSubscription")}):(0,a.tZ)(o.Button,{block:!0,textVariant:"buttonLarge",...w({plan:t}),onClick:K})}):null,k?(0,a.BX)(c.Drawer.Confirmation,{open:g,onOpenChange:x,actionsSlot:(0,a.BX)(a.HY,{children:[!D&&(0,a.tZ)(o.Button,{variant:"ghost",size:"sm",textVariant:"buttonLarge",onClick:()=>{B(void 0),x(!1)},localizationKey:(0,o.localizationKeys)("__experimental_commerce.keepSubscription")}),(0,a.tZ)(o.Button,{variant:"solid",colorScheme:"danger",size:"sm",textVariant:"buttonLarge",isLoading:D,onClick:()=>{B(void 0),x(!1),$()},localizationKey:(0,o.localizationKeys)("__experimental_commerce.cancelSubscription")})]}),children:[(0,a.BX)(o.Heading,{elementDescriptor:o.descriptors.drawerConfirmationTitle,as:"h2",textVariant:"h3",children:["Cancel ","upcoming"===k.status?"upcoming ":"",k.plan.name," Subscription?"]}),(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.drawerConfirmationDescription,colorScheme:"secondary",children:"upcoming"===k.status?(0,a.tZ)(a.HY,{children:"You will not be charged for this subscription."}):(0,a.BX)(a.HY,{children:["You can keep using “",k.plan.name,"” features until"," ",(0,p.p6)(new Date(k.periodEnd)),", after which you will no longer have access."]})}),b&&(0,a.tZ)(c.Alert,{colorScheme:"danger",children:"string"==typeof b?b:b.message})]}):null]})},u=i.forwardRef((e,t)=>{let{plan:n,subscription:r,closeSlot:i,planPeriod:p,setPlanPeriod:d}=e,{captionForSubscription:m}=(0,l.usePlansContext)();return(0,a.BX)(o.Box,{ref:t,elementDescriptor:o.descriptors.planDetailHeader,sx:e=>({width:"100%",padding:e.space.$4,position:"relative"}),children:[i?(0,a.tZ)(o.Box,{sx:e=>({position:"absolute",top:e.space.$2,right:e.space.$2}),children:i}):null,n.avatarUrl?(0,a.tZ)(c.Avatar,{boxElementDescriptor:o.descriptors.planDetailAvatar,size:e=>40,title:n.name,initials:n.name[0],rounded:!1,imageUrl:n.avatarUrl,sx:e=>({marginBlockEnd:e.space.$3})}):null,r?(0,a.tZ)(o.Box,{elementDescriptor:o.descriptors.planDetailBadgeContainer,sx:e=>({marginBlockEnd:e.space.$3}),children:"active"===r.status?(0,a.tZ)(o.Badge,{elementDescriptor:o.descriptors.planDetailBadge,localizationKey:(0,o.localizationKeys)("badge__currentPlan"),colorScheme:"secondary"}):(0,a.tZ)(o.Badge,{elementDescriptor:o.descriptors.planDetailBadge,localizationKey:(0,o.localizationKeys)("badge__upcomingPlan"),colorScheme:"primary"})}):null,(0,a.BX)(o.Box,{sx:e=>({paddingRight:e.space.$10}),children:[(0,a.tZ)(o.Heading,{elementDescriptor:o.descriptors.planDetailTitle,as:"h2",textVariant:"h2",children:n.name}),n.description?(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.planDetailDescription,variant:"subtitle",colorScheme:"secondary",children:n.description}):null]}),n.amount>0?(0,a.tZ)(o.Flex,{elementDescriptor:o.descriptors.planDetailFeeContainer,align:"center",wrap:"wrap",sx:e=>({marginTop:e.space.$3,columnGap:e.space.$1x5}),children:(0,a.BX)(a.HY,{children:[(0,a.BX)(o.Text,{elementDescriptor:o.descriptors.planDetailFee,variant:"h1",colorScheme:"body",children:[n.currencySymbol,r&&"annual"===r.planPeriod||"annual"===p?n.annualMonthlyAmountFormatted:n.amountFormatted]}),(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.planDetailFeePeriod,variant:"caption",colorScheme:"secondary",sx:e=>({textTransform:"lowercase",":before":{content:'"/"',marginInlineEnd:e.space.$1}}),localizationKey:(0,o.localizationKeys)("__experimental_commerce.month")}),n.annualMonthlyAmount>0?(0,a.tZ)(o.Box,{elementDescriptor:o.descriptors.planDetailFeePeriodNotice,sx:[e=>({width:"100%",display:"grid",gridTemplateRows:r&&"annual"===r.planPeriod||"annual"===p?"1fr":"0fr"})],inert:r&&"annual"===r.planPeriod||"annual"===p?"true":void 0,children:(0,a.tZ)(o.Box,{elementDescriptor:o.descriptors.planDetailFeePeriodNoticeInner,sx:{overflow:"hidden",minHeight:0},children:(0,a.BX)(o.Text,{elementDescriptor:o.descriptors.planDetailFeePeriodNoticeLabel,variant:"caption",colorScheme:"secondary",sx:e=>({width:"100%",display:"flex",alignItems:"center",columnGap:e.space.$1}),children:[(0,a.tZ)(o.Icon,{icon:s.I$,colorScheme:"neutral",size:"sm","aria-hidden":!0})," ",(0,a.tZ)(o.Span,{localizationKey:(0,o.localizationKeys)("__experimental_commerce.billedAnnually")})]})})}):null]})}):null,!!r&&(0,a.tZ)(o.Text,{elementDescriptor:o.descriptors.planDetailCaption,variant:"caption",localizationKey:m(r),colorScheme:"secondary",sx:e=>({marginTop:e.space.$3})}),!r&&n.annualMonthlyAmount>0?(0,a.tZ)(o.Box,{elementDescriptor:o.descriptors.planDetailPeriodToggle,sx:e=>({display:"flex",marginTop:e.space.$3}),children:(0,a.BX)(c.SegmentedControl.Root,{"aria-label":"Set pay period",value:p,onChange:e=>d(e),children:[(0,a.tZ)(c.SegmentedControl.Button,{value:"month",text:"Monthly"}),(0,a.tZ)(c.SegmentedControl.Button,{value:"annual",text:"Annually"})]})}):null]})})}}]);