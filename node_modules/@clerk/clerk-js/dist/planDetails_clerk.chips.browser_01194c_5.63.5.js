"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["33"],{1991:function(e,t,n){n.r(t),n.d(t,{PlanDetails:()=>d});var a=n(8635),r=n(3799),i=n(9144),o=n(8756),l=n(3064),c=n(6106),s=n(6258),p=n(43);let d=e=>(0,a.tZ)(o.SubscriberTypeContext.Provider,{value:e.subscriberType||"user",children:(0,a.tZ)(o.PlansContextProvider,{children:(0,a.tZ)(m,{...e})})}),m=({plan:e,onSubscriptionCancel:t,portalRoot:n,planPeriod:s="month"})=>{let d=(0,r.cL)(),{organization:m}=(0,r.o8)(),[h,g]=(0,i.useState)(!1),[x,D]=(0,i.useState)(!1),[y,b]=(0,i.useState)(),[B,S]=(0,i.useState)(s),{setIsOpen:Z}=(0,c.useDrawerContext)(),{activeOrUpcomingSubscription:v,revalidate:C,buttonPropsForPlan:_}=(0,o.usePlansContext)(),w=(0,o.useSubscriberTypeContext)();if(!e)return null;let f=v(e),k=()=>{Z&&Z(!1)},T=e.features,z=T.length>0,P=async()=>{f&&(b(void 0),D(!0),await f.cancel({orgId:"org"===w?m?.id:void 0}).then(()=>{D(!1),t?.(),k()}).catch(e=>{(0,p.S3)(e,[],b),D(!1)}))},$=()=>{k();let t=B;"annual"===B&&0===e.annualMonthlyAmount&&(t="month"),d.__internal_openCheckout({planId:e.id,planPeriod:t,subscriberType:w,onSubscriptionComplete:()=>{C()},portalRoot:n})};return(0,a.BX)(c.Drawer.Content,{children:[(0,a.tZ)(c.Drawer.Header,{sx:e=>z?null:{flex:1,borderBottomWidth:0,background:e.colors.$colorBackground},children:(0,a.tZ)(u,{plan:e,subscription:f,planPeriod:B,setPlanPeriod:S,closeSlot:(0,a.tZ)(c.Drawer.Close,{})})}),z?(0,a.BX)(c.Drawer.Body,{children:[(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.planDetailCaption,variant:"caption",localizationKey:(0,l.localizationKeys)("__experimental_commerce.availableFeatures"),colorScheme:"secondary",sx:e=>({padding:e.space.$4,paddingBottom:0})}),(0,a.tZ)(l.Box,{elementDescriptor:l.descriptors.planDetailFeaturesList,as:"ul",role:"list",sx:e=>({display:"grid",rowGap:e.space.$6,padding:e.space.$4,margin:0}),children:T.map(e=>(0,a.BX)(l.Box,{elementDescriptor:l.descriptors.planDetailFeaturesListItem,as:"li",sx:e=>({display:"flex",alignItems:"baseline",gap:e.space.$3}),children:[e.avatarUrl?(0,a.tZ)(c.Avatar,{size:e=>24,title:e.name,initials:e.name[0],rounded:!1,imageUrl:e.avatarUrl}):null,(0,a.BX)(l.Span,{elementDescriptor:l.descriptors.planDetailFeaturesListItemContent,children:[(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.planDetailFeaturesListItemTitle,colorScheme:"body",sx:e=>({fontWeight:e.fontWeights.$medium}),children:e.name}),e.description?(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.planDetailFeaturesListItemDescription,colorScheme:"secondary",sx:e=>({marginBlockStart:e.space.$0x25}),children:e.description}):null]})]},e.id))})]}):null,e.amount>0?(0,a.tZ)(c.Drawer.Footer,{children:f?f.canceledAt?(0,a.tZ)(l.Button,{block:!0,textVariant:"buttonLarge",..._({plan:e}),onClick:$}):(0,a.tZ)(l.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",onClick:()=>g(!0),localizationKey:(0,l.localizationKeys)("__experimental_commerce.cancelSubscription")}):(0,a.tZ)(l.Button,{block:!0,textVariant:"buttonLarge",..._({plan:e}),onClick:$})}):null,f?(0,a.BX)(c.Drawer.Confirmation,{open:h,onOpenChange:g,actionsSlot:(0,a.BX)(a.HY,{children:[!x&&(0,a.tZ)(l.Button,{variant:"ghost",size:"sm",textVariant:"buttonLarge",onClick:()=>{b(void 0),g(!1)},localizationKey:(0,l.localizationKeys)("__experimental_commerce.keepSubscription")}),(0,a.tZ)(l.Button,{variant:"solid",colorScheme:"danger",size:"sm",textVariant:"buttonLarge",isLoading:x,onClick:()=>{b(void 0),g(!1),P()},localizationKey:(0,l.localizationKeys)("__experimental_commerce.cancelSubscription")})]}),children:[(0,a.BX)(l.Heading,{elementDescriptor:l.descriptors.drawerConfirmationTitle,as:"h2",textVariant:"h3",children:["Cancel ","upcoming"===f.status?"upcoming ":"",f.plan.name," Subscription?"]}),(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.drawerConfirmationDescription,colorScheme:"secondary",children:"upcoming"===f.status?(0,a.tZ)(a.HY,{children:"You will not be charged for this subscription."}):(0,a.BX)(a.HY,{children:["You can keep using “",f.plan.name,"” features until"," ",(0,p.p6)(new Date(f.periodEnd)),", after which you will no longer have access."]})}),y&&(0,a.tZ)(c.Alert,{colorScheme:"danger",children:"string"==typeof y?y:y.message})]}):null]})},u=i.forwardRef((e,t)=>{let{plan:n,subscription:r,closeSlot:i,planPeriod:p,setPlanPeriod:d}=e,{captionForSubscription:m}=(0,o.usePlansContext)();return(0,a.BX)(l.Box,{ref:t,elementDescriptor:l.descriptors.planDetailHeader,sx:e=>({width:"100%",padding:e.space.$4,position:"relative"}),children:[i?(0,a.tZ)(l.Box,{sx:e=>({position:"absolute",top:e.space.$2,right:e.space.$2}),children:i}):null,n.avatarUrl?(0,a.tZ)(c.Avatar,{boxElementDescriptor:l.descriptors.planDetailAvatar,size:e=>40,title:n.name,initials:n.name[0],rounded:!1,imageUrl:n.avatarUrl,sx:e=>({marginBlockEnd:e.space.$3})}):null,r?(0,a.tZ)(l.Box,{elementDescriptor:l.descriptors.planDetailBadgeContainer,sx:e=>({marginBlockEnd:e.space.$3}),children:"active"===r.status?(0,a.tZ)(l.Badge,{elementDescriptor:l.descriptors.planDetailBadge,localizationKey:(0,l.localizationKeys)("badge__currentPlan"),colorScheme:"secondary"}):(0,a.tZ)(l.Badge,{elementDescriptor:l.descriptors.planDetailBadge,localizationKey:(0,l.localizationKeys)("badge__upcomingPlan"),colorScheme:"primary"})}):null,(0,a.BX)(l.Box,{sx:e=>({paddingRight:e.space.$10}),children:[(0,a.tZ)(l.Heading,{elementDescriptor:l.descriptors.planDetailTitle,as:"h2",textVariant:"h2",children:n.name}),n.description?(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.planDetailDescription,variant:"subtitle",colorScheme:"secondary",children:n.description}):null]}),n.amount>0?(0,a.tZ)(l.Flex,{elementDescriptor:l.descriptors.planDetailFeeContainer,align:"center",wrap:"wrap",sx:e=>({marginTop:e.space.$3,columnGap:e.space.$1x5}),children:(0,a.BX)(a.HY,{children:[(0,a.BX)(l.Text,{elementDescriptor:l.descriptors.planDetailFee,variant:"h1",colorScheme:"body",children:[n.currencySymbol,r&&"annual"===r.planPeriod||"annual"===p?n.annualMonthlyAmountFormatted:n.amountFormatted]}),(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.planDetailFeePeriod,variant:"caption",colorScheme:"secondary",sx:e=>({textTransform:"lowercase",":before":{content:'"/"',marginInlineEnd:e.space.$1}}),localizationKey:(0,l.localizationKeys)("__experimental_commerce.month")}),n.annualMonthlyAmount>0?(0,a.tZ)(l.Box,{elementDescriptor:l.descriptors.planDetailFeePeriodNotice,sx:[e=>({width:"100%",display:"grid",gridTemplateRows:r&&"annual"===r.planPeriod||"annual"===p?"1fr":"0fr"})],inert:r&&"annual"===r.planPeriod||"annual"===p?"true":void 0,children:(0,a.tZ)(l.Box,{elementDescriptor:l.descriptors.planDetailFeePeriodNoticeInner,sx:{overflow:"hidden",minHeight:0},children:(0,a.BX)(l.Text,{elementDescriptor:l.descriptors.planDetailFeePeriodNoticeLabel,variant:"caption",colorScheme:"secondary",sx:e=>({width:"100%",display:"flex",alignItems:"center",columnGap:e.space.$1}),children:[(0,a.tZ)(l.Icon,{icon:s.I$,colorScheme:"neutral",size:"sm","aria-hidden":!0})," ",(0,a.tZ)(l.Span,{localizationKey:(0,l.localizationKeys)("__experimental_commerce.billedAnnually")})]})})}):null]})}):null,!!r&&(0,a.tZ)(l.Text,{elementDescriptor:l.descriptors.planDetailCaption,variant:"caption",localizationKey:m(r),colorScheme:"secondary",sx:e=>({marginTop:e.space.$3})}),!r&&n.annualMonthlyAmount>0?(0,a.tZ)(l.Box,{elementDescriptor:l.descriptors.planDetailPeriodToggle,sx:e=>({display:"flex",marginTop:e.space.$3}),children:(0,a.BX)(c.SegmentedControl.Root,{"aria-label":"Set pay period",value:p,onChange:e=>d(e),children:[(0,a.tZ)(c.SegmentedControl.Button,{value:"month",text:"Monthly"}),(0,a.tZ)(c.SegmentedControl.Button,{value:"annual",text:"Annually"})]})}):null]})})}}]);