"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["554"],{1171:function(e,i,t){t.d(i,{J:()=>h});var a=t(8635),o=t(8756),n=t(3064),r=t(6106),l=t(4229),s=t(6258),c=t(4676),d=t(1201),m=t(43),g=t(5913);let u=()=>{let{params:e,navigate:i}=(0,c.useRouter)(),{getInvoiceById:t,isLoading:l}=(0,o.useInvoicesContext)(),s=e.invoiceId?t(e.invoiceId):null;return l?(0,a.tZ)(n.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,a.tZ)(n.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:n.descriptors.spinner})}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(r.Header.Root,{children:(0,a.tZ)(r.Header.BackLink,{onClick:()=>void i("../../",{searchParams:new URLSearchParams("tab=invoices")}),children:(0,a.tZ)(r.Header.Title,{localizationKey:"Invoices",textVariant:"h2"})})}),(0,a.tZ)(n.Box,{elementDescriptor:n.descriptors.invoiceRoot,sx:e=>({display:"flex",flexDirection:"column",gap:e.space.$4,borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,marginBlockStart:e.space.$4,paddingBlockStart:e.space.$4}),children:s?(0,a.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceCard,sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg,overflow:"hidden"}),children:[(0,a.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceHeader,as:"header",sx:e=>({padding:e.space.$4,background:d.common.mergedColorsBackground(m.O9.setAlpha(e.colors.$colorBackground,1),e.colors.$neutralAlpha50),borderBlockEndWidth:e.borderWidths.$normal,borderBlockEndStyle:e.borderStyles.$solid,borderBlockEndColor:e.colors.$neutralAlpha100}),children:[(0,a.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceHeaderTitleBadgeContainer,sx:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,a.BX)(n.Span,{elementDescriptor:n.descriptors.invoiceTitleIdContainer,children:[(0,a.tZ)(n.Heading,{textVariant:"h2",elementDescriptor:n.descriptors.invoiceTitle,children:"Invoice ID"}),(0,a.BX)(n.Span,{elementDescriptor:n.descriptors.invoiceIdContainer,sx:e=>({display:"flex",alignItems:"center",gap:e.space.$0x25,color:e.colors.$colorTextSecondary}),children:[(0,a.tZ)(p,{copyLabel:"Copy invoice ID",text:s.id}),(0,a.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceId,colorScheme:"secondary",variant:"subtitle",children:(0,g.L)(s.id)})]})]}),(0,a.tZ)(n.Badge,{elementDescriptor:n.descriptors.invoiceBadge,colorScheme:"paid"===s.status?"success":"unpaid"===s.status?"warning":"danger",sx:{textTransform:"capitalize"},children:s.status})]}),(0,a.BX)(n.Dl,{elementDescriptor:n.descriptors.invoiceDetails,sx:e=>({display:"flex",justifyContent:"space-between",marginBlockStart:e.space.$3}),children:[(0,a.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceDetailsItem,children:[(0,a.tZ)(n.Dt,{elementDescriptor:n.descriptors.invoiceDetailsItemTitle,children:(0,a.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemTitleText,colorScheme:"secondary",variant:"body",children:"Created on"})}),(0,a.tZ)(n.Dd,{elementDescriptor:n.descriptors.invoiceDetailsItemValue,children:(0,a.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemValueText,variant:"subtitle",children:new Date(s.paymentDueOn).toLocaleDateString()})})]}),(0,a.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceDetailsItem,sx:{textAlign:"right"},children:[(0,a.tZ)(n.Dt,{elementDescriptor:n.descriptors.invoiceDetailsItemTitle,children:(0,a.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemTitleText,colorScheme:"secondary",variant:"body",children:"Due on"})}),(0,a.tZ)(n.Dd,{elementDescriptor:n.descriptors.invoiceDetailsItemValue,children:(0,a.tZ)(n.Text,{elementDescriptor:n.descriptors.invoiceDetailsItemValueText,variant:"subtitle",children:new Date(s.paymentDueOn).toLocaleDateString()})})]})]})]}),(0,a.tZ)(n.Box,{elementDescriptor:n.descriptors.invoiceContent,sx:e=>({padding:e.space.$4}),children:(0,a.BX)(r.LineItems.Root,{children:[(0,a.BX)(r.LineItems.Group,{children:[(0,a.tZ)(r.LineItems.Title,{title:"Plan"}),(0,a.tZ)(r.LineItems.Description,{text:`${s.totals.grandTotal.currencySymbol}${s.totals.grandTotal.amountFormatted}`,suffix:"per month"})]}),(0,a.BX)(r.LineItems.Group,{variant:"secondary",borderTop:!0,children:[(0,a.tZ)(r.LineItems.Title,{title:"Subtotal"}),(0,a.tZ)(r.LineItems.Description,{text:`${s.totals.grandTotal.currencySymbol}${s.totals.grandTotal.amountFormatted}`})]}),(0,a.BX)(r.LineItems.Group,{variant:"secondary",children:[(0,a.tZ)(r.LineItems.Title,{title:"Tax"}),(0,a.tZ)(r.LineItems.Description,{text:`${s.totals.taxTotal.currencySymbol}${s.totals.taxTotal.amountFormatted}`})]}),(0,a.BX)(r.LineItems.Group,{borderTop:!0,children:[(0,a.tZ)(r.LineItems.Title,{title:"Total due"}),(0,a.tZ)(r.LineItems.Description,{text:`${s.totals.grandTotal.currencySymbol}${s.totals.grandTotal.amountFormatted}`,prefix:"USD"})]})]})})]}):(0,a.tZ)(n.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,a.tZ)(n.Text,{children:"Invoice not found"})})})]})};function p({text:e,copyLabel:i="Copy"}){let{onCopy:t,hasCopied:o}=(0,l.VP)(e);return(0,a.tZ)(n.Button,{elementDescriptor:n.descriptors.invoiceCopyButton,variant:"unstyled",onClick:t,sx:e=>({color:"inherit",width:e.sizes.$4,height:e.sizes.$4,padding:0,borderRadius:e.radii.$sm,"&:focus-visible":{outline:"2px solid",outlineColor:e.colors.$neutralAlpha200}}),focusRing:!1,"aria-label":o?"Copied":i,children:(0,a.tZ)(n.Icon,{size:"sm",icon:o?s.Jr:s.CK,"aria-hidden":!0})})}let h=()=>(0,a.tZ)(o.InvoicesContextProvider,{children:(0,a.tZ)(u,{})})},9174:function(e,i,t){t.d(i,{k:()=>c,J:()=>p.J});var a=t(8635);t(9144);var o=t(8756),n=t(3064),r=t(6106),l=t(4676),s=t(5913);let c=()=>{let{invoices:e,isLoading:i,totalCount:t}=(0,o.useInvoicesContext)();return(0,a.tZ)(m,{page:1,onPageChange:e=>{},itemCount:t,pageCount:1,itemsPerPage:10,isLoading:i,emptyStateLocalizationKey:"No invoices to display",headers:["Date/Invoice","Status","Total"],rows:e.map(e=>(0,a.tZ)(d,{invoice:e},e.id))})},d=({invoice:e})=>{let{paymentDueOn:i,id:t,status:o,totals:{grandTotal:r}}=e,{navigate:c}=(0,l.useRouter)(),d=()=>{c(`invoice/${t}`)};return(0,a.BX)(u,{onClick:d,children:[(0,a.BX)(n.Td,{sx:{cursor:"pointer"},children:[(0,a.tZ)(n.Text,{variant:"subtitle",children:(0,a.tZ)(n.Link,{onClick:d,children:new Date(i).toLocaleDateString()})}),(0,a.tZ)(n.Text,{colorScheme:"secondary",truncate:!0,sx:e=>({marginTop:e.space.$0x5,textTransform:"uppercase"}),children:(0,s.L)(t)})]}),(0,a.tZ)(n.Td,{sx:{cursor:"pointer"},children:(0,a.tZ)(n.Badge,{colorScheme:{paid:"success",unpaid:"warning",past_due:"danger"}[o],sx:{textTransform:"capitalize"},children:o})}),(0,a.tZ)(n.Td,{sx:{cursor:"pointer"},children:(0,a.BX)(n.Text,{colorScheme:"secondary",children:[r.currencySymbol,r.amountFormatted]})})]})},m=e=>{let{headers:i,page:t,onPageChange:o,rows:l,isLoading:s,itemCount:c,itemsPerPage:d,pageCount:m,emptyStateLocalizationKey:u}=e,p=c>0?Math.max(0,(t-1)*d)+1:0,h=Math.min(t*d,c);return(0,a.BX)(n.Col,{gap:4,sx:{width:"100%"},children:[(0,a.tZ)(n.Flex,{sx:e=>({overflowX:"auto",padding:e.space.$1}),children:(0,a.BX)(n.Table,{sx:{tableLayout:"fixed"},children:[(0,a.tZ)(n.Thead,{children:(0,a.tZ)(n.Tr,{children:i.map((e,i)=>(0,a.tZ)(n.Th,{elementDescriptor:n.descriptors.tableHead,localizationKey:e},i))})}),(0,a.tZ)(n.Tbody,{children:s?(0,a.tZ)(n.Tr,{children:(0,a.tZ)(n.Td,{colSpan:4,children:(0,a.tZ)(n.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:n.descriptors.spinner})})}):l.length?l:(0,a.tZ)(g,{localizationKey:u},"empty")})]})}),m>1&&(0,a.tZ)(r.Pagination,{count:m,page:t,onChange:o,siblingCount:1,rowInfo:{allRowsCount:c,startingRow:p,endingRow:h}})]})},g=e=>(0,a.tZ)(n.Tr,{children:(0,a.tZ)(n.Td,{colSpan:4,children:(0,a.tZ)(n.Text,{localizationKey:e.localizationKey,sx:{margin:"auto",display:"block",width:"fit-content"}})})}),u=e=>(0,a.tZ)(n.Tr,{...e,sx:e=>({":hover":{backgroundColor:e.colors.$neutralAlpha50}})});var p=t(1171)},8820:function(e,i,t){t.r(i),t.d(i,{OrganizationProfileModal:()=>eK,OrganizationProfile:()=>eB});var a=t(8635),o=t(3799),n=t(9144),r=t(1673),l=t(8756),s=t(3064),c=t(6106),d=t(4676),m=t(8969),g=t(1085);let u=e=>{let{organization:i}=(0,o.o8)(),{pages:t}=(0,l.useOrganizationProfileContext)(),n=(0,m.N2)(e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}));return i?(0,a.BX)(c.NavbarContextProvider,{children:[(0,a.tZ)(c.NavBar,{title:(0,g.u1)("organizationProfile.navbar.title"),description:(0,g.u1)("organizationProfile.navbar.description"),routes:t.routes.filter(e=>e.id!==r.bm.MEMBERS||e.id===r.bm.MEMBERS&&n),contentRef:e.contentRef}),e.children]}):null};var p=t(4995),h=t(9805),f=t(4709),v=t(43),b=t(7484);let z=e=>{let i=(0,c.useCardState)(),{navigateAfterLeaveOrganization:t}=(0,l.useOrganizationProfileContext)(),{userMemberships:a,userInvitations:n}=(0,o.eW)({userMemberships:b.AO.userMemberships,userInvitations:b.AO.userInvitations});return()=>i.runAsync(async()=>{await e?.()}).then(()=>{a.revalidate?.(),n.revalidate?.(),t()})},Z=e=>{let{organization:i}=(0,o.o8)(),{user:t}=(0,o.aF)(),n=z(()=>t.leaveOrganization(i.id));return i&&t?(0,a.tZ)(P,{organizationName:i?.name,title:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:i?.name}),submitLabel:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:n,...e}):null},y=e=>{let{organization:i,membership:t}=(0,o.o8)(),n=z(i?.destroy);return i&&t?(0,a.tZ)(P,{organizationName:i?.name,title:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:i?.name}),submitLabel:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:n,...e}):null},P=(0,c.withCardStateProvider)(e=>{let{title:i,messageLine1:t,messageLine2:o,actionDescription:n,organizationName:r,successMessage:l,submitLabel:d,onSuccess:g,onReset:u,onConfirmation:p,colorScheme:h="danger"}=e,f=(0,m.a2)(),b=(0,c.useCardState)(),z=(0,v.Yp)("deleteOrganizationConfirmation","",{type:"text",label:n||(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription"),isRequired:!0,placeholder:r}),Z=!n||z.value===r,y=async()=>{if(Z)try{await p().then(()=>f.nextStep())}catch(e){(0,v.S3)(e,[],b.setError)}};return(0,a.BX)(m.en,{...f.props,children:[(0,a.tZ)(c.FormContainer,{headerTitle:i,gap:1,children:(0,a.BX)(c.Form.Root,{onSubmit:y,children:[(0,a.BX)(s.Col,{children:[(0,a.tZ)(s.Text,{localizationKey:t,colorScheme:"secondary"}),(0,a.tZ)(s.Text,{localizationKey:o,colorScheme:"danger"})]}),(0,a.tZ)(c.Form.ControlRow,{elementId:z.id,children:(0,a.tZ)(c.Form.PlainInput,{...z.props})}),(0,a.BX)(c.FormButtonContainer,{children:[(0,a.tZ)(c.Form.SubmitButton,{block:!1,colorScheme:h,localizationKey:d,isDisabled:!Z}),(0,a.tZ)(c.Form.ResetButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:u})]})]})}),(0,a.tZ)(c.SuccessPage,{title:i,text:l,onFinish:g})]})});var S=t(4229),x=t(6258);let C=(e,{infoLabel:i})=>{let t=e?.totalPendingInvitations||0;return 0===(e?.totalPendingSuggestions||0)+t?[]:[i,(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:t}),(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:t})]},T=e=>{let i=[];return e.domains.enrollmentModes.includes("manual_invitation")&&i.push({value:"manual_invitation",label:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}),e.domains.enrollmentModes.includes("automatic_invitation")&&i.push({value:"automatic_invitation",label:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}),e.domains.enrollmentModes.includes("automatic_suggestion")&&i.push({value:"automatic_suggestion",label:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}),i},D=()=>{let{organizationSettings:e}=(0,l.useEnvironment)();return T(e)},B=(0,c.withCardStateProvider)(e=>{let{domainId:i,mode:t="edit",onSuccess:r,onReset:d}=e,g=(0,c.useCardState)(),{organizationSettings:u}=(0,l.useEnvironment)(),{membership:p,organization:h,domains:f}=(0,o.o8)({domains:{infinite:!0}}),b="edit"===t,z=D(),Z=(0,v.Yp)("enrollmentMode","",{type:"radio",radioOptions:z,isRequired:!0}),y=(0,v.Yp)("deleteExistingInvitationsSuggestions","",{label:(0,s.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:P,isLoading:T}=(0,S.ib)(h?.getDomain,{domainId:i});(0,n.useEffect)(()=>{P&&Z.setValue(P.enrollmentMode)},[P?.id]);let B=(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.title",{domain:P?.name}),K=(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:P?.name}),_=C(P,{infoLabel:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")}),I=async()=>{if(P&&h&&p&&f)try{await P.updateEnrollmentMode({enrollmentMode:Z.value,deletePending:y.checked}),await f.revalidate(),r()}catch(e){(0,v.S3)(e,[Z],g.setError)}};return h&&u?T||!P?(0,a.tZ)(s.Flex,{direction:"row",align:"center",justify:"center",sx:{height:"100%"},children:(0,a.tZ)(s.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:s.descriptors.spinner})}):(P.verification&&"verified"===P.verification.status||d(),(0,a.tZ)(c.FormContainer,{headerTitle:B,headerSubtitle:b?void 0:K,gap:4,children:(0,a.BX)(s.Col,{gap:6,children:[_.length>0&&(0,a.tZ)(m.aX,{icon:x.I$,children:_.map((e,i)=>(0,a.tZ)(s.Text,{as:"span",sx:{display:"block"},localizationKey:e},i))}),(0,a.tZ)(c.Header.Root,{children:(0,a.tZ)(c.Header.Subtitle,{localizationKey:(0,s.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"subtitle"})}),(0,a.BX)(c.Form.Root,{onSubmit:I,gap:6,children:[(0,a.tZ)(c.Form.ControlRow,{elementId:Z.id,children:(0,a.tZ)(c.Form.RadioGroup,{...Z.props})}),b&&"manual_invitation"===Z.value&&(0,a.tZ)(c.Form.ControlRow,{elementId:y.id,children:(0,a.tZ)(c.Form.Checkbox,{...y.props})}),(0,a.tZ)(c.FormButtons,{isDisabled:T||!P,onReset:d})]})]})})):null}),K=(0,c.withCardStateProvider)(e=>{let{domainId:i,onSuccess:t,onReset:r,skipToVerified:d}=e,g=(0,c.useCardState)(),{organizationSettings:u}=(0,l.useEnvironment)(),{organization:p}=(0,o.o8)(),{data:h,isLoading:f}=(0,S.ib)(d?void 0:p?.getDomain,{domainId:i}),b=(0,s.localizationKeys)("organizationProfile.verifyDomainPage.title"),z=(0,s.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:h?.name??""}),Z=(0,m.a2)({defaultStep:2*!!d,onNextStep:()=>g.setError(void 0)}),y=(0,v.Yp)("affiliationEmailAddress","",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,s.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription"),isRequired:!0}),P=(0,n.useRef)(),x=(0,s.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:P.current}),C=(e,i,a)=>{h?.attemptAffiliationVerification?.({code:e}).then(async e=>{await i(),e.verification?.status==="verified"?Z.nextStep():t?.()}).catch(e=>a(e))},T=(0,c.useFieldOTP)({onCodeEntryFinished:(e,i,t)=>{C(e,i,t)},onResendCodeClicked:()=>{h?.prepareAffiliationVerification({affiliationEmailAddress:y.value}).catch(e=>{v.S3(e,[y],g.setError)})}});if(!p||!u)return null;let D=p.name!==y.value,K=`@${h?.name}`;return!f&&h||d?(0,a.BX)(m.en,{...Z.props,children:[(0,a.tZ)(c.FormContainer,{headerTitle:b,headerSubtitle:z,children:(0,a.BX)(c.Form.Root,{onSubmit:e=>{if(e.preventDefault(),h)return P.current=`${y.value}${K}`,h.prepareAffiliationVerification({affiliationEmailAddress:P.current}).then(Z.nextStep).catch(e=>{(0,v.S3)(e,[y],g.setError)})},children:[(0,a.tZ)(c.Form.ControlRow,{elementId:y.id,children:(0,a.tZ)(c.Form.InputGroup,{...y.props,autoFocus:!0,groupSuffix:K,ignorePasswordManager:!0})}),(0,a.tZ)(c.FormButtons,{isDisabled:!D,onReset:r})]})}),(0,a.BX)(c.FormContainer,{headerTitle:b,headerSubtitle:x,children:[(0,a.tZ)(c.Form.OTPInput,{...T,label:(0,s.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),description:(0,s.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,s.localizationKeys)("organizationProfile.verifyDomainPage.resendButton")}),(0,a.tZ)(c.FormButtonContainer,{children:(0,a.tZ)(s.Button,{elementDescriptor:s.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonSmall",type:"reset",isDisabled:T.isLoading||"success"===T.otpControl.otpInputProps.feedbackType,onClick:()=>{T.otpControl.otpInputProps.clearFeedback(),T.otpControl.reset(),Z.prevStep()},localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset")})})]}),(0,a.tZ)(B,{domainId:i,mode:"select",onSuccess:t,onReset:r})]}):(0,a.tZ)(s.Flex,{direction:"row",align:"center",justify:"center",children:(0,a.tZ)(s.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:s.descriptors.spinner})})}),_=(0,c.withCardStateProvider)(e=>{let{onSuccess:i,onReset:t}=e,{organizationSettings:r}=(0,l.useEnvironment)(),{domains:d}=(0,o.o8)({domains:{infinite:!0}}),g=(0,m.a2)({onNextStep:()=>Z.setError(void 0)}),[u,p]=(0,n.useState)(""),[h,f]=(0,n.useState)(!1),b=(0,s.localizationKeys)("organizationProfile.createDomainPage.title"),z=(0,s.localizationKeys)("organizationProfile.createDomainPage.subtitle"),Z=(0,c.useCardState)(),{organization:y}=(0,o.o8)(),P=(0,v.Yp)("name","",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!y||!r)return null;let S=""!==P.value.trim();return(0,a.BX)(m.en,{...g.props,children:[(0,a.tZ)(c.FormContainer,{headerTitle:b,headerSubtitle:z,children:(0,a.BX)(c.Form.Root,{onSubmit:e=>(P.clearFeedback(),e.preventDefault(),y.createDomain(P.value).then(async e=>{p(e.id),d?.revalidate?.(),e.verification&&"verified"===e.verification.status&&f(!0),g.nextStep()}).catch(e=>{(0,v.S3)(e,[P],Z.setError)})),children:[(0,a.tZ)(c.Form.ControlRow,{elementId:P.id,children:(0,a.tZ)(c.Form.PlainInput,{...P.props,autoFocus:!0,ignorePasswordManager:!0,isRequired:!0})}),(0,a.tZ)(c.FormButtons,{isDisabled:!S,onReset:t})]})}),(0,a.tZ)(K,{domainId:u,onSuccess:()=>{d?.revalidate?.(),i?.()},skipToVerified:h,onReset:t})]})}),I={manual_invitation:(0,s.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,s.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,s.localizationKeys)("organizationProfile.badge__automaticSuggestion")},R=e=>{let{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,a.tZ)(s.Badge,{localizationKey:I[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"primary":"success"}):(0,a.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("organizationProfile.badge__unverified"),colorScheme:"warning"}):null},w=e=>{let{organizationSettings:i}=(0,l.useEnvironment)(),{organization:t}=(0,o.o8)(),{domainId:r,onSuccess:c,onReset:d}=e,u=n.useRef(),{data:p,isLoading:h}=(0,S.ib)(t?.getDomain,{domainId:r},{onSuccess(e){u.current={...e}}}),{domains:f}=(0,o.o8)({domains:{infinite:!0}});return t&&i?h||!p?(0,a.tZ)(s.Flex,{direction:"row",align:"center",justify:"center",children:(0,a.tZ)(s.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:s.descriptors.spinner})}):(0,a.tZ)(m.LE,{title:(0,g.u1)("organizationProfile.removeDomainPage.title"),messageLine1:(0,g.u1)("organizationProfile.removeDomainPage.messageLine1",{domain:u.current?.name}),messageLine2:(0,g.u1)("organizationProfile.removeDomainPage.messageLine2"),deleteResource:()=>p?.delete().then(async()=>{await f?.revalidate?.(),c()}),onSuccess:c,onReset:d}):null},L=e=>{let{close:i}=(0,f.XC)();return(0,a.tZ)(w,{onSuccess:i,onReset:i,...e})},$=e=>{let{close:i}=(0,f.XC)();return(0,a.tZ)(B,{onSuccess:i,onReset:i,...e})},X=e=>{let{close:i}=(0,f.XC)();return(0,a.tZ)(K,{onSuccess:i,onReset:i,skipToVerified:!1,...e})},F=e=>{let{open:i}=(0,f.XC)(),t=[];return e.verification&&"verified"===e.verification.status?t.push({label:(0,s.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__manage"),onClick:()=>i("manage")}):t.push({label:(0,s.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__verify"),onClick:()=>i("verify")}),t.push({label:(0,s.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__remove"),isDestructive:!0,onClick:()=>i("remove")}),t},k=({domain:e})=>{let i=F(e);return(0,a.tZ)(c.ThreeDotsMenu,{actions:i})},O=(0,m.Ci)(e=>{let{verificationStatus:i,enrollmentMode:t,fallback:r,...l}=e,{organization:d,domains:g}=(0,o.o8)({domains:{infinite:!0,...l}}),{ref:u}=(0,S.YD)({threshold:0,onChange:e=>{e&&g?.fetchNext?.()}}),p=(0,n.useMemo)(()=>g?.data?g.data.filter(e=>{let a=!0,o=!0;return i&&(a=!!e.verification&&e.verification.status===i),t&&(o=e.enrollmentMode===t),a&&o}):[],[g?.data]);if(!d)return null;let f=g?.hasNextPage||g?.isFetching;return 0!==p.length||g?.isLoading||r?(0,a.BX)(c.ProfileSection.ItemList,{id:"organizationDomains",children:[0===p.length&&!g?.isLoading&&r,p.map(e=>(0,a.BX)(h.a.Root,{children:[(0,a.BX)(c.ProfileSection.Item,{id:"organizationDomains",hoverable:!0,children:[(0,a.BX)(s.Flex,{sx:e=>({gap:e.space.$1}),children:[(0,a.tZ)(s.Text,{children:e.name}),(0,a.tZ)(R,{organizationDomain:e})]}),(0,a.tZ)(m.Cv,{permission:"org:sys_domains:manage",children:(0,a.tZ)(k,{domain:e})})]}),(0,a.tZ)(h.a.Open,{value:"remove",children:(0,a.tZ)(h.a.Card,{variant:"destructive",children:(0,a.tZ)(L,{domainId:e.id})})}),(0,a.tZ)(h.a.Open,{value:"verify",children:(0,a.tZ)(h.a.Card,{children:(0,a.tZ)(X,{domainId:e.id})})}),(0,a.tZ)(h.a.Open,{value:"manage",children:(0,a.tZ)(h.a.Card,{children:(0,a.tZ)($,{domainId:e.id})})})]},e.id)),(0,a.tZ)(s.Box,{ref:g?.hasNextPage&&!g.isFetching?u:void 0,sx:{visibility:"hidden"}}),f&&0===g.data.length&&(0,a.tZ)(s.Box,{sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,a.tZ)(s.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,a.tZ)(s.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:s.descriptors.spinner})})})]}):null},{permission:"org:sys_domains:read"});var A=t(6917),M=t(8181);let E=(0,c.withCardStateProvider)(e=>{let{onSuccess:i,onReset:t}=e,n=(0,s.localizationKeys)("organizationProfile.profilePage.title"),r=(0,c.useCardState)(),{organization:l}=(0,o.o8)(),d=(0,v.Yp)("name",l?.name||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__organizationName")}),m=(0,v.Yp)("slug",l?.slug||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!l)return null;let g=(l.name!==d.value||l.slug!==m.value)&&"error"!==m.feedbackType,u=async e=>(e.preventDefault(),(g?l.update({name:d.value,slug:m.value}):Promise.resolve()).then(i).catch(e=>{(0,v.S3)(e,[d,m],r.setError)})),p=e=>{m.setValue(e),m.clearFeedback()};return(0,a.tZ)(c.FormContainer,{headerTitle:n,children:(0,a.BX)(c.Form.Root,{onSubmit:u,children:[(0,a.tZ)(M.D,{organization:l,onAvatarChange:e=>l.setLogo({file:e}).then(()=>{r.setIdle()}).catch(e=>(0,v.S3)(e,[],r.setError)),onAvatarRemove:(0,A.QO)(l.imageUrl)?null:()=>{l.setLogo({file:null}).then(()=>{r.setIdle()}).catch(e=>(0,v.S3)(e,[],r.setError))}}),(0,a.tZ)(c.Form.ControlRow,{elementId:d.id,children:(0,a.tZ)(c.Form.PlainInput,{...d.props,autoFocus:!0,isRequired:!0,ignorePasswordManager:!0})}),(0,a.tZ)(c.Form.ControlRow,{elementId:m.id,children:(0,a.tZ)(c.Form.PlainInput,{...m.props,onChange:e=>{p(e.target.value)},ignorePasswordManager:!0})}),(0,a.tZ)(c.FormButtons,{isDisabled:!g,onReset:t})]})})}),H=()=>{let{close:e}=(0,f.XC)();return(0,a.tZ)(E,{onSuccess:e,onReset:e})},q=()=>{let{close:e}=(0,f.XC)();return(0,a.tZ)(_,{onSuccess:e,onReset:e})},N=()=>{let{close:e}=(0,f.XC)();return(0,a.tZ)(Z,{onSuccess:e,onReset:e})},V=()=>{let{close:e}=(0,f.XC)();return(0,a.tZ)(y,{onSuccess:e,onReset:e})},j=()=>(0,a.tZ)(s.Col,{elementDescriptor:s.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,a.BX)(s.Col,{elementDescriptor:s.descriptors.profilePage,elementId:s.descriptors.profilePage.setId("organizationGeneral"),children:[(0,a.tZ)(c.Header.Root,{children:(0,a.tZ)(c.Header.Title,{localizationKey:(0,s.localizationKeys)("organizationProfile.start.headerTitle__general"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,a.tZ)(W,{}),(0,a.tZ)(m.Cv,{permission:"org:sys_domains:read",children:(0,a.tZ)(Y,{})}),(0,a.tZ)(U,{}),(0,a.tZ)(G,{})]})}),W=()=>{let{organization:e}=(0,o.o8)();if(!e)return null;let i=(0,a.tZ)(c.OrganizationPreview,{size:"lg",mainIdentifierVariant:"subtitle",organization:e});return(0,a.tZ)(c.ProfileSection.Root,{title:(0,s.localizationKeys)("organizationProfile.start.profileSection.title"),id:"organizationProfile",children:(0,a.BX)(h.a.Root,{children:[(0,a.tZ)(m.Cv,{permission:"org:sys_profile:manage",fallback:i,children:(0,a.tZ)(h.a.Closed,{value:"edit",children:(0,a.BX)(c.ProfileSection.Item,{id:"organizationProfile",children:[i,(0,a.tZ)(h.a.Trigger,{value:"edit",children:(0,a.tZ)(c.ProfileSection.Button,{id:"organizationProfile",localizationKey:(0,s.localizationKeys)("organizationProfile.start.profileSection.primaryButton")})})]})})}),(0,a.tZ)(h.a.Open,{value:"edit",children:(0,a.tZ)(h.a.Card,{children:(0,a.tZ)(H,{})})})]})})},Y=()=>{let{organizationSettings:e}=(0,l.useEnvironment)(),{organization:i}=(0,o.o8)();return e&&i&&e.domains.enabled?(0,a.tZ)(c.ProfileSection.Root,{title:(0,s.localizationKeys)("organizationProfile.profilePage.domainSection.title"),id:"organizationDomains",centered:!1,children:(0,a.BX)(h.a.Root,{children:[(0,a.tZ)(O,{}),(0,a.BX)(m.Cv,{permission:"org:sys_domains:manage",children:[(0,a.tZ)(h.a.Trigger,{value:"add",children:(0,a.BX)(s.Col,{children:[(0,a.tZ)(c.ProfileSection.ArrowButton,{localizationKey:(0,s.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"organizationDomains"}),(0,a.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),sx:e=>({paddingLeft:e.space.$9}),colorScheme:"secondary"})]})}),(0,a.tZ)(h.a.Open,{value:"add",children:(0,a.tZ)(h.a.Card,{children:(0,a.tZ)(q,{})})})]})]})}):null},U=()=>{let{organization:e}=(0,o.o8)();return e?(0,a.tZ)(c.ProfileSection.Root,{id:"organizationDanger",title:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),children:(0,a.BX)(h.a.Root,{children:[(0,a.tZ)(h.a.Closed,{value:"leave",children:(0,a.tZ)(c.ProfileSection.Item,{sx:e=>({paddingTop:0,paddingBottom:0,paddingLeft:e.space.$1}),id:"organizationDanger",children:(0,a.tZ)(h.a.Trigger,{value:"leave",children:(0,a.tZ)(c.ProfileSection.Button,{id:"organizationDanger",variant:"ghost",colorScheme:"danger",textVariant:"buttonLarge",localizationKey:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")})})})}),(0,a.tZ)(h.a.Open,{value:"leave",children:(0,a.tZ)(h.a.Card,{variant:"destructive",children:(0,a.tZ)(N,{})})})]})}):null},G=()=>{let{organization:e}=(0,o.o8)(),i=(0,m.N2)({permission:"org:sys_profile:delete"});if(!e)return null;let t=e.adminDeleteEnabled;return i&&t?(0,a.tZ)(c.ProfileSection.Root,{id:"organizationDanger",title:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,a.BX)(h.a.Root,{children:[(0,a.tZ)(h.a.Closed,{value:"delete",children:(0,a.tZ)(c.ProfileSection.Item,{sx:e=>({paddingTop:0,paddingBottom:0,paddingLeft:e.space.$1}),id:"organizationDanger",children:(0,a.tZ)(h.a.Trigger,{value:"delete",children:(0,a.tZ)(c.ProfileSection.Button,{id:"organizationDanger",variant:"ghost",colorScheme:"danger",textVariant:"buttonLarge",localizationKey:(0,s.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})})})}),(0,a.tZ)(h.a.Open,{value:"delete",children:(0,a.tZ)(h.a.Card,{variant:"destructive",children:(0,a.tZ)(V,{})})})]})}):null};var Q=t(9174);let J=()=>(0,a.tZ)(l.SubscriberTypeContext.Provider,{value:"org",children:(0,a.tZ)(Q.J,{})});var ee=t(1201),ei=t(3559),et=t(5872),ea=t(408);let eo=({memberships:e,pageSize:i})=>{let t=(0,c.useCardState)(),{organization:n}=(0,o.o8)(),{options:r,isLoading:l}=(0,et.e)();if(!n)return null;let d=e=>i=>t.runAsync(()=>e.update({role:i})).catch(e=>(0,v.S3)(e,[],t.setError)),m=i=>async()=>t.runAsync(async()=>{let t=await i.destroy();return await e?.revalidate?.(),t}).catch(e=>(0,v.S3)(e,[],t.setError));return(0,a.tZ)(ea.wQ,{page:e?.page||1,onPageChange:i=>e?.fetchPage?.(i),itemCount:e?.count||0,pageCount:e?.pageCount||0,itemsPerPage:i,isLoading:e?.isLoading&&!e?.data.length||l,emptyStateLocalizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:(e?.data||[]).map(e=>(0,a.tZ)(en,{membership:e,options:r,onRoleChange:d(e),onRemove:m(e)},e.id))})},en=e=>{let{membership:i,onRemove:t,onRoleChange:n,options:r}=e,{localizeCustomRole:l}=(0,et.q)(),d=(0,c.useCardState)(),{user:m}=(0,o.aF)(),g=m?.id===i.publicUserData.userId,u=r?.find(e=>e.value===i.role)?.label;return(0,a.BX)(ea.RN,{children:[(0,a.tZ)(s.Td,{children:(0,a.tZ)(c.UserPreview,{sx:{maxWidth:"30ch"},user:i.publicUserData,subtitle:i.publicUserData.identifier,badge:g&&(0,a.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__you")})})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(s.Box,{as:"span",elementDescriptor:s.descriptors.formattedDate,elementId:s.descriptors.formattedDate.setId("tableCell"),children:i.createdAt.toLocaleDateString()})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(ei.Cv,{permission:"org:sys_memberships:manage",fallback:(0,a.tZ)(s.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:l(i.role)||u}),children:(0,a.tZ)(ea.DQ,{isDisabled:d.isLoading||!n,value:i.role,onChange:n,roles:r})})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(ei.Cv,{permission:"org:sys_memberships:manage",children:(0,a.tZ)(c.ThreeDotsMenu,{actions:[{label:(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:t,isDisabled:g}],elementId:"member"})})})]})};var er=t(5727);let el=({actionSlot:e})=>{let i=(0,m.N2)({permission:"org:sys_memberships:manage"});return(0,a.BX)(h.a.Root,{animate:!1,children:[(0,a.tZ)(c.Animated,{asChild:!0,children:(0,a.BX)(s.Flex,{justify:e?"between":"end",sx:e=>({width:"100%",marginLeft:"auto",padding:`${e.space.$none} ${e.space.$1}`}),gap:e?2:void 0,children:[e,i&&(0,a.tZ)(h.a.Trigger,{value:"invite",hideOnActive:!e,children:(0,a.tZ)(s.Button,{elementDescriptor:s.descriptors.membersPageInviteButton,"aria-label":"Invite",localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.action__invite")})})]})}),i&&(0,a.tZ)(c.Animated,{children:(0,a.tZ)(h.a.Open,{value:"invite",children:(0,a.tZ)(s.Flex,{sx:e=>({paddingBottom:e.space.$6,padding:`${e.space.$none} ${e.space.$1} ${e.space.$6} ${e.space.$1}`}),children:(0,a.tZ)(h.a.Card,{sx:{width:"100%"},children:(0,a.tZ)(er.N,{})})})})})]})},es=()=>{let{organization:e}=(0,o.o8)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:t,__unstable_manageBillingMembersLimit:n}=(0,l.useOrganizationProfileContext)(),r=(0,d.useRouter)();if(!e)return null;let m=e?.membersCount+e?.pendingInvitationsCount,g=(0,A.OR)(n);return(0,a.tZ)(s.Flex,{sx:e=>({background:e.colors.$neutralAlpha50,padding:e.space.$2,borderRadius:e.radii.$md,gap:e.space.$4}),children:(0,a.BX)(s.Flex,{align:"center",sx:e=>({[ee.mqu.sm]:{gap:e.space.$3},gap:e.space.$2}),children:[g>0&&(0,a.tZ)(c.Gauge,{limit:g,value:m,size:"xs"}),(0,a.BX)(s.Flex,{sx:e=>({[ee.mqu.sm]:{flexDirection:"column"},gap:e.space.$0x5}),children:[(0,a.BX)(s.Text,{children:["You can invite ",n?`up to ${g}`:"unlimited"," members."]}),g>0&&(0,a.BX)(s.Link,{sx:e=>({fontWeight:e.fontWeights.$medium}),variant:"body",onClick:()=>r.navigate((0,A.OR)(i)),children:[(0,A.OR)(t)||"Manage billing",(0,a.tZ)(s.Icon,{icon:x.LZ})]})]})]})})};var ec=t(9572);let ed=({query:e,value:i,memberships:t,onSearchChange:o,onQueryTrigger:r})=>{let{t:l}=(0,s.useLocalizations)(),d=(0,n.useRef)(null);(0,n.useEffect)(()=>{e&&t?.data&&(t?.count??0)<=eZ&&t?.fetchPage?.(1)},[e,t]);let m=i&&!!t?.isLoading&&!!t.data?.length;return(0,a.tZ)(c.Animated,{asChild:!0,children:(0,a.tZ)(s.Flex,{sx:{width:"50%",[ee.mqu.sm]:{width:"auto"}},children:(0,a.tZ)(c.InputWithIcon,{value:i,type:"search",autoCapitalize:"none",spellCheck:!1,"aria-label":"Search",placeholder:l((0,s.localizationKeys)("organizationProfile.membersPage.action__search")),leftIcon:m?(0,a.tZ)(ec.$j,{size:"xs"}):(0,a.tZ)(s.Icon,{icon:x.Yt,elementDescriptor:s.descriptors.organizationProfileMembersSearchInputIcon}),onKeyUp:function(){d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{r(i.trim())},500)},onChange:e=>{let i=e.target.value;o(i),""===i&&r(i)},elementDescriptor:s.descriptors.organizationProfileMembersSearchInput})})})},em={invitations:{pageSize:10,keepPreviousData:!0}},eg=()=>{let e=(0,c.useCardState)(),{organization:i,invitations:t}=(0,o.o8)(em),{options:n,isLoading:r}=(0,et.e)();if(!i)return null;let l=i=>async()=>e.runAsync(async()=>(await i.revoke(),await t?.revalidate?.(),i)).catch(i=>(0,v.S3)(i,[],e.setError));return(0,a.tZ)(ea.wQ,{page:t?.page||1,onPageChange:t?.fetchPage||(()=>null),itemCount:t?.count||0,pageCount:t?.pageCount||0,itemsPerPage:em.invitations.pageSize,isLoading:t?.isLoading||r,emptyStateLocalizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,s.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:(t?.data||[]).map(e=>(0,a.tZ)(eu,{options:n,invitation:e,onRevoke:l(e)},e.id))})},eu=e=>{let{invitation:i,onRevoke:t,options:o}=e,{localizeCustomRole:n}=(0,et.q)(),r=o?.find(e=>e.value===i.role)?.label;return(0,a.BX)(ea.RN,{children:[(0,a.tZ)(s.Td,{children:(0,a.tZ)(c.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:i.emailAddress}}})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(s.Box,{as:"span",elementDescriptor:s.descriptors.formattedDate,elementId:s.descriptors.formattedDate.setId("tableCell"),children:i.createdAt.toLocaleDateString()})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(s.Text,{colorScheme:"secondary",localizationKey:n(i.role)||r})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(c.ThreeDotsMenu,{actions:[{label:(0,s.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:t}],elementId:"invitation"})})]})},ep=(0,c.withCardStateProvider)(()=>{let{organizationSettings:e}=(0,l.useEnvironment)(),{__unstable_manageBillingUrl:i,navigateToGeneralPageRoot:t}=(0,l.useOrganizationProfileContext)(),o=e?.domains?.enabled;return(0,a.BX)(s.Col,{gap:4,sx:{width:"100%"},children:[i&&(0,a.tZ)(es,{}),o&&(0,a.tZ)(m.Cv,{permission:"org:sys_domains:manage",children:(0,a.BX)(s.Flex,{sx:e=>({width:"100%",gap:e.space.$8,paddingBottom:e.space.$4,paddingLeft:e.space.$1,paddingRight:e.space.$1,borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,[ee.mqu.md]:{flexDirection:"column",gap:e.space.$2}}),children:[(0,a.tZ)(s.Col,{sx:e=>({width:e.space.$66,marginTop:e.space.$2}),children:(0,a.tZ)(c.Header.Root,{children:(0,a.tZ)(c.Header.Title,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"h3"})})}),(0,a.tZ)(s.Col,{sx:{width:"100%"},children:(0,a.tZ)(O,{fallback:(0,a.BX)(a.HY,{children:[(0,a.tZ)(c.ProfileSection.ArrowButton,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",sx:e=>({gap:e.space.$2}),onClick:t}),(0,a.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),sx:e=>({paddingLeft:e.space.$10,color:e.colors.$colorTextSecondary,[ee.mqu.md]:{paddingLeft:0}})})]}),verificationStatus:"verified",enrollmentMode:"automatic_invitation"})})]})}),(0,a.BX)(s.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,a.tZ)(el,{}),(0,a.tZ)(eg,{})]})]})}),eh={membershipRequests:{pageSize:10,keepPreviousData:!0}},ef=()=>{let e=(0,c.useCardState)(),{organization:i,membershipRequests:t}=(0,o.o8)(eh);return i?(0,a.tZ)(ea.wQ,{page:t?.page||1,onPageChange:t?.fetchPage??(()=>null),itemCount:t?.count||0,pageCount:t?.pageCount||0,itemsPerPage:eh.membershipRequests.pageSize,isLoading:t?.isLoading,emptyStateLocalizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,s.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:(t?.data||[]).map(i=>(0,a.tZ)(ev,{request:i,onError:e.setError},i.id))}):null},ev=(0,c.withCardStateProvider)(e=>{let{request:i,onError:t}=e,n=(0,c.useCardState)(),{membership:r,membershipRequests:l}=(0,o.o8)(eh);return(0,a.BX)(ea.RN,{children:[(0,a.tZ)(s.Td,{children:(0,a.tZ)(c.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(s.Box,{as:"span",elementDescriptor:s.descriptors.formattedDate,elementId:s.descriptors.formattedDate.setId("tableCell"),children:i.createdAt.toLocaleDateString()})}),(0,a.tZ)(s.Td,{children:(0,a.tZ)(eb,{onAccept:()=>{if(r&&l)return n.runAsync(async()=>{await i.accept(),await l.revalidate()},"accept").catch(e=>(0,v.S3)(e,[],t))},onReject:()=>{if(r&&l)return n.runAsync(async()=>{await i.reject(),await l.revalidate()},"reject").catch(e=>(0,v.S3)(e,[],t))}})})]})}),eb=e=>{let i=(0,c.useCardState)();return(0,a.BX)(s.Flex,{gap:2,children:[(0,a.tZ)(s.Button,{textVariant:"buttonSmall",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,a.tZ)(s.Button,{textVariant:"buttonSmall",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},ez=()=>{let{organizationSettings:e}=(0,l.useEnvironment)(),{__unstable_manageBillingUrl:i,navigateToGeneralPageRoot:t}=(0,l.useOrganizationProfileContext)(),o=e?.domains?.enabled;return(0,a.BX)(s.Col,{gap:4,sx:{width:"100%"},children:[i&&(0,a.tZ)(es,{}),o&&(0,a.tZ)(m.Cv,{permission:"org:sys_domains:manage",children:(0,a.BX)(s.Flex,{sx:e=>({width:"100%",gap:e.space.$8,paddingBottom:e.space.$4,paddingLeft:e.space.$1,paddingRight:e.space.$1,borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,[ee.mqu.md]:{flexDirection:"column",gap:e.space.$2}}),children:[(0,a.tZ)(s.Col,{sx:e=>({width:e.space.$66,marginTop:e.space.$2}),children:(0,a.tZ)(c.Header.Root,{children:(0,a.tZ)(c.Header.Title,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"h3"})})}),(0,a.tZ)(s.Col,{sx:{width:"100%"},children:(0,a.tZ)(O,{fallback:(0,a.BX)(a.HY,{children:[(0,a.tZ)(c.ProfileSection.ArrowButton,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),sx:e=>({gap:e.space.$2}),id:"manageVerifiedDomains",onClick:t}),(0,a.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),sx:e=>({paddingLeft:e.space.$10,color:e.colors.$colorTextSecondary,[ee.mqu.md]:{paddingLeft:0}})})]}),verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})})]})}),(0,a.BX)(s.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,a.tZ)(el,{}),(0,a.tZ)(ef,{})]})]})},eZ=10,ey=(0,c.withCardStateProvider)(()=>{let{organizationSettings:e}=(0,l.useEnvironment)(),i=(0,c.useCardState)(),t=(0,m.N2)({permission:"org:sys_memberships:manage"}),r=(0,m.N2)({permission:"org:sys_memberships:read"}),d=e?.domains?.enabled&&t,[g,u]=(0,n.useState)(""),[p,f]=(0,n.useState)(""),{membershipRequests:v,memberships:b,invitations:z}=(0,o.o8)({membershipRequests:d||void 0,invitations:t||void 0,memberships:r?{keepPreviousData:!0,query:g||void 0}:void 0}),{__unstable_manageBillingUrl:Z}=(0,l.useOrganizationProfileContext)();return null===t?null:(0,a.tZ)(s.Col,{elementDescriptor:s.descriptors.page,gap:2,children:(0,a.tZ)(s.Col,{elementDescriptor:s.descriptors.profilePage,elementId:s.descriptors.profilePage.setId("organizationMembers"),gap:4,children:(0,a.BX)(h.a.Root,{animate:!1,children:[(0,a.tZ)(c.Animated,{asChild:!0,children:(0,a.tZ)(c.Header.Root,{contentSx:{[ee.mqu.md]:{flexDirection:"row",width:"100%",justifyContent:"space-between"}},children:(0,a.tZ)(c.Header.Title,{localizationKey:(0,s.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"h2"})})}),(0,a.tZ)(c.Card.Alert,{children:i.error}),(0,a.BX)(c.Tabs,{children:[(0,a.BX)(c.TabsList,{sx:e=>({gap:e.space.$2}),children:[r&&(0,a.tZ)(c.Tab,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members"),children:!!b?.count&&(0,a.tZ)(m.dN,{shouldAnimate:!g,notificationCount:b.count,colorScheme:"outline"})}),t&&(0,a.tZ)(c.Tab,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations"),children:z?.data&&!z.isLoading&&(0,a.tZ)(m.dN,{notificationCount:z.count,colorScheme:"outline"})}),t&&d&&(0,a.tZ)(c.Tab,{localizationKey:(0,s.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:v?.data&&!v.isLoading&&(0,a.tZ)(m.dN,{notificationCount:v.count,colorScheme:"outline"})})]}),(0,a.BX)(c.TabPanels,{children:[r&&(0,a.tZ)(c.TabPanel,{sx:{width:"100%"},children:(0,a.BX)(s.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[t&&Z&&(0,a.tZ)(es,{}),(0,a.BX)(s.Flex,{gap:2,direction:"col",sx:{width:"100%"},children:[(0,a.tZ)(el,{actionSlot:(0,a.tZ)(ed,{query:g,value:p,memberships:b,onSearchChange:e=>f(e),onQueryTrigger:e=>u(e)})}),(0,a.tZ)(eo,{pageSize:eZ,memberships:b})]})]})}),t&&(0,a.tZ)(c.TabPanel,{sx:{width:"100%"},children:(0,a.tZ)(ep,{})}),t&&d&&(0,a.tZ)(c.TabPanel,{sx:{width:"100%"},children:(0,a.tZ)(ez,{})})]})]})]})})})});var eP=t(5006);let eS=()=>{let{navigate:e}=(0,d.useRouter)();return(0,a.BX)(a.HY,{children:[(0,a.tZ)(c.Header.Root,{sx:e=>({marginBlockEnd:e.space.$4}),children:(0,a.tZ)(c.Header.BackLink,{onClick:()=>void e("../",{searchParams:new URLSearchParams("tab=plans")}),children:(0,a.tZ)(c.Header.Title,{localizationKey:"Available Plans",textVariant:"h2"})})}),(0,a.tZ)(l.__experimental_PricingTableContext.Provider,{value:{componentName:"PricingTable",mode:"modal"},children:(0,a.tZ)(eP.C,{})})]})},ex=()=>(0,a.tZ)(l.SubscriberTypeContext.Provider,{value:"org",children:(0,a.tZ)(l.PlansContextProvider,{children:(0,a.tZ)(eS,{})})}),eC=(0,n.lazy)(()=>Promise.all([t.e("507"),t.e("573"),t.e("916")]).then(t.bind(t,4961)).then(e=>({default:e.OrganizationBillingPage}))),eT=()=>{let{pages:e,isMembersPageRoot:i,isGeneralPageRoot:t,isBillingPageRoot:o}=(0,l.useOrganizationProfileContext)(),{__experimental_commerceSettings:r}=(0,l.useEnvironment)(),s=e.contents?.map((e,o)=>{let n=!t&&!i&&0===o;return a.tZ(d.Route,{index:n,path:n?void 0:e.url,children:a.tZ(p.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)});return(0,a.BX)(d.Switch,{children:[s,(0,a.BX)(d.Route,{children:[(0,a.tZ)(d.Route,{path:t?void 0:"organization-general",children:(0,a.tZ)(d.Switch,{children:(0,a.tZ)(d.Route,{index:!0,children:(0,a.tZ)(j,{})})})}),(0,a.tZ)(d.Route,{path:i?void 0:"organization-members",children:(0,a.tZ)(d.Switch,{children:(0,a.tZ)(d.Route,{index:!0,children:(0,a.tZ)(m.Cv,{condition:e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}),redirectTo:t?"../":"./organization-general",children:(0,a.tZ)(ey,{})})})})}),r.billing.enabled&&r.billing.hasPaidOrgPlans&&(0,a.tZ)(d.Route,{path:o?void 0:"organization-billing",children:(0,a.BX)(d.Switch,{children:[(0,a.tZ)(d.Route,{index:!0,children:(0,a.tZ)(n.Suspense,{fallback:"",children:(0,a.tZ)(eC,{})})}),(0,a.tZ)(d.Route,{path:"plans",children:(0,a.tZ)(n.Suspense,{fallback:"",children:(0,a.tZ)(ex,{})})}),(0,a.tZ)(d.Route,{path:"invoice/:invoiceId",children:(0,a.tZ)(n.Suspense,{fallback:"",children:(0,a.tZ)(J,{})})})]})})]})]})},eD=(0,l.withCoreUserGuard)(()=>{let e=n.useRef(null);return(0,a.tZ)(c.ProfileCard.Root,{sx:e=>({display:"grid",gridTemplateColumns:"1fr 3fr",height:e.sizes.$176,overflow:"hidden"}),children:(0,a.BX)(u,{contentRef:e,children:[(0,a.tZ)(c.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,s.localizationKeys)("organizationProfile.navbar.title")}),(0,a.tZ)(c.ProfileCard.Content,{contentRef:e,scrollBoxId:r.aw,children:(0,a.tZ)(eT,{})})]})})}),eB=(0,c.withCardStateProvider)(e=>{let{organization:i}=(0,o.o8)();return i?(0,a.tZ)(s.Flow.Root,{flow:"organizationProfile",children:(0,a.tZ)(s.Flow.Part,{children:(0,a.tZ)(d.Switch,{children:(0,a.tZ)(d.Route,{children:(0,a.tZ)(eD,{})})})})}):null}),eK=e=>{let i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,a.tZ)(d.Route,{path:"organizationProfile",children:(0,a.tZ)(l.OrganizationProfileContext.Provider,{value:i,children:(0,a.tZ)("div",{children:(0,a.tZ)(eB,{...i})})})})}}}]);